package org apache lucene benchmark bytask tasks
/**
* copyright 2005 the apache software foundation
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
import org apache lucene benchmark bytask perfrundata
import org apache lucene document fieldselector
import org apache lucene document setbasedfieldselector
import org apache lucene index indexreader
import java util stringtokenizer
import java util set
import java util hashset
import java util collections
import java io ioexception
/**
* search and traverse and retrieve docs task using a setbasedfieldselector.
*
* <p>note: this task reuses the reader if it is already open.
* otherwise a reader is opened at start and closed at the end.
*
* <p>takes optional param: comma separated list of fields to load.</p>
*
* <p>other side effects: counts additional 1 (record) for each traversed hit,
* and 1 more for each retrieved (non null) document.</p>
*/
public class searchtravretloadfieldselectortask extends searchtravtask
protected fieldselector fieldselector
public searchtravretloadfieldselectortask perfrundata rundata
super rundata
public boolean withretrieve
return true
protected int retrievedoc indexreader ir  int id  throws ioexception
return  ir document id  fieldselector     null ? 0   1
public void setparams string params
this params   params     cannot just call super setparams    b c it's params differ
set fieldstoload   new hashset
for  stringtokenizer tokenizer   new stringtokenizer params      tokenizer hasmoretokens
string s   tokenizer nexttoken
fieldstoload add s
fieldselector   new setbasedfieldselector fieldstoload  collections empty_set
/* (non-javadoc)
* @see org.apache.lucene.benchmark.bytask.tasks.perftask#supportsparams()
*/
public boolean supportsparams
return true