package org apache lucene demo
/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
import org apache lucene analysis standard standardanalyzer
import org apache lucene index indexwriter
import java io file
import java io filenotfoundexception
import java io ioexception
import java util date
/** index all text files under a directory. */
public class indexfiles
private indexfiles
static final file index_dir   new file
/** index all text files under a directory. */
public static void main string args
string usage
if  args length    0
system err println     usage
system exit 1
if  index_dir exists
system out println    index_dir
system exit 1
final file docdir   new file args
if   docdir exists       docdir canread
system out println    docdir getabsolutepath
system exit 1
date start   new date
try
indexwriter writer   new indexwriter index_dir  new standardanalyzer    true
system out println    index_dir
indexdocs writer  docdir
system out println
writer optimize
writer close
date end   new date
system out println end gettime     start gettime
catch  ioexception e
system out println     e getclass
e getmessage
static void indexdocs indexwriter writer  file file
throws ioexception
// do not try to index files that cannot be read
if  file canread
if  file isdirectory
string files   file list
// an io error could occur
if  files    null
for  int i   0  i < files length  i
indexdocs writer  new file file  files
else
system out println     file
try
writer adddocument filedocument document file
// at least on windows, some temporary files raise this exception with an "access denied" message
// checking if the file can be read doesn't help
catch  filenotfoundexception fnfe