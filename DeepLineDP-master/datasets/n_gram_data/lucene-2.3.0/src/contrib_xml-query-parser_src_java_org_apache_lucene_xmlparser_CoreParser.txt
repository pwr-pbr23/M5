package org apache lucene xmlparser
import java io inputstream
import javax xml parsers documentbuilder
import javax xml parsers documentbuilderfactory
import org apache lucene analysis analyzer
import org apache lucene queryparser queryparser
import org apache lucene search query
import org apache lucene xmlparser builders booleanquerybuilder
import org apache lucene xmlparser builders constantscorequerybuilder
import org apache lucene xmlparser builders filteredquerybuilder
import org apache lucene xmlparser builders matchalldocsquerybuilder
import org apache lucene xmlparser builders cachedfilterbuilder
import org apache lucene xmlparser builders rangefilterbuilder
import org apache lucene xmlparser builders spanfirstbuilder
import org apache lucene xmlparser builders spannearbuilder
import org apache lucene xmlparser builders spannotbuilder
import org apache lucene xmlparser builders spanorbuilder
import org apache lucene xmlparser builders spanortermsbuilder
import org apache lucene xmlparser builders spanquerybuilderfactory
import org apache lucene xmlparser builders spantermbuilder
import org apache lucene xmlparser builders termquerybuilder
import org apache lucene xmlparser builders termsquerybuilder
import org apache lucene xmlparser builders userinputquerybuilder
import org w3c dom document
import org w3c dom element
/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
/**
* assembles a querybuilder which uses only core lucene query objects
* @author mark
*
*/
public class coreparser implements querybuilder
protected analyzer analyzer
protected queryparser parser
protected querybuilderfactory queryfactory
protected filterbuilderfactory filterfactory
//controls the max size of the lru cache used for queryfilter objects parsed.
public static int maxnumcachedfilters 20
public coreparser analyzer analyzer  queryparser parser
this analyzer analyzer
this parser parser
filterfactory   new filterbuilderfactory
filterfactory addbuilder   new rangefilterbuilder
queryfactory   new querybuilderfactory
queryfactory addbuilder   new termquerybuilder
queryfactory addbuilder   new termsquerybuilder analyzer
queryfactory addbuilder   new matchalldocsquerybuilder
queryfactory addbuilder   new booleanquerybuilder queryfactory
queryfactory addbuilder   new userinputquerybuilder parser
queryfactory addbuilder   new filteredquerybuilder filterfactory queryfactory
queryfactory addbuilder   new constantscorequerybuilder filterfactory
filterfactory addbuilder   new cachedfilterbuilder queryfactory
filterfactory  maxnumcachedfilters
spanquerybuilderfactory sqof new spanquerybuilderfactory
spannearbuilder snb new spannearbuilder sqof
sqof addbuilder   snb
queryfactory addbuilder   snb
spantermbuilder snt new spantermbuilder
sqof addbuilder   snt
queryfactory addbuilder   snt
spanorbuilder sot new spanorbuilder sqof
sqof addbuilder   sot
queryfactory addbuilder   sot
spanortermsbuilder sots new spanortermsbuilder analyzer
sqof addbuilder   sots
queryfactory addbuilder   sots
spanfirstbuilder sft new spanfirstbuilder sqof
sqof addbuilder   sft
queryfactory addbuilder   sft
spannotbuilder snot new spannotbuilder sqof
sqof addbuilder   snot
queryfactory addbuilder   snot
public query parse inputstream xmlstream  throws parserexception
return getquery parsexml xmlstream  getdocumentelement
public void addquerybuilder string nodename querybuilder builder
queryfactory addbuilder nodename builder
public void addfilterbuilder string nodename filterbuilder builder
filterfactory addbuilder nodename builder
private static document parsexml inputstream pxmlfile  throws parserexception
documentbuilderfactory dbf   documentbuilderfactory newinstance
documentbuilder db   null
try
db   dbf newdocumentbuilder
catch  exception se
throw new parserexception    se
org w3c dom document doc   null
try
doc   db parse pxmlfile
catch  exception se
throw new parserexception     se  se
return doc
public query getquery element e  throws parserexception
return queryfactory getquery e