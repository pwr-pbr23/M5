package org apache lucene demo
/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
import java io
import org apache lucene document
import org apache lucene demo html htmlparser
/** a utility for making lucene documents for html documents. */
public class htmldocument
static char dirsep   system getproperty    charat 0
public static string uid file f
// append path and date into a string in such a way that lexicographic
// sorting gives the same results as a walk of the file hierarchy.  thus
// null (\u0000) is used both to separate directory components and to
// separate the path from the date.
return f getpath   replace dirsep
datetools timetostring f lastmodified    datetools resolution second
public static string uid2url string uid
string url   uid replace       	     replace nulls with slashes
return url substring 0  url lastindexof         remove date from end
public static document document file f
throws ioexception  interruptedexception
// make a new, empty document
document doc   new document
// add the url as a field named "path".  use a field that is
// indexed (i.e. searchable), but don't tokenize the field into words.
doc add new field    f getpath   replace dirsep      field store yes
field index un_tokenized
// add the last modified date of the file a field named "modified".
// use a field that is indexed (i.e. searchable), but don't tokenize
// the field into words.
doc add new field
datetools timetostring f lastmodified    datetools resolution minute
field store yes  field index un_tokenized
// add the uid as a field, so that index can be incrementally maintained.
// this field is not stored with document, it is indexed, but it is not
// tokenized prior to indexing.
doc add new field    uid f   field store no  field index un_tokenized
fileinputstream fis   new fileinputstream f
htmlparser parser   new htmlparser fis
// add the tag-stripped contents as a reader-valued text field so it will
// get tokenized and indexed.
doc add new field    parser getreader
// add the summary as a field that is stored and returned with
// hit documents for display.
doc add new field    parser getsummary    field store yes  field index no
// add the title as a field that it can be searched and that is stored.
doc add new field    parser gettitle    field store yes  field index tokenized
// return the document
return doc
private htmldocument