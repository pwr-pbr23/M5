package org apache lucene store je
/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
import java io ioexception
import org apache lucene store indexinput
/**
* port of andi vajda's dbdirectory to java edition of berkeley database
*
* @author aaron donovan
*/
public class jeindexinput extends indexinput
protected long position   0l  length   0l
protected jedirectory directory
protected block block
protected file file
protected jeindexinput jedirectory directory  string name
throws ioexception
super
this directory   directory
this file   new file name
if   file exists directory
throw new ioexception     name
length   file getlength
block   new block file
block get directory
public object clone
try
jeindexinput clone    jeindexinput  super clone
clone block   new block file
clone block seek position
clone block get directory
return clone
catch  ioexception e
throw new runtimeexception e getmessage
public void close   throws ioexception
public long length
return length
public byte readbyte   throws ioexception
if  position   1 > length
throw new ioexception file getname
int blockpos    int   position     jeindexoutput block_mask
byte b   block getdata
if  blockpos   1    jeindexoutput block_len
block seek position
block get directory
return b
public void readbytes byte b  int offset  int len  throws ioexception
if  position   len > length
throw new ioexception
else
int blockpos    int   position   jeindexoutput block_mask
while  blockpos   len >  jeindexoutput block_len
int blocklen   jeindexoutput block_len   blockpos
system
arraycopy block getdata    blockpos  b  offset
blocklen
len    blocklen
offset    blocklen
position    blocklen
block seek position
block get directory
blockpos   0
if  len > 0
system arraycopy block getdata    blockpos  b  offset  len
position    len
public void seek long pos  throws ioexception
if  pos > length
throw new ioexception
if   pos >>> jeindexoutput block_shift      position >>> jeindexoutput block_shift
block seek pos
block get directory
position   pos
public long getfilepointer
return position