package org apache lucene index
/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
import java io file
import java io filenamefilter
import java util hashset
/**
* filename filter that accept filenames and extensions only created by lucene.
*
* @author daniel naber / bernhard messer
* @version $rcs = ' $id: exp $ ' ;
*/
public class indexfilenamefilter implements filenamefilter
static indexfilenamefilter singleton   new indexfilenamefilter
private hashset extensions
private hashset extensionsincfs
public indexfilenamefilter
extensions   new hashset
for  int i   0  i < indexfilenames index_extensions length  i
extensions add indexfilenames index_extensions
extensionsincfs   new hashset
for  int i   0  i < indexfilenames index_extensions_in_compound_file length  i
extensionsincfs add indexfilenames index_extensions_in_compound_file
/* (non-javadoc)
* @see java.io.filenamefilter#accept(java.io.file, java.lang.string)
*/
public boolean accept file dir  string name
int i   name lastindexof
if  i     1
string extension   name substring 1 i
if  extensions contains extension
return true
else if  extension startswith
extension matches
return true
else if  extension startswith
extension matches
return true
else
if  name equals indexfilenames deletable   return true
else if  name startswith indexfilenames segments   return true
return false
/**
* returns true if this is a file that would be contained
* in a cfs file.  this function should only be called on
* files that pass the above "accept" (ie, are already
* known to be a lucene index file).
*/
public boolean iscfsfile string name
int i   name lastindexof
if  i     1
string extension   name substring 1 i
if  extensionsincfs contains extension
return true
if  extension startswith
extension matches
return true
return false
public static indexfilenamefilter getfilter
return singleton