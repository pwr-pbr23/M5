package org apache lucene store db
/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
import java io ioexception
import org apache lucene store indexinput
/**
* @author andi vajda
*/
public class dbindexinput extends indexinput
protected long position   0l  length   0l
protected dbdirectory directory
protected block block
protected file file
protected dbindexinput dbdirectory directory  string name
throws ioexception
super
this directory   directory
this file   new file name
if   file exists directory
throw new ioexception     name
length   file getlength
block   new block file
block get directory
public object clone
try
dbindexinput clone    dbindexinput  super clone
clone block   new block file
clone block seek position
clone block get directory
return clone
catch  ioexception e
throw new runtimeexception e getmessage
public void close
throws ioexception
public long length
return length
public byte readbyte
throws ioexception
if  position   1 > length
throw new ioexception
int blockpos    int   position     dbindexoutput block_mask
byte b   block getdata
if  blockpos   1    dbindexoutput block_len
block seek position
block get directory
return b
public void readbytes byte b  int offset  int len
throws ioexception
if  position   len > length
throw new ioexception
else
int blockpos    int   position   dbindexoutput block_mask
while  blockpos   len >  dbindexoutput block_len
int blocklen   dbindexoutput block_len   blockpos
system arraycopy block getdata    blockpos
b  offset  blocklen
len    blocklen
offset    blocklen
position    blocklen
block seek position
block get directory
blockpos   0
if  len > 0
system arraycopy block getdata    blockpos  b  offset  len
position    len
public void seek long pos
throws ioexception
if  pos > length
throw new ioexception
if   pos >>> dbindexoutput block_shift
position >>> dbindexoutput block_shift
block seek pos
block get directory
position   pos
public long getfilepointer
return position