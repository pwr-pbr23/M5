package org apache lucene search
import org apache lucene index indexreader
import org apache lucene index term
import org apache lucene index termdocs
import org apache lucene index termenum
import java io ioexception
/**
*
*
**/
class extendedfieldcacheimpl extends fieldcacheimpl implements extendedfieldcache
private static final longparser long_parser   new longparser
public long parselong string value
return long parselong value
private static final doubleparser double_parser   new doubleparser
public double parsedouble string value
return double parsedouble value
public long getlongs indexreader reader  string field  throws ioexception
return getlongs reader  field  long_parser
// inherit javadocs
public long getlongs indexreader reader  string field  longparser parser
throws ioexception
return  long  longscache get reader  new entry field  parser
cache longscache   new cache
protected object createvalue indexreader reader  object entrykey
throws ioexception
entry entry    entry  entrykey
string field   entry field
longparser parser    longparser  entry custom
final long retarray   new long
termdocs termdocs   reader termdocs
termenum termenum   reader terms  new term field
try
do
term term   termenum term
if  term  null    term field      field  break
long termval   parser parselong term text
termdocs seek  termenum
while  termdocs next
retarray   termval
while  termenum next
finally
termdocs close
termenum close
return retarray
// inherit javadocs
public double getdoubles indexreader reader  string field
throws ioexception
return getdoubles reader  field  double_parser
// inherit javadocs
public double getdoubles indexreader reader  string field  doubleparser parser
throws ioexception
return  double  doublescache get reader  new entry field  parser
cache doublescache   new cache
protected object createvalue indexreader reader  object entrykey
throws ioexception
entry entry    entry  entrykey
string field   entry field
doubleparser parser    doubleparser  entry custom
final double retarray   new double
termdocs termdocs   reader termdocs
termenum termenum   reader terms  new term  field
try
do
term term   termenum term
if  term  null    term field      field  break
double termval   parser parsedouble term text
termdocs seek  termenum
while  termdocs next
retarray   termval
while  termenum next
finally
termdocs close
termenum close
return retarray
// inherit javadocs
public object getauto indexreader reader  string field  throws ioexception
return autocache get reader  field
cache autocache   new cache
protected object createvalue indexreader reader  object fieldkey
throws ioexception
string field     string fieldkey  intern
termenum enumerator   reader terms  new term  field
try
term term   enumerator term
if  term    null
throw new runtimeexception      field
object ret   null
if  term field      field
string termtext   term text   trim
/**
* java 1.4 level code:
if (pintegers.matcher(termtext).matches())
return integersortedhitqueue.comparator (reader, enumerator, field);
else if (pfloats.matcher(termtext).matches())
return floatsortedhitqueue.comparator (reader, enumerator, field);
*/
// java 1.3 level code:
try
integer parseint  termtext
ret   getints  reader  field
catch  numberformatexception nfe1
try
long parselong termtext
ret   getlongs  reader  field
catch  numberformatexception nfe2
try
float parsefloat  termtext
ret   getfloats  reader  field
catch  numberformatexception nfe3
ret   getstringindex  reader  field
else
throw new runtimeexception
return ret
finally
enumerator close