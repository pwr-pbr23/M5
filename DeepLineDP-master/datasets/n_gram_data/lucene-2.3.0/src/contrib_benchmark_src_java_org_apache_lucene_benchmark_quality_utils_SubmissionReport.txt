/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache lucene benchmark quality utils
import java io ioexception
import java io printwriter
import java text numberformat
import org apache lucene benchmark quality qualityquery
import org apache lucene search scoredoc
import org apache lucene search searcher
import org apache lucene search topdocs
/**
* create a log ready for submission.
* extend this class and override
* {@link #report(qualityquery, topdocs, string, searcher)}
* to create different reports.
*/
public class submissionreport
private numberformat nf
private printwriter logger
private string name
/**
* constructor for submissionreport.
* @param logger if null, no submission data is created.
* @param name name of this run.
*/
public submissionreport  printwriter logger  string name
this logger   logger
this name   name
nf   numberformat getinstance
nf setmaximumfractiondigits 4
nf setminimumfractiondigits 4
/**
* report a search result for a certain quality query.
* @param qq quality query for which the results are reported.
* @param td search results for the query.
* @param docnamefield stored field used for fetching the result doc name.
* @param searcher index access for fetching doc name.
* @throws ioexception in case of a problem.
*/
public void report qualityquery qq  topdocs td  string docnamefield  searcher searcher  throws ioexception
if  logger  null
return
scoredoc sd   td scoredocs
string sep
docnameextractor xt   new docnameextractor docnamefield
for  int i 0  i<sd length  i
string docname   xt docname searcher sd doc
logger println
qq getqueryid           sep
sep
format docname 20       sep
format   i 7           sep
nf format sd score    sep
name
public void flush
if  logger  null
logger flush
private static string padd
private string format string s  int minlen
s    s  null ?     s
int n   math max minlen s length
return  s padd  substring 0 n