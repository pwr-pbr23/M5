/*
derby - class org.apache.derby.jdbc.driver30
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby jdbc
import org apache derby impl jdbc embedconnection
import org apache derby iapi services sanity sanitymanager
import org apache derby iapi sql conn languageconnectioncontext
import org apache derby iapi error standardexception
import org apache derby iapi jdbc brokeredconnection
import org apache derby iapi jdbc brokeredconnection30
import org apache derby iapi jdbc brokeredconnectioncontrol
import org apache derby iapi jdbc resourceadapter
import java sql connection
import java sql sqlexception
import org apache derby impl jdbc
/** -- jdbc 2.0. extension -- */
import javax sql pooledconnection
import javax sql xaconnection
import java util properties
/**
this class extends the local20 jdbc driver in order to determine at jbms
boot-up if the jvm that runs us does support jdbc 3.0. if it is the case
then we will load the appropriate class(es) that have jdbc 3.0 new public
methods and sql types.
*/
public class driver30 extends driver20
/**
* get a new nested connection.
*
* @param conn	the embedconnection.
*
* @return a nested connection object.
*
*/
public connection getnewnestedconnection embedconnection conn
if  sanitymanager debug
sanitymanager assert conn instanceof embedconnection30
return new embedconnection30 conn
/*
methods to be overloaded in sub-implementations such as
a tracing driver.
*/
public embedconnection getnewembedconnection string url  properties info
throws sqlexception
return new embedconnection30 this  url  info
/**
@exception sqlexception if fails to create statement
*/
public java sql preparedstatement
newembedpreparedstatement
embedconnection conn
string stmt
boolean formetadata
int resultsettype
int resultsetconcurrency
int resultsetholdability
int autogeneratedkeys
int columnindexes
string columnnames
throws sqlexception
return new embedpreparedstatement30 conn
stmt
formetadata
resultsettype
resultsetconcurrency
resultsetholdability
autogeneratedkeys
columnindexes
columnnames
/**
@exception sqlexception if fails to create statement
*/
public java sql callablestatement
newembedcallablestatement
embedconnection conn
string stmt
int resultsettype
int resultsetconcurrency
int resultsetholdability
throws sqlexception
return new embedcallablestatement30 conn
stmt
resultsettype
resultsetconcurrency
resultsetholdability
public brokeredconnection newbrokeredconnection brokeredconnectioncontrol control
return new brokeredconnection30 control
/**
* create and return an embedpooledconnection from the received instance
* of embeddeddatasource.
*/
protected pooledconnection getnewpooledconnection
embeddeddatasource eds  string user  string password
boolean requestpassword  throws sqlexception
return new embedpooledconnection
eds  user  password  requestpassword
/**
* create and return an embedxaconnection from the received instance
* of embeddeddatasource.
*/
protected xaconnection getnewxaconnection
embeddeddatasource eds  resourceadapter ra
string user  string password  boolean requestpassword
throws sqlexception
return new embedxaconnection
eds  ra  user  password  requestpassword