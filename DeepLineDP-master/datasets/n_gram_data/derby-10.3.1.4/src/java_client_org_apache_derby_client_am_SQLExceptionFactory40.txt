/*
derby - class org.apache.derby.client.am.sqlexceptionfactory40
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby client am
import org apache derby shared common reference sqlstate
import org apache derby shared common error exceptionseverity
import java sql sqldataexception
import java sql sqlexception
import java sql sqlfeaturenotsupportedexception
import java sql sqlintegrityconstraintviolationexception
import java sql sqlinvalidauthorizationspecexception
import java sql sqlsyntaxerrorexception
import java sql sqltransactionrollbackexception
import java sql sqltransientconnectionexception
/**
* sqlexception factory class to create jdbc 40 exception classes
*/
public class sqlexceptionfactory40 extends sqlexceptionfactory
// important drda sql states, from drda v3 spec, section 8.2
// we have to consider these as well as the standard sqlstate classes
// when choosing the right exception subclass
private static final string drda_conversation_terminated
private static final string drda_command_not_supported
private static final string drda_object_not_supported
private static final string drda_param_not_supported
private static final string drda_value_not_supported
private static final string drda_sqltype_not_supported
private static final string drda_conversion_not_supported
private static final string drda_reply_msg_not_supported
/**
* creates jdbc4.0 sqlexception and its subclass based on sql state
*
* @param message description of the
* @param sqlstate
* @param errcode derby error code
*/
public sqlexception getsqlexception  string message  string sqlstate
int errcode
sqlexception ex   null
if  sqlstate    null
ex   new sqlexception message  sqlstate  errcode
else if  sqlstate startswith sqlstate connectivity_prefix
errcode >  exceptionseverity session_severity
//none of the sqlstate supported by derby belongs to
//nontransientconnectionexception
ex   new sqltransientconnectionexception message  sqlstate  errcode
else if  sqlstate startswith sqlstate sql_data_prefix
ex   new sqldataexception message  sqlstate  errcode
else if  sqlstate startswith sqlstate integrity_violation_prefix
ex   new sqlintegrityconstraintviolationexception message  sqlstate
errcode
else if  sqlstate startswith sqlstate authorization_spec_prefix
ex   new sqlinvalidauthorizationspecexception message  sqlstate
errcode
else if  sqlstate startswith sqlstate transaction_prefix
errcode >  exceptionseverity transaction_severity
ex   new sqltransactionrollbackexception message  sqlstate
errcode
else if  sqlstate startswith sqlstate lse_compilation_prefix
ex   new sqlsyntaxerrorexception message  sqlstate  errcode
else if
sqlstate startswith  sqlstate unsupported_prefix
sqlstate equals drda_command_not_supported
sqlstate equals drda_object_not_supported
sqlstate equals drda_param_not_supported
sqlstate equals drda_value_not_supported
sqlstate equals drda_sqltype_not_supported
sqlstate equals drda_reply_msg_not_supported
ex   new sqlfeaturenotsupportedexception message  sqlstate
errcode
else
ex   new sqlexception message  sqlstate  errcode
return ex