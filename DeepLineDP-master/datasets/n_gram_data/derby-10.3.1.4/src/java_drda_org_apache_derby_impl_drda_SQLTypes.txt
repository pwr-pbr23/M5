/*
derby - class org.apache.derby.impl.drda.sqltypes
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby impl drda
import java sql types
import java sql sqlexception
import org apache derby iapi reference drdaconstants
import org apache derby iapi reference jdbc30translation
class sqltypes
// define final statics for the fdoca type codes here!!!
// hide the default constructor
private sqltypes
/**
* map db2 sql type to jdbc type
*
* @param sqltype sql type to convert
* @param length storage length of type
* @param ccsid ccsid of type
*
* @return corresponding jdbc type
*/
static protected int mapdb2sqltypetojdbctype  int sqltype  long length  int ccsid
switch  getnonnullablesqltype  sqltype        mask the isnullable bit
case drdaconstants db2_sqltype_small
return java sql types smallint
case drdaconstants db2_sqltype_integer
return java sql types integer
case drdaconstants db2_sqltype_bigint
return java sql types bigint
case drdaconstants db2_sqltype_float
if  length    16                      can map to either numeric or decimal    @sxg
return java sql types decimal
else if  length    8                  can map to either double or float    @sxg
return java sql types double
else if  length    4
return java sql types real
else
return 0
//throw new bugcheckexception ("encountered unexpected float length");
case drdaconstants db2_sqltype_decimal                can map to either numeric or decimal    @sxg
case drdaconstants db2_sqltype_zoned                  can map to either numeric or decimal    @sxg
case drdaconstants db2_sqltype_numeric                can map to either numeric or decimal    @sxg
return java sql types decimal
case drdaconstants db2_sqltype_char        mixed and single byte
if  ccsid    0xffff    ccsid    0     we think uw returns 0  and 390 returns 0xffff  doublecheck
return java sql types binary
else
return java sql types char
case drdaconstants db2_sqltype_cstr        sbcs null terminated
case drdaconstants db2_sqltype_graphic     fixed character dbcs
return java sql types char
// use ccsid to distinguish between binary and char, varbinary and varchar, long... !!! -j/p/s
case drdaconstants db2_sqltype_vargraph      variable character dbcs
case drdaconstants db2_sqltype_varchar       variable character sbcs mixed
if  ccsid    0xffff    ccsid    0     we think uw returns 0  and 390 returns 0xffff  doublecheck
return java sql types varbinary
else
return java sql types varchar
case drdaconstants db2_sqltype_lstr          pascal string sbcs mixed
return java sql types varchar
case drdaconstants db2_sqltype_longraph      long varchar dbcs
case drdaconstants db2_sqltype_long          long varchar sbcs mixed
if  ccsid    0xffff    ccsid    0     we think uw returns 0  and 390 returns 0xffff  doublecheck
return java sql types longvarbinary
else
return java sql types longvarchar
case drdaconstants db2_sqltype_date
return java sql types date
case drdaconstants db2_sqltype_time
return java sql types time
case drdaconstants db2_sqltype_timestamp
return java sql types timestamp
case drdaconstants db2_sqltype_clob        large object character sbcs mixed
case drdaconstants db2_sqltype_dbclob      large object character dbcs
return java sql types clob
case drdaconstants db2_sqltype_blob        large object bytes
case drdaconstants db2_sqltype_blob_locator
case drdaconstants db2_sqltype_clob_locator
case drdaconstants db2_sqltype_dbclob_locator
return java sql types blob
default
//throw new bugcheckexception ("encountered unexpected type code");
return 0
/**
* map jdbc type to the db2 drda sql types expected by jcc.
*@param jdbctype  - jdbc type to convert
*@param nullable - whether the type is nullable
**/
/**  map jdbc type to db2 sqltype
* @param jdbctype   jdbc type from java.sql.types
* @param nullable   true if this is a nullable type
* @param outlen     output parameter with type length
*
* @return corresponding db2 sql type (see drda manual fd:oca meta
*          data summary, page 245)
*
* @exception sqlexception thrown for unrecognized sqltype
*/
static protected int mapjdbctypetodb2sqltype  int jdbctype  boolean nullable
int outlen
throws sqlexception
int nulladdval  0
if  nullable
nulladdval  1
// call fdocaconstants just to get the length
fdocaconstants mapjdbctypetodrdatype jdbctype nullable outlen
switch jdbctype
case jdbc30translation boolean
case java sql types bit
case java sql types tinyint
case java sql types smallint
return drdaconstants db2_sqltype_small   nulladdval
case java sql types integer
return drdaconstants db2_sqltype_integer   nulladdval
case java sql types bigint
return drdaconstants db2_sqltype_bigint   nulladdval
case java sql types double
case java sql types real
return drdaconstants db2_sqltype_float   nulladdval
case java sql types decimal
case java sql types numeric
return drdaconstants db2_sqltype_decimal   nulladdval
case java sql types date
return drdaconstants db2_sqltype_date   nulladdval
case java sql types time
return drdaconstants db2_sqltype_time   nulladdval
case java sql types timestamp
return drdaconstants db2_sqltype_timestamp   nulladdval
case java sql types char
return  drdaconstants db2_sqltype_char   nulladdval        null terminated sbcs mixed
case java sql types binary
return drdaconstants db2_sqltype_char   nulladdval
case java sql types varchar
case java sql types varbinary
return  drdaconstants db2_sqltype_varchar   nulladdval
case java sql types longvarbinary
return drdaconstants db2_sqltype_long   nulladdval
case java sql types java_object
return drdaconstants db2_sqltype_long   nulladdval
case java sql types blob
return drdaconstants db2_sqltype_blob   nulladdval
case java sql types clob
return drdaconstants db2_sqltype_clob   nulladdval
case java sql types longvarchar
return drdaconstants db2_sqltype_long   nulladdval
case java sql types array
case java sql types distinct
case java sql types null
case java sql types other
case java sql types ref
case java sql types struct
throw new sqlexception     jdbctype
default
throw new sqlexception      jdbctype
//throw new bugcheckexception ("encountered unexpected type code");
/**
* translate db2 sql type to the non-nullable type.
* @param sqltype db2 sql type
*
* @return the non-nullable db2 sql type.
*/
protected  static int getnonnullablesqltype  int sqltype
return sqltype   ~1