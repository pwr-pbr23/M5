/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel builder xml
import java util hashmap
import java util map
import org w3c dom attr
import org w3c dom element
import org w3c dom namednodemap
import org w3c dom node
import org apache camel model language xpathexpression
import org apache camel model language xqueryexpression
import org apache camel spi namespaceaware
import org apache camel util objecthelper
/**
* a helper class for working with namespaces or creating namespace based expressions
*
* @version $revision$
*/
public class namespaces
public static final string default_namespace
public static final string in_namespace
public static final string out_namespace
public static final string system_properties_namespace
public static final string environment_variables
public static final string exchange_property
private map<string  string> namespaces   new hashmap<string  string>
/**
* creates a namespaces object from the given xml element
*
* @param element the xml element representing the xpath namespace context
*/
public namespaces element element
add element
/**
* creates a namespace context with a single prefix and uri
*/
public namespaces string prefix  string uri
add prefix  uri
/**
* returns true if the given namespaceuri is empty or if it matches the
* given expected namespace
*/
public static boolean ismatchingnamespaceoremptynamespace string namespaceuri  string expectednamespace
return objecthelper isnullorblank namespaceuri     namespaceuri equals expectednamespace
public namespaces add string prefix  string uri
namespaces put prefix  uri
return this
public namespaces add element element
// lets set the parent first in case we overload a prefix here
node parentnode   element getparentnode
if  parentnode instanceof org w3c dom element
add  element  parentnode
namednodemap attributes   element getattributes
int size   attributes getlength
for  int i   0  i < size  i
attr node    attr  attributes item i
string name   node getname
if  name startswith
string prefix   name substring   length
string uri   node getvalue
add prefix  uri
return this
/**
* creates the xpath expression using the current namespace context
*/
public xpathexpression xpath string expression
xpathexpression answer   new xpathexpression expression
configure answer
return answer
/**
* creates the xpath expression using the current namespace context
*/
public xpathexpression xpath string expression  class<?> resulttype
xpathexpression answer   xpath expression
answer setresulttype resulttype
return answer
/**
* creates the xquery expression using the current namespace context
*/
public xqueryexpression xquery string expression
xqueryexpression answer   new xqueryexpression expression
configure answer
return answer
/**
* creates the xquery expression using the current namespace context
* and the given expected return type
*/
public xqueryexpression xquery string expression  class<?> resulttype
xqueryexpression answer   new xqueryexpression expression
answer setresulttype resulttype
configure answer
return answer
public map<string  string> getnamespaces
return namespaces
/**
* configures the namespace aware object
*/
public void configure namespaceaware namespaceaware
namespaceaware setnamespaces getnamespaces