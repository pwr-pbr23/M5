/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel bam rules
import java util arraylist
import java util list
import org apache camel exchange
import org apache camel bam processbuilder
import org apache camel bam model activitydefinition
import org apache camel bam model activitystate
import org apache camel bam model processinstance
import org apache camel impl servicesupport
import org apache camel util servicehelper
import org apache commons logging log
import org apache commons logging logfactory
/**
* represents a activity which is typically a system or could be an endpoint
*
* @version $revision$
*/
public class activityrules extends servicesupport
private static final transient log log   logfactory getlog activityrules class
private int expectedmessages   1
private processrules processrules
private list<temporalrule> rules   new arraylist<temporalrule>
private activitydefinition activitydefinition
private string activityname
private final org apache camel bam processbuilder builder
public activityrules processbuilder builder
this builder   builder
this processrules   builder getprocessrules
processrules getactivities   add this
public void addrule temporalrule rule
rules add rule
/**
* handles overdue activities
*/
public void processexpired activitystate activitystate  throws exception
for  temporalrule rule   rules
rule processexpired activitystate
public void processexchange exchange exchange  processinstance process
for  temporalrule rule   rules
rule processexchange exchange  process
// properties
//-------------------------------------------------------------------------
public activitydefinition getactivitydefinition
// lets always query for it, to avoid issues with refreshing before a commit etc
return builder findorcreateactivitydefinition activityname
public void setactivitydefinition activitydefinition activitydefinition
this activitydefinition   activitydefinition
public int getexpectedmessages
return expectedmessages
public void setexpectedmessages int expectedmessages
this expectedmessages   expectedmessages
public processrules getprocessrules
return processrules
public void setactivityname string activityname
this activityname   activityname
// implementation methods
//-------------------------------------------------------------------------
protected void dostart   throws exception
servicehelper startservices rules
protected void dostop   throws exception
servicehelper stopservices rules