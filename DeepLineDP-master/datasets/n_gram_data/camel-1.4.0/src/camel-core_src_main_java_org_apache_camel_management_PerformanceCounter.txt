/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel management
import java util date
import java util concurrent atomic atomiclong
import org springframework jmx export annotation managedattribute
import org springframework jmx export annotation managedoperation
import org springframework jmx export annotation managedresource
@managedresource description      currencytimelimit   15
public class performancecounter extends counter
private atomiclong numcompleted   new atomiclong 0l
private double minprocessingtime    1 0
private double maxprocessingtime
private double totalprocessingtime
private date lastexchangecompletiontime
private date lastexchangefailuretime
private date firstexchangecompletiontime
private date firstexchangefailuretime
@override
@managedoperation description
public synchronized void reset
super reset
numcompleted set 0l
minprocessingtime    1 0
maxprocessingtime   0 0
totalprocessingtime   0 0
lastexchangecompletiontime   null
lastexchangefailuretime   null
firstexchangecompletiontime   null
firstexchangefailuretime   null
@managedattribute description
public long getnumcompleted   throws exception
return numcompleted get
@managedattribute description
public long getnumfailed   throws exception
return numexchanges get     numcompleted get
@managedattribute description
public synchronized double getminprocessingtimemillis   throws exception
return minprocessingtime
@managedattribute description
public synchronized double getmeanprocessingtimemillis   throws exception
long count   numcompleted get
return count > 0 ? totalprocessingtime   count   0 0
@managedattribute description
public synchronized double getmaxprocessingtimemillis   throws exception
return maxprocessingtime
@managedattribute description
public synchronized double gettotalprocessingtimemillis   throws exception
return totalprocessingtime
@managedattribute description
public synchronized date getlastexchangecompletiontime
return lastexchangecompletiontime
@managedattribute description
public synchronized date getfirstexchangecompletiontime
return firstexchangecompletiontime
@managedattribute description
public synchronized date getlastexchangefailuretime
return lastexchangefailuretime
@managedattribute description
public synchronized date getfirstexchangefailuretime
return firstexchangefailuretime
/**
* this method is called when an exchange has been processed successfully.
*
* @param time in milliseconds it spent on processing the exchange
*/
public synchronized void completedexchange double time
increment
numcompleted incrementandget
totalprocessingtime    time
if  minprocessingtime < 0    time < minprocessingtime
minprocessingtime   time
if  time > maxprocessingtime
maxprocessingtime   time
date timestamp   new date
if  firstexchangecompletiontime    null
firstexchangecompletiontime   timestamp
lastexchangecompletiontime   timestamp
/**
* this method is called when an exchange has been processed and failed.
*/
public synchronized void failedexchange
increment
date timestamp   new date
if  firstexchangefailuretime    null
firstexchangefailuretime   timestamp
lastexchangefailuretime   timestamp