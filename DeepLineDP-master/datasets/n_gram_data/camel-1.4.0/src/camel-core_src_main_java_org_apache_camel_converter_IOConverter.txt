/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel converter
import java io bufferedinputstream
import java io bufferedoutputstream
import java io bufferedreader
import java io bufferedwriter
import java io bytearrayinputstream
import java io bytearrayoutputstream
import java io file
import java io fileinputstream
import java io filenotfoundexception
import java io fileoutputstream
import java io filereader
import java io filewriter
import java io ioexception
import java io inputstream
import java io inputstreamreader
import java io objectinput
import java io objectinputstream
import java io objectoutput
import java io objectoutputstream
import java io outputstream
import java io outputstreamwriter
import java io reader
import java io stringreader
import java io writer
import java net url
import java util properties
import javax xml transform outputkeys
import javax xml transform source
import javax xml transform transformer
import javax xml transform transformerexception
import javax xml transform transformerfactory
import javax xml transform dom domsource
import javax xml transform stream streamresult
import org apache camel converter
import org apache camel util collectionstringbuffer
import org apache commons logging log
import org apache commons logging logfactory
/**
* some core java.io based <a
* href="http://activemq.apache.org/camel/type-converter.html">type converters</a>
*
* @version $revision$
*/
@converter
public final class ioconverter
private static final transient log log   logfactory getlog ioconverter class
/**
* utility classes should not have a public constructor.
*/
private ioconverter
@converter
public static inputstream toinputstream url url  throws ioexception
return url openstream
@converter
public static inputstream toinputstream file file  throws filenotfoundexception
return new bufferedinputstream new fileinputstream file
@converter
public static bufferedreader toreader file file  throws filenotfoundexception
return new bufferedreader new filereader file
@converter
public static file tofile string name  throws filenotfoundexception
return new file name
@converter
public static outputstream tooutputstream file file  throws filenotfoundexception
return new bufferedoutputstream new fileoutputstream file
@converter
public static bufferedwriter towriter file file  throws ioexception
return new bufferedwriter new filewriter file
@converter
public static reader toreader inputstream in  throws filenotfoundexception
return new inputstreamreader in
@converter
public static writer towriter outputstream out  throws filenotfoundexception
return new outputstreamwriter out
@converter
public static stringreader toreader string text
// todo could we automatically find this?
return new stringreader text
@converter
public static inputstream toinputstream string text
return toinputstream text getbytes
@converter
public static inputstream toinputstream bufferedreader buffer  throws ioexception
return toinputstream tostring buffer
@converter
public static inputstream toinputstrean domsource source  throws transformerexception  ioexception
bytearrayinputstream bais   new bytearrayinputstream tostring source  getbytes
return bais
@converter
public static string tostring byte data
return new string data
@converter
public static string tostring file file  throws ioexception
return tostring toreader file
@converter
public static string tostring url url  throws ioexception
return tostring toinputstream url
@converter
public static string tostring reader reader  throws ioexception
if  reader instanceof bufferedreader
return tostring  bufferedreader reader
else
return tostring new bufferedreader reader
@converter
public static string tostring bufferedreader reader  throws ioexception
if  reader    null
return null
try
collectionstringbuffer builder   new collectionstringbuffer
while  true
string line   reader readline
if  line    null
return builder tostring
builder append line
finally
try
reader close
catch  ioexception e
log warn     e  e
@converter
public static string tostring inputstream in  throws ioexception
return tostring toreader in
public static string tostring source source  throws transformerexception  ioexception
return tostring source  null
public static string tostring source source  properties props  throws transformerexception  ioexception
bytearrayoutputstream bos   new bytearrayoutputstream
streamresult sr   new streamresult bos
transformer trans   transformerfactory newinstance   newtransformer
if  props    null
props   new properties
props put outputkeys omit_xml_declaration
trans setoutputproperties props
trans transform source  sr
bos close
return bos tostring
@converter
public static inputstream toinputstream byte data
return new bytearrayinputstream data
@converter
public static objectoutput toobjectoutput outputstream stream  throws ioexception
if  stream instanceof objectoutput
return  objectoutput  stream
else
return new objectoutputstream stream
@converter
public static objectinput toobjectinput inputstream stream  throws ioexception
if  stream instanceof objectinput
return  objectinput  stream
else
return new objectinputstream stream
@converter
public static byte tobytes inputstream stream  throws ioexception
bytearrayoutputstream bos   new bytearrayoutputstream
copy stream  bos
return bos tobytearray
protected static void copy inputstream stream  bytearrayoutputstream bos  throws ioexception
byte data   new byte
int read   stream read data
while  read     1
bos write data  0  read
read   stream read data
bos flush