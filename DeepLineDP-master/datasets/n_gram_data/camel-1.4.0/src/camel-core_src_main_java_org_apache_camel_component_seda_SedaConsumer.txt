/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel component seda
import java util concurrent timeunit
import org apache camel asynccallback
import org apache camel asyncprocessor
import org apache camel consumer
import org apache camel exchange
import org apache camel processor
import org apache camel impl servicesupport
import org apache camel impl converter asyncprocessortypeconverter
import org apache commons logging log
import org apache commons logging logfactory
/**
* a consumer for the seda component.
*
* @version $revision$
*/
public class sedaconsumer extends servicesupport implements consumer  runnable
private static final transient log log   logfactory getlog sedaconsumer class
private sedaendpoint endpoint
private asyncprocessor processor
private thread thread
public sedaconsumer sedaendpoint endpoint  processor processor
this endpoint   endpoint
this processor   asyncprocessortypeconverter convert processor
@override
public string tostring
return     endpoint getendpointuri
public void run
while  isrunallowed
final exchange exchange
try
exchange   endpoint getqueue   poll 1000  timeunit milliseconds
catch  interruptedexception e
if  log isdebugenabled
log debug     e  e
continue
if  exchange    null    isrunallowed
try
processor process exchange  new asynccallback
public void done boolean sync
catch  exception e
log error     e  e
protected void dostart   throws exception
thread   new thread this  getthreadname endpoint getendpointuri
thread setdaemon true
thread start
protected void dostop   throws exception
thread join