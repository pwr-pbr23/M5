/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel loanbroker webservice version
import org apache camel exchange
import org apache camel loanbroker webservice version bank bankquote
import org apache camel processor aggregate aggregationstrategy
//start snippet: aggregating
public class bankresponseaggregationstrategy implements aggregationstrategy
public static final string bank_quote
public exchange aggregate exchange oldexchange  exchange newexchange
// get the bank quote instance from the exchange
bankquote oldquote   oldexchange getproperty bank_quote  bankquote class
// get the oldqute from out message body if we can't get it from the exchange
if  oldquote    null
object oldresult    object oldexchange getout   getbody
oldquote    bankquote  oldresult
// get the newquote
object newresult    object newexchange getout   getbody
bankquote newquote    bankquote  newresult
exchange result   null
bankquote bankquote
if  newquote getrate   >  oldquote getrate
result   oldexchange
bankquote   oldquote
else
result   newexchange
bankquote   newquote
// set the lower rate bankquote instance back to aggregated exchange
result setproperty bank_quote  bankquote
// set the return message for the client
result getout   setbody     bankquote tostring
return result
//end snippet: aggregating