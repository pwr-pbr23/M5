/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel component stringtemplate
import java io stringwriter
import java util map
import org antlr stringtemplate autoindentwriter
import org antlr stringtemplate stringtemplate
import org apache camel exchange
import org apache camel exchangepattern
import org apache camel message
import org apache camel processor
import org apache camel component resourcebasedendpoint
import org apache camel converter ioconverter
import org apache camel util exchangehelper
/**
* @version $revision$
*/
public class stringtemplateendpoint extends resourcebasedendpoint
public stringtemplateendpoint string uri  stringtemplatecomponent component  string resourceuri  map parameters
super uri  component  resourceuri  null
public stringtemplateendpoint string endpointuri  processor processor  string resourceuri
super endpointuri  processor  resourceuri
@override
public boolean issingleton
return true
@override
public exchangepattern getexchangepattern
return exchangepattern inout
@override
protected void onexchange exchange exchange  throws exception
stringwriter buffer   new stringwriter
map variablemap   exchangehelper createvariablemap exchange
// getresourceasinputstream also considers the content cache
string text   ioconverter tostring getresourceasinputstream
stringtemplate template   new stringtemplate text
template setattributes variablemap
if  log isdebugenabled
log debug     variablemap
template write new autoindentwriter buffer
// now lets output the results to the exchange
message out   exchange getout true
out setbody buffer tostring
out setheader    getresource