/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel component jpa
import java util arrays
import java util collection
import java util map
import java util set
import javax persistence entitymanager
import javax persistence query
/**
* a builder of query expressions
*
* @version $revision$
*/
public abstract class querybuilder implements queryfactory
parameterbuilder parameterbuilder
/**
* creates a query builder using the jpa query syntax
*
* @param query jpa query language to create
* @return a query builder
*/
public static querybuilder query final string query
return new querybuilder
protected query makequeryobject entitymanager entitymanager
return entitymanager createquery query
@override
public string tostring
return     query       getparameterdescription
/**
* creates a named query
*/
public static querybuilder namedquery final string namedquery
return new querybuilder
protected query makequeryobject entitymanager entitymanager
return entitymanager createnamedquery namedquery
@override
public string tostring
return     namedquery   getparameterdescription
/**
* creates a native sql query
*/
public static querybuilder nativequery final string nativequery
return new querybuilder
protected query makequeryobject entitymanager entitymanager
return entitymanager createnativequery nativequery
@override
public string tostring
return     nativequery   getparameterdescription
/**
* specifies the parameters to the query
*
* @param parameters the parameters to be configured on the query
* @return this query builder
*/
public querybuilder parameters object    parameters
return parameters arrays aslist parameters
/**
* specifies the parameters to the query as an ordered collection of
* parameters
*
* @param parameters the parameters to be configured on the query
* @return this query builder
*/
public querybuilder parameters final collection parameters
checknoparametersconfigured
parameterbuilder   new parameterbuilder
public void populatequery entitymanager entitymanager  query query
int counter   0
for  object parameter   parameters
query setparameter counter    parameter
@override
public string tostring
return     parameters
return this
/**
* specifies the parameters to the query as a map of key/value pairs
*
* @param parametermap the parameters to be configured on the query
* @return this query builder
*/
public querybuilder parameters final map<string  object> parametermap
checknoparametersconfigured
parameterbuilder   new parameterbuilder
public void populatequery entitymanager entitymanager  query query
set<map entry<string  object>> entries   parametermap entryset
for  map entry<string  object> entry   entries
query setparameter entry getkey    entry getvalue
@override
public string tostring
return     parametermap
return this
protected void checknoparametersconfigured
if  parameterbuilder    null
throw new illegalargumentexception
public query createquery entitymanager entitymanager
query query   makequeryobject entitymanager
populatequery entitymanager  query
return query
protected string getparameterdescription
if  parameterbuilder    null
return
else
return     parameterbuilder tostring
protected void populatequery entitymanager entitymanager  query query
if  parameterbuilder    null
parameterbuilder populatequery entitymanager  query
protected abstract query makequeryobject entitymanager entitymanager
/**
* a plugin strategy to populate the query with parameters
*/
protected abstract static class parameterbuilder
public abstract void populatequery entitymanager entitymanager  query query