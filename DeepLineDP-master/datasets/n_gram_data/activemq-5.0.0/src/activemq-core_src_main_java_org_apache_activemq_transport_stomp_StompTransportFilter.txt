/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq transport stomp
import java io ioexception
import javax jms jmsexception
import org apache activemq command command
import org apache activemq transport transport
import org apache activemq transport transportfilter
import org apache activemq util ioexceptionsupport
import org apache commons logging log
import org apache commons logging logfactory
/**
* the stomptransportfilter normally sits on top of a tcptransport that has been
* configured with the stompwireformat and is used to convert stomp commands to
* activemq commands. all of the coversion work is done by delegating to the
* protocolconverter.
*
* @author <a href="http://hiramchirino.com">chirino</a>
*/
public class stomptransportfilter extends transportfilter
private static final log log   logfactory getlog stomptransportfilter class
private final protocolconverter protocolconverter
private final object sendtoactivemqmutex   new object
private final object sendtostompmutex   new object
private final frametranslator frametranslator
private boolean trace
public stomptransportfilter transport next  frametranslator translator
super next
this frametranslator   translator
this protocolconverter   new protocolconverter this  translator
public void oneway object o  throws ioexception
try
final command command    command o
protocolconverter onactivemqcommad command
catch  jmsexception e
throw ioexceptionsupport create e
public void oncommand object command
try
if  trace
log trace     command
protocolconverter onstompcommad  stompframe command
catch  ioexception e
onexception e
catch  jmsexception e
onexception ioexceptionsupport create e
public void sendtoactivemq command command
synchronized  sendtoactivemqmutex
transportlistener oncommand command
public void sendtostomp stompframe command  throws ioexception
if  trace
log trace     command
synchronized  sendtostompmutex
next oneway command
public frametranslator getframetranslator
return frametranslator
public boolean istrace
return trace
public void settrace boolean trace
this trace   trace