/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq kaha impl index
import org apache activemq kaha storeentry
/**
* a linked list used by indexitems
*
* @version $revision: 1.2 $
*/
public final class vmindexlinkedlist implements cloneable  indexlinkedlist
private transient indexitem root
private transient int size
/**
* constructs an empty list.
* @param header
*/
public vmindexlinkedlist indexitem header
this root   header
this root next this root prev this root
public  void setroot indexitem newroot
this root newroot
public synchronized indexitem getroot
return root
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#getfirst()
*/
public synchronized indexitem getfirst
if  size    0
return null
return root next
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#getlast()
*/
public synchronized indexitem getlast
if  size    0
return null
return root prev
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#removefirst()
*/
public synchronized storeentry removefirst
if  size    0
return null
storeentry result   root next
remove root next
return result
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#removelast()
*/
public synchronized object removelast
if  size    0
return null
storeentry result   root prev
remove root prev
return result
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#addfirst(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized void addfirst indexitem item
addbefore item  root next
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#addlast(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized void addlast indexitem item
addbefore item  root
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#size()
*/
public synchronized int size
return size
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#isempty()
*/
public synchronized boolean isempty
return size    0
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#add(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized boolean add indexitem item
addbefore item  root
return true
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#clear()
*/
public synchronized void clear
root next root prev root
size   0
// positional access operations
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#get(int)
*/
public synchronized indexitem get int index
return entry index
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#add(int,
*      org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized void add int index  indexitem element
addbefore element  index    size ? root   entry index
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#remove(int)
*/
public synchronized object remove int index
indexitem e   entry index
remove e
return e
/**
* return the indexed entry.
*/
private indexitem entry int index
if  index < 0    index >  size
throw new indexoutofboundsexception     index       size
indexitem e   root
if  index < size   2
for  int i   0  i <  index  i
e   e next
else
for  int i   size  i > index  i
e   e prev
return e
// search operations
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#indexof(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized int indexof storeentry o
int index   0
for  indexitem e   root next  e    root  e   e next
if  o    e
return index
index
return  1
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#getnextentry(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized indexitem getnextentry indexitem entry
return entry next    root ? entry next   null
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#getpreventry(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized indexitem getpreventry indexitem entry
return entry prev    root ? entry prev   null
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#addbefore(org.apache.activemq.kaha.impl.indexitem,
*      org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized void addbefore indexitem insert  indexitem e
insert next   e
insert prev   e prev
insert prev next   insert
insert next prev   insert
size
/*
* (non-javadoc)
*
* @see org.apache.activemq.kaha.impl.indexlinkedlist#remove(org.apache.activemq.kaha.impl.indexitem)
*/
public synchronized void remove indexitem e
if  e    root    e equals root
return
e prev next   e next
e next prev   e prev
size
/**
* @return clone
*/
public synchronized object clone
indexlinkedlist clone   new vmindexlinkedlist this root
for  indexitem e   root next  e    root  e   e next
clone add e
return clone
public synchronized storeentry getentry storeentry current
return current
/**
* update the indexes of a storeentry
*
* @param current
*/
public synchronized storeentry refreshentry storeentry current
return current