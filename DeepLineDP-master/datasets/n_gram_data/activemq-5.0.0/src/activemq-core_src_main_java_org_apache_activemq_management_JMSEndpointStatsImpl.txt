/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq management
import javax jms destination
import javax jms messageconsumer
import javax jms messageproducer
import javax jms session
import org apache activemq util indentprinter
import org apache commons logging log
import org apache commons logging logfactory
/**
* statistics for a jms endpoint, typically a messageproducer or messageconsumer
* but this class can also be used to represent statistics on a
* {@link destination} as well.
*
* @version $revision: 1.3 $
*/
public class jmsendpointstatsimpl extends statsimpl
private static final log log   logfactory getlog jmsendpointstatsimpl class
protected countstatisticimpl messagecount
protected countstatisticimpl pendingmessagecount
protected countstatisticimpl expiredmessagecount
protected timestatisticimpl messagewaittime
protected timestatisticimpl messageratetime
/**
* this constructor is used to create statistics for a
* {@link messageproducer} or {@link messageconsumer} as it passes in a
* {@link session} parent statistic.
*
* @param sessionstats
*/
public jmsendpointstatsimpl jmssessionstatsimpl sessionstats
this
setparent messagecount  sessionstats getmessagecount
setparent pendingmessagecount  sessionstats getpendingmessagecount
setparent expiredmessagecount  sessionstats getexpiredmessagecount
setparent messagewaittime  sessionstats getmessagewaittime
setparent messageratetime  sessionstats getmessageratetime
/**
* this constructor is typically used to create a statistics object for a
* {@link destination}
*/
public jmsendpointstatsimpl
this new countstatisticimpl        new countstatisticimpl
new countstatisticimpl
new timestatisticimpl        new timestatisticimpl
public jmsendpointstatsimpl countstatisticimpl messagecount  countstatisticimpl pendingmessagecount  countstatisticimpl expiredmessagecount  timestatisticimpl messagewaittime
timestatisticimpl messageratetime
this messagecount   messagecount
this pendingmessagecount   pendingmessagecount
this expiredmessagecount   expiredmessagecount
this messagewaittime   messagewaittime
this messageratetime   messageratetime
// lets add named stats
addstatistic    messagecount
addstatistic    pendingmessagecount
addstatistic    expiredmessagecount
addstatistic    messagewaittime
addstatistic    messageratetime
public synchronized void reset
super reset
messagecount reset
messageratetime reset
pendingmessagecount reset
expiredmessagecount reset
messagewaittime reset
public countstatisticimpl getmessagecount
return messagecount
public countstatisticimpl getpendingmessagecount
return pendingmessagecount
public countstatisticimpl getexpiredmessagecount
return expiredmessagecount
public timestatisticimpl getmessageratetime
return messageratetime
public timestatisticimpl getmessagewaittime
return messagewaittime
public string tostring
stringbuffer buffer   new stringbuffer
buffer append messagecount
buffer append
buffer append messageratetime
buffer append
buffer append pendingmessagecount
buffer append
buffer append expiredmessagecount
buffer append
buffer append messagewaittime
return buffer tostring
public void onmessage
if  enabled
long start   messagecount getlastsampletime
messagecount increment
long end   messagecount getlastsampletime
messageratetime addtime end   start
public void dump indentprinter out
out printindent
out println messagecount
out printindent
out println messageratetime
out printindent
out println pendingmessagecount
out printindent
out println messageratetime
out printindent
out println expiredmessagecount
out printindent
out println messagewaittime
// implementation methods
// -------------------------------------------------------------------------
protected void setparent countstatisticimpl child  countstatisticimpl parent
if  child instanceof countstatisticimpl    parent instanceof countstatisticimpl
countstatisticimpl c    countstatisticimpl child
c setparent  countstatisticimpl parent
else
log warn     child       parent
protected void setparent timestatisticimpl child  timestatisticimpl parent
if  child instanceof timestatisticimpl    parent instanceof timestatisticimpl
timestatisticimpl c    timestatisticimpl child
c setparent  timestatisticimpl parent
else
log warn     child       parent