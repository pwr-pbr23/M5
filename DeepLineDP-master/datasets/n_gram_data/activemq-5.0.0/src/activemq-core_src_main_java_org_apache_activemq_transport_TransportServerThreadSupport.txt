/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq transport
import java net uri
import org apache activemq threadpriorities
import org apache activemq util servicestopper
import org apache commons logging log
import org apache commons logging logfactory
/**
* a useful base class for implementations of {@link transportserver} which uses
* a background thread to accept new connections.
*
* @version $revision: 1.1 $
*/
public abstract class transportserverthreadsupport extends transportserversupport implements runnable
private static final log log   logfactory getlog transportserverthreadsupport class
private boolean daemon   true
private boolean joinonstop   true
private thread runner
// should be a multiple of 128k
private long stacksize
public transportserverthreadsupport
public transportserverthreadsupport uri location
super location
public boolean isdaemon
return daemon
/**
* sets whether the background read thread is a daemon thread or not
*/
public void setdaemon boolean daemon
this daemon   daemon
public boolean isjoinonstop
return joinonstop
/**
* sets whether the background read thread is joined with (waited for) on a
* stop
*/
public void setjoinonstop boolean joinonstop
this joinonstop   joinonstop
protected void dostart   throws exception
log info     getconnecturi
runner   new thread null  this      tostring    stacksize
runner setdaemon daemon
runner setpriority threadpriorities broker_management
runner start
protected void dostop servicestopper stopper  throws exception
if  runner    null    joinonstop
runner join
runner   null
/**
* @return the stacksize
*/
public long getstacksize
return this stacksize
/**
* @param stacksize the stacksize to set
*/
public void setstacksize long stacksize
this stacksize   stacksize