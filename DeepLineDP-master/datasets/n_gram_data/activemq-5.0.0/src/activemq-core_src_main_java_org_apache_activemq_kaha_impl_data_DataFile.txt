/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq kaha impl data
import java io file
import java io filenotfoundexception
import java io ioexception
import java io randomaccessfile
/**
* datafile
*
* @version $revision: 1.1.1.1 $
*/
class datafile
private file file
private integer number
private int referencecount
private randomaccessfile randomacessfile
private object writerdata
private long length
private boolean dirty
datafile file file  int number
this file   file
this number   integer valueof number
length   file exists   ? file length     0
integer getnumber
return number
synchronized randomaccessfile getrandomaccessfile   throws filenotfoundexception
if  randomacessfile    null
randomacessfile   new randomaccessfile file
return randomacessfile
synchronized long getlength
return length
synchronized void incrementlength int size
length    size
synchronized void purge   throws ioexception
if  randomacessfile    null
randomacessfile close
randomacessfile   null
synchronized boolean delete   throws ioexception
purge
return file delete
synchronized void close   throws ioexception
if  randomacessfile    null
randomacessfile close
synchronized int increment
return   referencecount
synchronized int decrement
return   referencecount
synchronized boolean isunused
return referencecount <  0
public string tostring
string result   file getname         number       length       referencecount
return result
/**
* @return opaque data that a datafilewriter may want to associate with the
*         datafile.
*/
public synchronized object getwriterdata
return writerdata
/**
* @param writerdata - opaque data that a datafilewriter may want to
*                associate with the datafile.
*/
public synchronized void setwriterdata object writerdata
this writerdata   writerdata
dirty   true
public synchronized boolean isdirty
return dirty
public synchronized void setdirty boolean value
this dirty   value