/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq ra
import javax resource resourceexception
import javax resource spi connectionevent
import javax resource spi connectioneventlistener
import javax resource spi connectionmanager
import javax resource spi connectionrequestinfo
import javax resource spi managedconnection
import javax resource spi managedconnectionfactory
import javax security auth subject
import org apache commons logging log
import org apache commons logging logfactory
/**
* a simple implementation of a connectionmanager. an application server will
* have a better implementation with pooling and security etc.
*
* @version $revision$
*/
public class simpleconnectionmanager implements connectionmanager  connectioneventlistener
private static final long serialversionuid    7662970495944876239l
private static final log log   logfactory getlog simpleconnectionmanager class
/**
* @see javax.resource.spi.connectionmanager#allocateconnection(javax.resource.spi.managedconnectionfactory,
*      javax.resource.spi.connectionrequestinfo)
*/
public object allocateconnection managedconnectionfactory connectionfactory  connectionrequestinfo info  throws resourceexception
subject subject   null
managedconnection connection   connectionfactory createmanagedconnection subject  info
connection addconnectioneventlistener this
return connection getconnection subject  info
/**
* @see javax.resource.spi.connectioneventlistener#connectionclosed(javax.resource.spi.connectionevent)
*/
public void connectionclosed connectionevent event
try
managedconnection event getsource    cleanup
catch  resourceexception e
log warn    e
try
managedconnection event getsource    destroy
catch  resourceexception e
log warn    e
/**
* @see javax.resource.spi.connectioneventlistener#localtransactionstarted(javax.resource.spi.connectionevent)
*/
public void localtransactionstarted connectionevent event
/**
* @see javax.resource.spi.connectioneventlistener#localtransactioncommitted(javax.resource.spi.connectionevent)
*/
public void localtransactioncommitted connectionevent event
/**
* @see javax.resource.spi.connectioneventlistener#localtransactionrolledback(javax.resource.spi.connectionevent)
*/
public void localtransactionrolledback connectionevent event
/**
* @see javax.resource.spi.connectioneventlistener#connectionerroroccurred(javax.resource.spi.connectionevent)
*/
public void connectionerroroccurred connectionevent event
log warn    event getexception
try
managedconnection event getsource    cleanup
catch  resourceexception e
log warn    e
try
managedconnection event getsource    destroy
catch  resourceexception e
log warn    e