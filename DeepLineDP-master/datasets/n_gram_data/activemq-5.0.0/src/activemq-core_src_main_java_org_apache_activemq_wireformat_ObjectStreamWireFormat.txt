/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache activemq wireformat
import java io datainput
import java io datainputstream
import java io dataoutput
import java io dataoutputstream
import java io ioexception
import java io inputstream
import java io objectoutputstream
import java io outputstream
import org apache activemq util bytearrayinputstream
import org apache activemq util bytearrayoutputstream
import org apache activemq util bytesequence
import org apache activemq util classloadingawareobjectinputstream
/**
* a simple implementation which uses object stream serialization.
*
* @version $revision: 1.1 $
*/
public class objectstreamwireformat implements wireformat
public bytesequence marshal object command  throws ioexception
bytearrayoutputstream baos   new bytearrayoutputstream
dataoutputstream ds   new dataoutputstream baos
marshal command  ds
ds close
return baos tobytesequence
public object unmarshal bytesequence packet  throws ioexception
return unmarshal new datainputstream new bytearrayinputstream packet
public void marshal object command  dataoutput ds  throws ioexception
objectoutputstream out   new objectoutputstream  outputstream ds
out writeobject command
out flush
out reset
public object unmarshal datainput ds  throws ioexception
try
classloadingawareobjectinputstream in   new classloadingawareobjectinputstream  inputstream ds
object command
command   in readobject
in close
return command
catch  classnotfoundexception e
throw  ioexception new ioexception     e  initcause e
public void setversion int version
public int getversion
return 0