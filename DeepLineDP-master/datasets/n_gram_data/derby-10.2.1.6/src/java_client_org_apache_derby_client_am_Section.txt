/*
*
* derby - class org.apache.derby.client.am.section
*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
* http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software distributed under the license is distributed on
* an "as is" basis, without warranties or conditions of any kind, either express or implied. see the license for the
* specific language governing permissions and limitations under the license.
*
*/
package org apache derby client am
public class section
protected int sectionnumber
protected string packagename
protected string servercursorname     as given by dnc package set
int resultsetholdability_
// stores the package name and consistency token
byte pkgnamcbytes
boolean isgenerated     flag to identify server generated sections
public section agent agent  string name  int sectionnumber  string cursorname  int resultsetholdability
// default for all sections except for generated section , isgenerated is set to false
init agent  name  sectionnumber  cursorname  resultsetholdability  false
public section agent agent  string name  int sectionnumber  string cursorname  int resultsetholdability  boolean isgenerated
init agent  name  sectionnumber  cursorname  resultsetholdability  isgenerated
private void init agent agent  string name  int sectionnumber  string cursorname  int resultsetholdability  boolean isgenerated
this packagename   name
this sectionnumber   sectionnumber
this servercursorname   cursorname
resultsetholdability_   resultsetholdability
agent_   agent
this isgenerated   isgenerated
// store the packagename and consistency token bytes depending on the holdability
// pkgnamcbytes will point to the appropriate byte array in sectionmanager
// that stores the pkgnamcbytes for reuse
// there are 2 byte arrays in sectionmanager
// 1. holdpkgnamcbytes which stores the pkgnamcbytes when holdability is set
// 2. noholdpkgnamcbytes which stores the pkgnamcbytes when holdability is non hold
// note for generated sections, pkgnamcbytes is generated by the server.
if   isgenerated
if  resultsetholdability_    resultset hold_cursors_over_commit
pkgnamcbytes   agent_ sectionmanager_ holdpkgnamcbytes
else if  resultsetholdability_    resultset close_cursors_at_commit
pkgnamcbytes   agent_ sectionmanager_ noholdpkgnamcbytes
/**
* store the packagename and consistency token information for reuse. case 1: if it is generated section, just store
* the byte array in pkgnamcbytes case 2: for not a generated section, information is stored in the correct byte
* array depending on the holdability in sectionmanager
*/
public void setpkgnamcbytes byte b
if  isgenerated
pkgnamcbytes   b
else
agent_ sectionmanager_ setpkgnamcbytes b  resultsetholdability_
/**
* retrieve the package name and consistency token information
*/
public byte getpkgnamcbytes
return pkgnamcbytes
public string getpackagename
return this packagename
// add a finalizer to free() the section, useful for statement.executes that result in exceptions
public int getsectionnumber
return this sectionnumber
public string getpackage
return this packagename
public string getservercursorname
return this servercursorname
// ------------------------ transient members --------------------------------
public string servercursornameforpositionedupdate_   null     member for positioned update sections only
transient protected string clientcursorname_     as given by jdbc setcursorname    this can change
public string getservercursornameforpositionedupdate
return servercursornameforpositionedupdate_
public string getclientcursorname
return clientcursorname_
public void setclientcursorname string clientcursorname
//system.out.println("clientcursorname is set"+ clientcursorname);
this clientcursorname_   clientcursorname
protected agent agent_
public void free
if  resultsetholdability_     1
this agent_ sectionmanager_ freesection this  resultsetholdability_
public boolean isreservedpositionedupdate
return false
public int getstaticstatementtype
return 0
public section getpositionedupdatesection   throws sqlexception
return agent_ sectionmanager_ getpositionedupdatesection this
public void setcursorname string name
servercursorname   name