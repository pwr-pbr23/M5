/*
derby - class org.apache.derby.impl.db.databasecontextimpl
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby impl db
import org apache derby iapi services context contextimpl
import org apache derby iapi services context contextmanager
import org apache derby iapi services context contextservice
import org apache derby iapi services monitor monitor
import org apache derby iapi db database
import org apache derby iapi db databasecontext
import org apache derby iapi error standardexception
import org apache derby iapi error exceptionseverity
/**
a context that shutdowns down the database on a databsae exception.
*/
final class databasecontextimpl extends contextimpl implements databasecontext
private final database	db
databasecontextimpl contextmanager cm  database db
super cm  databasecontextimpl context_id
this db   db
public void cleanuponerror throwable t
if    t instanceof standardexception   return
standardexception se    standardexception t
// ensure the context is popped if the session is
// going away.
if  se getseverity   < exceptionseverity session_severity
return
popme
if  se getseverity      exceptionseverity database_severity
contextservice getfactory   notifyallactivethreads this
monitor getmonitor   shutdown db
public boolean equals object other
if  other instanceof databasecontext
return   databasecontextimpl  other  db    db
return false
public int hashcode
return db hashcode
public database getdatabase    return db