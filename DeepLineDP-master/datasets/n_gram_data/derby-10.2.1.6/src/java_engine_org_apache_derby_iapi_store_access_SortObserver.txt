/*
derby - class org.apache.derby.iapi.store.access.sortobserver
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby iapi store access
import org apache derby iapi types datavaluedescriptor
import org apache derby iapi error standardexception
/**
* a sortobserver is an object that is used as a callback by the
* sorter.  it allows the sort client to do whatever they want
* from the context of a sort.  it contains 2 callback methods:
* <i>insertduplicatekey()</i> and <i>insertnonduplicatekey()</i>.
* on each <i>sortcontroller.insert()</i>, one or the other of these
* methods will be called, depending on whether the given row has a
* key that has been seen before or not.
* <p>
* some sample uses include:
* <ul><li>
*
* <i>sorts from language</i>: language typically recycles
* data type wrappers.  so the language layer uses sortobservers
* to clone rows that are kept by the sorter.
* </li>
*
* <li>
* <i>distinct sorts</i>: the sorter will call the sort observer
* each time it identifies a duplicate row.  based on what the
* sort observer returns to the sorter, the sorter will either
* retain (insert) the duplicate row, or discard the duplicate
* row.  all you have to do to implement a distinct sort is to
* tell the sorter to discard the row (return null from <i>
* insertduplicatekey()</i>).  also, if you want to throw an
* exception on a duplicate (e.g. create a unique index), you
* can just throw an exception from your sortobserver.
* </li>
*
* <li>
* <i>aggregates</i>: vector (grouped) aggregates typically require
* a sort.  language can use a sortobserver to perform aggregations
* as duplicate elements are encountered.  scalar aggregates
* can also be computed using a sortobserver.
* </li>
* </ul>
*
* these are possible uses only.  you, kind reader, may do whatever
* you wish with this forgiving interface.
*
* @see sortcontroller
*
**/
public interface sortobserver
/**
* called prior to inserting a distinct sort
* key; in other words, the first time that a
* key is inserted into the sorter, this method
* is called.  subsequent inserts with the same
* key generate a call to insertduplicatekey()
* instead.
* <p>
* this method will most commonly be used to clone
* the row that is retained by the sorter, or possibly
* to do some initialization of that row.
*
* @param insertrow the current row that the sorter
* 		is on the verge of retaining
*
* @return the row to be inserted by the sorter.  if null,
*		then nothing is inserted by the sorter.
*
* @exception standardexception either on unexpected exception,
* 		or on expected user error that is to percolate back
*		to the driver of the sort.
*/
datavaluedescriptor insertnonduplicatekey
datavaluedescriptor insertrow
throws standardexception
/**
* called prior to inserting a duplicate sort
* key.   this method will typically be used
* to perform some aggregation on a row that is
* going to be discarded by the sorter.
*
* @param insertrow the current row that the sorter
* 		is on the verge of retaining.  it is a duplicate
* 		of existingrow.
*
* @param existingrow the row that is already in the
* 		the sorter which is a duplicate of insertrow
*
* @return the row to be inserted by the sorter.  if null,
*		then nothing is inserted by the sorter.  distinct
*		sorts will want to return null.
*
* @exception standardexception either on unexpected exception,
* 		or on expected user error that is to percolate back
*		to the driver of the sort.
*/
datavaluedescriptor insertduplicatekey
datavaluedescriptor insertrow
datavaluedescriptor existingrow
throws standardexception
public void addtofreelist
datavaluedescriptor   objectarray
int                     maxfreelistsize
public datavaluedescriptor getarrayclone
throws standardexception