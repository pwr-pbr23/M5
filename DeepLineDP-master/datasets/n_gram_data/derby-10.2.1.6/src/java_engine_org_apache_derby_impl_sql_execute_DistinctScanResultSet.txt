/*
derby - class org.apache.derby.impl.sql.execute.distinctscanresultset
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby impl sql execute
import org apache derby iapi services loader generatedmethod
import org apache derby iapi services monitor monitor
import org apache derby iapi services sanity sanitymanager
import org apache derby iapi services io storable
import org apache derby iapi services stream headerprintwriter
import org apache derby iapi services stream infostreams
import org apache derby iapi sql conn languageconnectioncontext
import org apache derby iapi error standardexception
import org apache derby iapi sql execute cursorresultset
import org apache derby iapi sql execute execindexrow
import org apache derby iapi sql execute execrow
import org apache derby iapi sql execute executioncontext
import org apache derby iapi sql execute noputresultset
import org apache derby iapi sql activation
import org apache derby iapi sql resultset
import org apache derby iapi store access conglomeratecontroller
import org apache derby iapi store access qualifier
import org apache derby iapi store access scancontroller
import org apache derby iapi store access staticcompiledopenconglominfo
import org apache derby iapi store access transactioncontroller
import org apache derby iapi types rowlocation
import org apache derby iapi services io formatablebitset
import org apache derby iapi services io formatablearrayholder
import org apache derby iapi services io formatableintholder
import java util enumeration
import java util properties
import java util vector
/**
* eliminates duplicates while scanning the underlying conglomerate.
* (assumes no predicates, for now.)
*
* @author jerry
*/
class distinctscanresultset extends hashscanresultset
enumeration element   null
//
// class interface
//
distinctscanresultset long conglomid
staticcompiledopenconglominfo scoci  activation activation
generatedmethod resultrowallocator
int resultsetnumber
int hashkeyitem
string tablename
string usersuppliedoptimizeroverrides
string indexname
boolean isconstraint
int colrefitem
int lockmode
boolean tablelocked
int isolationlevel
double optimizerestimatedrowcount
double optimizerestimatedcost
throws standardexception
super conglomid  scoci  activation  resultrowallocator  resultsetnumber
generatedmethod  null     startkeygetter
0 					     startsearchoperator
generatedmethod  null     stopkeygetter
0 					     stopsearchoperator
false 				     samestartstopposition
qualifier  null 	     scanqualifiers
qualifier  null 	     nextqualifiers
default_initial_capacity  default_loadfactor  default_max_capacity
hashkeyitem  tablename  usersuppliedoptimizeroverrides  indexname  isconstraint
false 				     forupdate
colrefitem  lockmode  tablelocked  isolationlevel
false
optimizerestimatedrowcount  optimizerestimatedcost
// tell super class to eliminate duplicates
eliminateduplicates   true
//
// resultset interface (override methods from hashscanresultset)
//
/**
* return the next row (if any) from the scan (if open).
*
* @exception standardexception thrown on failure to get next row
*/
public execrow getnextrowcore   throws standardexception
execrow result   null
object columns   null
begintime   getcurrenttimemillis
if   isopen
if  firstnext
element   hashtable elements
firstnext   false
if  element hasmoreelements
columns    object  element nextelement
setcompatrow compactrow  columns
rowsseen
result   compactrow
// else done
currentrow   result
setcurrentrow result
nexttime    getelapsedmillis begintime
return result