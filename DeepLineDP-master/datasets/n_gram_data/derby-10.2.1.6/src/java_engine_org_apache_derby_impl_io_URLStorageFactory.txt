/*
derby - class org.apache.derby.impl.io.urlstoragefactory
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby impl io
import org apache derby iapi services sanity sanitymanager
import org apache derby io storagefactory
import org apache derby io storagefile
import java io filenotfoundexception
import java io inputstream
import java io outputstream
import java io ioexception
/**
* this class provides a http based implementation of the storagefactory interface. it is used by the
* database engine to access persistent data and transaction logs under the http and https subsubprotocols.
*/
public class urlstoragefactory extends basestoragefactory
/**
* construct a persistent storagefile from a path name.
*
* @param path the path name of the file
*
* @return a corresponding storagefile object
*/
storagefile newpersistentfile  string path
return new urlfile  this  path
/**
* construct a storagefile from a directory and file name.
*
* @param directoryname the directory part of the path name. must not be null, nor may it be in the temp dir.
* @param filename the name of the file within the directory.
*
* @return a corresponding storagefile object
*/
storagefile newpersistentfile  string directoryname  string filename
if  directoryname    null    directoryname length      0
return newpersistentfile  filename
return new urlfile  this  directoryname  filename
/**
* construct a storagefile from a directory and file name.
*
* @param directoryname the directory part of the path name.
* @param filename the name of the file within the directory.
*
* @return a corresponding storagefile object
*/
storagefile newpersistentfile  storagefile directoryname  string filename
if  directoryname    null
return newpersistentfile  filename
return new urlfile   urlfile  directoryname  filename
void doinit   throws ioexception
if  datadirectory    null
if  datadirectory endswith
separateddatadirectory   datadirectory
datadirectory   datadirectory substring  0  datadirectory length     1
else
separateddatadirectory   datadirectory         urls use   as a separator
canonicalname   datadirectory
createtempdir
end of doinit