/*
derby - class org.apache.derby.iapi.sql.execute.execaggregator
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby iapi sql execute
import org apache derby iapi types datavaluedescriptor
import org apache derby iapi error standardexception
import org apache derby iapi services io formatable
/**
* an execaggregator is the interface that execution uses
* to an aggregate.  system defined aggregates will implement
* this directly.
<p>
the life time of an execaggregator is as follows.
<ol>
<li> an execaggregator instance is created using the defined class name.
<li> its setup() method is called to define its role (count(*), sum, etc.).
<li> its newaggregator() method may be called any number of times to create
new working aggregators as required. these aggregators have the same role
and must be created in an initialized state.
<li> accumlate and merge will be called across these set of aggregators
<li> one of these aggregators will be used as the final one for obtaining the result
</ol>
* <p>
*/
public interface execaggregator extends formatable
{
/**
set's up the aggregate for processing.
*/
public void setup string aggregatename
/**
* iteratively accumulates the addend into the aggregator.
* called on each member of the set of values that is being
* aggregated.
*
* @param addend	the datavaluedescriptor addend (current input to
* 					the aggregation)
* @param ga		a result set getter
*
* @exception standardexception on error
*/
public void accumulate
datavaluedescriptor addend
object				ga
throws standardexception
/**
* merges one aggregator into a another aggregator.
* merges two partial aggregates results into a single result.
* needed for: <ul>
*	<li> parallel aggregation </li>
*	<li> vector aggregation (group by) </li>
*  <li> distinct aggregates (e.g. max(distinct col)) </li></ul><p>
*
* an example of a merge would be: given two count()
* aggregators, c1 and c2, a merge of c1 into c2 would
* set c1.count += c2.count.  so, given a <i>countaggregator</i>
* with a <i>getcount()</i> method that returns its counts, its
* merge method might look like this: <pre>
public void merge(execaggregator inputaggregator) throws standardexception
{
&nbsp;&nbsp;&nbsp;count += ((countaccgregator)inputaggregator).getcount();
} </pre>
*
*
* @param inputaggregator	the other aggregator
*							(input partial aggregate)
*
* @exception standardexception on error
*/
public void merge execaggregator inputaggregator  throws standardexception
/**
* produces the result to be returned by the query.
* the last processing of the aggregate.
*
* @exception standardexception on error
*/
public datavaluedescriptor getresult   throws standardexception
/**
return a new initialized copy of this aggregator, any state
set by the setup() method of the original aggregator must be
copied into the new aggregator.
*
* @return execaggregator the new aggregator
*/
public execaggregator newaggregator
/**
return true if the aggregation eliminated at least one
null from the input data set.
*/
public boolean dideliminatenulls