/*
derby - class org.apache.derby.impl.store.raw.log.streamlogscan
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby impl store raw log
import org apache derby iapi store raw log loginstant
import org apache derby iapi store raw log logscan
import org apache derby iapi store raw xact transactionid
import org apache derby iapi error standardexception
import org apache derby iapi services io arrayinputstream
import java io inputstream
import java io ioexception
/**
logscan provides methods to read a log record and get its loginstant
in an already defined scan.  a logscan also needs to know how to advance to
the next log record.
*/
public interface streamlogscan extends logscan
/**
get the next record in the scan and place its data in the passed in
array.  the scan is advanced to the next log record.
if the input array is of insufficient size, getnextrecord must expand
the array to accomodate the log record.  user can optionally pass in a
transaction id and a group mask.  if provided, only log record that
matches the transaction id and the group mask is returned.
@param input        the arrayinputstream to put the log record
@param tranid       if non-null, only log record that equals tranid
will be returned.  if null, log records are not
filtered on transaction id.
@param groupmask    if non-zero, only log record whose loggable's group
value is included in the groupmask is returned.
groupmask can be a bit wise or of many loggable
groups.  if zero, log records are not filtered on
the loggable's group.
@return an object that represents the log record, return null if the
scan has completed.
@exception standardexception standard clooudscape error policy
@exception ioexception       some i/o exception raised during reading
the log record.
*/
public logrecord getnextrecord arrayinputstream input
transactionid tranid
int groupmask
throws standardexception  ioexception
/**
get the instant of the record just retrieved with getnextrecord().
@return invalid_log_instant if no records have been returned yet or
the scan has completed.
*/
public long getinstant
/**
get the log instant that is right after the record just retrieved with
getnextrecord().  only valid for a forward scan and on a successful
retrieval.
@return invalid_log_instant if this is not a forward scan or, no
record have been returned yet or the scan has completed.
*/
public long getlogrecordend
/**
@return true if  fuzzy log end found during forward scan, this happens
if there was a partially written log records before the crash.
*/
public boolean islogendfuzzy
/**
get the loginstant for the record just retrieved with getnextrecord().
@return null if no records have been returned yet or the scan has
completed.
*/
public loginstant getloginstant
/**
reset the scan to the given loginstant so that getnextrecord get the
log record after the given loginstant.
@param instant the log instant to reset to
@exception ioexception       some i/o exception raised when accessing
the log file
@exception standardexception reset to illegal position or beyond the
limit of the scan.
*/
public void resetposition loginstant instant
throws ioexception  standardexception
/**
close this log scan.
*/
public void close