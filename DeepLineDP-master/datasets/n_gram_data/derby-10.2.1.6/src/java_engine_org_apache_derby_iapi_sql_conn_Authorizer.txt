/*
derby - class org.apache.derby.iapi.sql.conn.authorizer
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby iapi sql conn
import org apache derby iapi sql activation
import org apache derby iapi error standardexception
/**
the authorizer verifies a connected user has the authorization
to perform a requested database operation using the current
connection.
<p>
today no object based authorization is supported.
*/
public interface authorizer
/** sql write (insert,update,delete) operation */
public static final int sql_write_op   0
/** sql select  operation */
public static final int	sql_select_op   1
/** any other sql operation	*/
public static final int	sql_arbitary_op   2
/** sql call/value  operation */
public static final int	sql_call_op   3
/** sql ddl operation */
public static final int sql_ddl_op     4
/** database property write operation */
public static final int property_write_op   5
/**  database jar write operation */
public static final int jar_write_op   6
/* privilege types for sql standard (grant/revoke) permissions checking. */
public static final int null_priv    1
public static final int select_priv   0
public static final int update_priv   1
public static final int references_priv   2
public static final int insert_priv   3
public static final int delete_priv   4
public static final int trigger_priv   5
public static final int execute_priv   6
public static final int priv_type_count   7
/* used to check who can create schemas or who can modify objects in schema */
public static final int create_schema_priv   16
public static final int modify_schema_priv   17
public static final int drop_schema_priv   18
/**
* the system authorization id is defined by the sql2003 spec as the grantor
* of privileges to object owners.
*/
public static final string system_authorization_id
/**
* the public authorization id is defined by the sql2003 spec as implying all users.
*/
public static final string public_authorization_id
/**
verify the connected user is authorized to perform the requested
operation.
this variation should only be used with operations that do not use tables
or routines. if the operation involves tables or routines then use the
variation of the authorize method that takes an activation parameter. the
activation holds the table, column, and routine lists.
@param operation the enumeration code for the requsted operation.
@exception standardexception thrown if the operation is not allowed
*/
public void authorize  int operation  throws standardexception
/**
verify the connected user is authorized to perform the requested
operation.
@param activation holds the list of tables, columns, and routines used.
@param operation the enumeration code for the requsted operation.
@exception standardexception thrown if the operation is not allowed
*/
public void authorize activation activation  int operation
throws standardexception
/**
get the authorization id for this authorizer.
*/
public string getauthorizationid
/**
get the readonly status for this authorizer's connection.
*/
public boolean isreadonlyconnection
/**
set the readonly status for this authorizer's connection.
@param on true means set the connection to read only mode,
false means set the connection to read wrte mode.
@param authorize true means to verify the caller has authority
to set the connection and false means do not check.
@exception standardexception oops not allowed.
*/
public void setreadonlyconnection boolean on  boolean authorize
throws standardexception
/**
refresh this authorizer to reflect a change in the database
permissions.
@exception authorizersessionexception connect permission gone.
@exception standardexception oops.
*/
public void refresh   throws standardexception