/*
derby - class org.apache.derby.ui.properties.derbypropertiespage
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby ui properties
import org apache derby ui common commonnames
import org apache derby ui common messages
import org apache derby ui util derbyserverutils
import org apache derby ui util logger
import org apache derby ui util selectionutil
import org eclipse core resources iproject
import org eclipse core runtime coreexception
import org eclipse core runtime istatus
import org eclipse jface dialogs messagedialog
import org eclipse swt swt
import org eclipse swt graphics color
import org eclipse swt layout griddata
import org eclipse swt layout gridlayout
import org eclipse swt widgets composite
import org eclipse swt widgets control
import org eclipse swt widgets label
import org eclipse swt widgets shell
import org eclipse swt widgets text
import org eclipse ui dialogs propertypage
public   class derbypropertiespage extends propertypage
public derbypropertiespage
super
protected derbyproperties dsprops
protected text hosttext
protected text porttext
protected text systemhometext
private boolean isserverrunning
protected void addcontrols composite parent
composite composite   createdefaultcomposite parent
//network server settings
label txt new label composite swt none
txt setbackground new color null 0 0 0
txt setforeground new color null 255 255 255
txt settext
//separator
label separatorlabel new label composite  swt separator   swt horizontal
separatorlabel setlayoutdata getseperatorlabelgriddata
org eclipse swt widgets
label portlabel   new label composite  swt none
portlabel settext
porttext   new text composite  swt single   swt border
griddata gd   new griddata
gd widthhint   convertwidthincharstopixels 6
porttext setlayoutdata gd
label hostlabel   new label composite  swt none
hostlabel settext
hosttext   new text composite  swt single   swt border
gd   new griddata
gd widthhint   convertwidthincharstopixels 16
hosttext setlayoutdata gd
//derby system properties
separatorlabel new label composite  swt none
separatorlabel setlayoutdata getseperatorlabelgriddata
separatorlabel settext
label txt1 new label composite swt none
txt1 setbackground new color null 0 0 0
txt1 setforeground new color null 255 255 255
txt1 settext
//separator
separatorlabel new label composite  swt separator   swt horizontal
separatorlabel setlayoutdata getseperatorlabelgriddata
label sytemhomelabel   new label composite  swt none
sytemhomelabel settext
systemhometext   new text composite  swt single   swt border
gd   new griddata
gd widthhint   convertwidthincharstopixels 16
systemhometext setlayoutdata gd
protected composite createdefaultcomposite composite parent
composite composite   new composite parent  swt null
gridlayout layout   new gridlayout
layout numcolumns   2
composite setlayout layout
griddata data   new griddata
data verticalalignment   griddata fill
data horizontalalignment   griddata fill
composite setlayoutdata data
return composite
protected void fillcontrols
porttext settext integer tostring dsprops getport
hosttext settext dsprops gethost
systemhometext settext dsprops getsystemhome
isserverrunning   checkserver
// if the server is running do not allow
// editing of the settings
if  isserverrunning
porttext seteditable false
hosttext seteditable false
systemhometext seteditable false
protected boolean checkserver
iproject proj    iproject getelement
boolean serverrunning   false
try
serverrunning   derbyserverutils getdefault   getrunning proj
catch  coreexception ce
logger log selectionutil getstatusmessages ce  istatus error
return serverrunning
protected void getparams
dsprops   new derbyproperties
try
dsprops setport integer parseint porttext gettext
catch  numberformatexception ne
// do nothing; use the default port number
dsprops sethost hosttext gettext
dsprops setsystemhome systemhometext gettext
// if the server is running inform the user
// to stop the server before changing the settings
if  isserverrunning
shell shell   new shell
messagedialog openinformation
shell
commonnames plugin_name
messages server_running
protected griddata getseperatorlabelgriddata
griddata griddata   new griddata griddata beginning
griddata horizontal_align_fill
griddata grab_vertical
griddata beginning
griddata vertical_align_beginning
griddata vertical_align_fill
griddata horizontalspan   2
griddata grabexcessverticalspace    false
griddata grabexcesshorizontalspace   true
return griddata
protected void performdefaults
dsprops   new derbyproperties
fillcontrols
public boolean performok
iproject proj    iproject getelement
getparams
try
dsprops save proj getproject
catch  coreexception ce
system err println selectionutil getstatusmessages ce
return false
return true
protected control createcontents composite parent
composite composite   new composite parent  swt none
gridlayout layout   new gridlayout
composite setlayout layout
griddata data   new griddata griddata fill
data grabexcesshorizontalspace   true
composite setlayoutdata data
addcontrols composite
iproject proj    iproject getelement
try
dsprops   new derbyproperties proj
fillcontrols
catch  coreexception ce
logger log selectionutil getstatusmessages ce  istatus error
return composite