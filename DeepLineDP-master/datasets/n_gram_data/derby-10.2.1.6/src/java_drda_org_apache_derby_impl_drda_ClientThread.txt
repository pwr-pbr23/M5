/*
derby - class org.apache.derby.impl.drda.clientthread
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby impl drda
import java io
import java net
import java security
final class clientthread extends thread
networkservercontrolimpl parent
serversocket serversocket
private int timeslice
private int connnum
clientthread  networkservercontrolimpl nsi  serversocket ss
// create a more meaningful name for this thread (but preserve its
// thread id from the default name).
networkservercontrolimpl setuniquethreadname this
parent nsi
serversocket ss
timeslice nsi gettimeslice
public void run
socket clientsocket   null
for
try
try
clientsocket    socket  accesscontroller doprivileged
new privilegedexceptionaction
public object run   throws ioexception
return serversocket accept
clientsocket setkeepalive parent getkeepalive
//set time out
//this looks highly suspect.  why does timeslice setsotimeout?
if  timeslice    0
clientsocket setsotimeout timeslice
catch  privilegedactionexception e
exception e1   e getexception
if  e1 instanceof ioexception
synchronized parent getshutdownsync
if   parent getshutdown
parent consolepropertymessage
else throw e1
break
end priv try catch block
//create a new session for this session
parent addsession clientsocket
catch  exception e
if  e instanceof interruptedexception
return
parent consoleexceptionprinttrace e
end outer try catch block
end for
end run