/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket request mapper parameter
import java util iterator
import org apache wicket request request
import org apache wicket request url
import org apache wicket util lang args
import org apache wicket util string strings
/**
* encodes page parameters into url path fragments instead of the query string like the default
* {@link pageparametersencoder}. the parameters are encoded in the following format:
* {@code /param1name/param1value/param2name/param2value}.
* <p>
* this used to be the default way of encoding page parameters in 1.4.x applications. newer 1.5.x+
* applications use the query string, by default. this class facilitates backwards compatibility and
* migrations of 1.4.x application to 1.5.x+ codebase.
* <p>
* example usage:
* {@code mount(new mountedmapper("/mypage", mypage.class, new urlpathpageparametersencoder()); }
*
* @author chris colman
* @author luniv (on stack overflow)
* @author ivaynberg
*/
public class urlpathpageparametersencoder implements ipageparametersencoder
public url encodepageparameters pageparameters params
args notnull params
args istrue params getindexedcount      0
params
url url   new url
for  pageparameters namedpair pair   params getallnamed
url getsegments   add pair getkey
url getsegments   add pair getvalue
return url
public pageparameters decodepageparameters request request
pageparameters params   new pageparameters
for  iterator<string> segment   request geturl   getsegments   iterator    segment hasnext
string key   segment next
if  strings isempty key
// keys cannot be empty
continue
// a trailing slash can be seen as an extra segment with a "" value so check
// if there is a matching value for this parameter name and ignore it if not
if  segment hasnext
string value   segment next
params add key  value
return params isempty   ? null   params