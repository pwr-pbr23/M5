/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hbase
import static org apache hadoop hbase io hfile blocktype magic_length
import java nio bytebuffer
import java nio charset charset
import java util arrays
import java util collections
import java util list
import java util uuid
import java util regex pattern
import org apache commons lang arrayutils
import org apache hadoop classification interfaceaudience
import org apache hadoop classification interfacestability
import org apache hadoop hbase util bytes
/**
* hconstants holds a bunch of hbase-related constants
*/
@interfaceaudience public
@interfacestability stable
public final class hconstants
/** when we encode strings, we always specify utf8 encoding */
public static final string utf8_encoding
/** when we encode strings, we always specify utf8 encoding */
public static final charset utf8_charset   charset forname utf8_encoding
/**
* default block size for an hfile.
*/
public final static int default_blocksize   64   1024
/** used as a magic return value while optimized index key feature enabled(hbase-7845) */
public final static int index_key_magic    2
/*
* name of directory that holds recovered edits written by the wal log
* splitting code, one per region
*/
public static final string recovered_edits_dir
/**
* the first four bytes of hadoop rpc connections
*/
public static final bytebuffer rpc_header   bytebuffer wrap   getbytes
public static final byte rpc_current_version   0
// hfileblock constants.
/** the size data structures with minor version is 0 */
public static final int hfileblock_header_size_no_checksum   magic_length   2   bytes sizeof_int
bytes sizeof_long
/** the size of a version 2 hfile block header, minor version 1.
* there is a 1 byte checksum type, followed by a 4 byte bytesperchecksum
* followed by another 4 byte value to store sizeofdataondisk.
*/
public static final int hfileblock_header_size   hfileblock_header_size_no_checksum
bytes sizeof_byte   2   bytes sizeof_int
/** just an array of bytes of the right size. */
public static final byte hfileblock_dummy_header   new byte
//end hfileblockconstants.
/**
* status codes used for return values of bulk operations.
*/
public enum operationstatuscode
not_run
success
bad_family
sanity_check_failure
failure
/** long constant for zero */
public static final long zero_l   long valueof 0l
public static final string nines
public static final string zeroes
// for migration
/** name of version file */
public static final string version_file_name
/**
* current version of file system.
* version 4 supports only one kind of bloom filter.
* version 5 changes versions in catalog table regions.
* version 6 enables blockcaching on catalog tables.
* version 7 introduces hfile -- hbase 0.19 to 0.20..
*/
// public static final string file_system_version = "6";
public static final string file_system_version
// configuration parameters
//todo: is having hbase homed on port 60k ok?
/** cluster is in distributed mode or not */
public static final string cluster_distributed
/** config for pluggable load balancers */
public static final string hbase_master_loadbalancer_class
/** cluster is standalone or pseudo-distributed */
public static final boolean cluster_is_local   false
/** cluster is fully-distributed */
public static final boolean cluster_is_distributed   true
/** default value for cluster distributed mode */
public static final boolean default_cluster_distributed   cluster_is_local
/** default host address */
public static final string default_host
/** parameter name for port master listens on. */
public static final string master_port
/** default port that the master listens on */
public static final int default_master_port   60000
/** default port for master web api */
public static final int default_master_infoport   60010
/** configuration key for master web api port */
public static final string master_info_port
/** parameter name for the master type being backup (waits for primary to go inactive). */
public static final string master_type_backup
/** by default every master is a possible primary master unless the conf explicitly overrides it */
public static final boolean default_master_type_backup   false
/** name of zookeeper quorum configuration parameter. */
public static final string zookeeper_quorum
/** name of zookeeper config file in conf/ directory. */
public static final string zookeeper_config_name
/** common prefix of zookeeper configuration properties */
public static final string zk_cfg_property_prefix
public static final int zk_cfg_property_prefix_len
zk_cfg_property_prefix length
/**
* the zk client port key in the zk properties map. the name reflects the
* fact that this is not an hbase configuration key.
*/
public static final string client_port_str
/** parameter name for the client port that the zookeeper listens on */
public static final string zookeeper_client_port
zk_cfg_property_prefix   client_port_str
/** default client port that the zookeeper listens on */
public static final int default_zookeper_client_port   2181
/** parameter name for the wait time for the recoverable zookeeper */
public static final string zookeeper_recoverable_waittime
/** default wait time for the recoverable zookeeper */
public static final long default_zookeper_recoverable_waitime   10000
/** parameter name for the root dir in zk for this cluster */
public static final string zookeeper_znode_parent
public static final string default_zookeeper_znode_parent
/**
* parameter name for the limit on concurrent client-side zookeeper
* connections
*/
public static final string zookeeper_max_client_cnxns
zk_cfg_property_prefix
/** parameter name for the zk data directory */
public static final string zookeeper_data_dir
zk_cfg_property_prefix
/** default limit on concurrent client-side zookeeper connections */
public static final int default_zookeper_max_client_cnxns   300
/** configuration key for zookeeper session timeout */
public static final string zk_session_timeout
/** default value for zookeeper session timeout */
public static final int default_zk_session_timeout   180   1000
/** configuration key for whether to use zk.multi */
public static final string zookeeper_usemulti
/** parameter name for port region server listens on. */
public static final string regionserver_port
/** default port region server listens on. */
public static final int default_regionserver_port   60020
/** default port for region server web api */
public static final int default_regionserver_infoport   60030
/** a configuration key for regionserver info port */
public static final string regionserver_info_port
/** a flag that enables automatic selection of regionserver info port */
public static final string regionserver_info_port_auto
regionserver_info_port
/** parameter name for what region server implementation to use. */
public static final string region_server_impl
/** parameter name for what master implementation to use. */
public static final string master_impl
/** parameter name for what hbase client implementation to use. */
public static final string hbaseclient_impl
/** parameter name for how often threads should wake up */
public static final string thread_wake_frequency
/** default value for thread wake frequency */
public static final int default_thread_wake_frequency   10   1000
/** parameter name for how often we should try to write a version file, before failing */
public static final string version_file_write_attempts
/** parameter name for how often we should try to write a version file, before failing */
public static final int default_version_file_write_attempts   3
/** parameter name for how often a region should should perform a major compaction */
public static final string major_compaction_period
/** parameter name for the maximum batch of kvs to be used in flushes and compactions */
public static final string compaction_kv_max
/** parameter name for hbase instance root directory */
public static final string hbase_dir
/** parameter name for hbase client ipc pool type */
public static final string hbase_client_ipc_pool_type
/** parameter name for hbase client ipc pool size */
public static final string hbase_client_ipc_pool_size
/** parameter name for hbase client operation timeout, which overrides rpc timeout */
public static final string hbase_client_operation_timeout
/** default hbase client operation timeout, which is tantamount to a blocking call */
public static final int default_hbase_client_operation_timeout   integer max_value
/** used to construct the name of the log directory for a region server
* use '.' as a special character to seperate the log files from table data */
public static final string hregion_logdir_name
/** used to construct the name of the splitlog directory for a region server */
public static final string split_logdir_name
public static final string corrupt_dir_name
/** like the previous, but for old logs that are about to be deleted */
public static final string hregion_oldlogdir_name
/** used by hbck to sideline backup data */
public static final string hbck_sidelinedir_name
/** used to construct the name of the compaction directory during compaction */
public static final string hregion_compactiondir_name
/** conf key for the max file size after which we split the region */
public static final string hregion_max_filesize
/** default maximum file size */
public static final long default_max_file_size   10   1024   1024   1024l
/**
* the max number of threads used for opening and closing stores or store
* files in parallel
*/
public static final string hstore_open_and_close_threads_max
/**
* the default number for the max number of threads used for opening and
* closing stores or store files in parallel
*/
public static final int default_hstore_open_and_close_threads_max   1
/** conf key for the memstore size at which we flush the memstore */
public static final string hregion_memstore_flush_size
public static final string hregion_edits_replay_skip_errors
public static final boolean default_hregion_edits_replay_skip_errors
false
/** maximum value length, enforced on keyvalue construction */
public static final int maximum_value_length   integer max_value   1
/** name of the file for unique cluster id */
public static final string cluster_id_file_name
/** default value for cluster id */
public static final string cluster_id_default
// always store the location of the root table's hregion.
// this hregion is never split.
// region name = table + startkey + regionid. this is the row key.
// each row in the root and meta tables describes exactly 1 region
// do we ever need to know all the information that we are storing?
// note that the name of the root table starts with "-" and the name of the
// meta table starts with "." why? it's a trick. it turns out that when we
// store region names in memory, we use a sortedmap. since "-" sorts before
// "." (and since no other table name can start with either of these
// characters, the root region will always be the first entry in such a map,
// followed by all the meta regions (which will be ordered by their starting
// row key as well), followed by all user tables. so when the master is
// choosing regions to assign, it will always choose the root region first,
// followed by the meta regions, followed by user regions. since the root
// and meta regions always need to be on-line, this ensures that they will
// be the first to be reassigned if the server(s) they are being served by
// should go down.
/** the root table's name.*/
public static final byte  root_table_name   bytes tobytes
/** the meta table's name. */
public static final byte  meta_table_name   bytes tobytes
/** delimiter used between portions of a region name */
public static final int meta_row_delimiter
/** the catalog family as a string*/
public static final string catalog_family_str
/** the catalog family */
public static final byte  catalog_family   bytes tobytes catalog_family_str
/** the regioninfo qualifier as a string */
public static final string regioninfo_qualifier_str
/** the regioninfo column qualifier */
public static final byte  regioninfo_qualifier   bytes tobytes regioninfo_qualifier_str
/** the server column qualifier */
public static final byte  server_qualifier   bytes tobytes
/** the startcode column qualifier */
public static final byte  startcode_qualifier   bytes tobytes
/** the open seqnum column qualifier */
public static final byte  seqnum_qualifier   bytes tobytes
/** the lower-half split region column qualifier */
public static final byte  splita_qualifier   bytes tobytes
/** the upper-half split region column qualifier */
public static final byte  splitb_qualifier   bytes tobytes
/** the lower-half merge region column qualifier */
public static final byte mergea_qualifier   bytes tobytes
/** the upper-half merge region column qualifier */
public static final byte mergeb_qualifier   bytes tobytes
/**
* the meta table version column qualifier.
* we keep current version of the meta table in this column in <code>-root-</code>
* table: i.e. in the 'info:v' column.
*/
public static final byte  meta_version_qualifier   bytes tobytes
/**
* the current version of the meta table.
* - pre-hbase 0.92.  there is no meta_version column in the root table
* in this case. the meta has htabledescriptor serialized into the hregioninfo;
* - version 0 is 0.92 and 0.94. meta data has serialized hregioninfo's using
* writable serialization, and hregioninfo's does not contain htabledescriptors.
* - version 1 for 0.96+ keeps hregioninfo data structures, but changes the
* byte[] serialization from writables to protobuf.
* see hregioninfo.version
*/
public static final short meta_version   1
// other constants
/**
* an empty instance.
*/
public static final byte  empty_byte_array   new byte
/**
* used by scanners, etc when they want to start at the beginning of a region
*/
public static final byte  empty_start_row   empty_byte_array
/**
* last row in a table.
*/
public static final byte  empty_end_row   empty_start_row
/**
* used by scanners and others when they're trying to detect the end of a
* table
*/
public static final byte  last_row   empty_byte_array
/**
* max length a row can have because of the limitation in tfile.
*/
public static final int max_row_length   short max_value
/**
* timestamp to use when we want to refer to the latest cell.
* this is the timestamp sent by clients when no timestamp is specified on
* commit.
*/
public static final long latest_timestamp   long max_value
/**
* timestamp to use when we want to refer to the oldest cell.
*/
public static final long oldest_timestamp   long min_value
/**
* latest_timestamp in bytes form
*/
public static final byte  latest_timestamp_bytes
// big-endian
byte   latest_timestamp >>> 56
byte   latest_timestamp >>> 48
byte   latest_timestamp >>> 40
byte   latest_timestamp >>> 32
byte   latest_timestamp >>> 24
byte   latest_timestamp >>> 16
byte   latest_timestamp >>> 8
byte  latest_timestamp
/**
* define for 'return-all-versions'.
*/
public static final int all_versions   integer max_value
/**
* unlimited time-to-live.
*/
//  public static final int forever = -1;
public static final int forever   integer max_value
/**
* seconds in a week
*/
public static final int week_in_seconds   7   24   3600
//todo: although the following are referenced widely to format strings for
//      the shell. they really aren't a part of the public api. it would be
//      nice if we could put them somewhere where they did not need to be
//      public. they could have package visibility
public static final string name
public static final string versions
public static final string in_memory
public static final string metadata
public static final string configuration
/**
* this is a retry backoff multiplier table similar to the bsd tcp syn
* backoff table, a bit more aggressive than simple exponential backoff.
*/
public static int retry_backoff     1  1  1  2  2  4  4  8  16  32
public static final string region_impl
/** modifytable op for replacing the table descriptor */
public static enum modify
close_region
table_compact
table_flush
table_major_compact
table_set_htd
table_split
/**
* scope tag for locally scoped data.
* this data will not be replicated.
*/
public static final int replication_scope_local   0
/**
* scope tag for globally scoped data.
* this data will be replicated to all peers.
*/
public static final int replication_scope_global   1
/**
* default cluster id, cannot be used to identify a cluster so a key with
* this value means it wasn't meant for replication.
*/
public static final uuid default_cluster_id   new uuid 0l 0l
/**
* parameter name for maximum number of bytes returned when calling a
* scanner's next method.
*/
public static string hbase_client_scanner_max_result_size_key
/**
* maximum number of bytes returned when calling a scanner's next method.
* note that when a single row is larger than this limit the row is still
* returned completely.
*
* the default value is unlimited.
*/
public static long default_hbase_client_scanner_max_result_size   long max_value
/**
* parameter name for client pause value, used mostly as value to wait
* before running a retry of a failed get, region lookup, etc.
*/
public static string hbase_client_pause
/**
* default value of {@link #hbase_client_pause}.
*/
public static long default_hbase_client_pause   1000
/**
* parameter name for server pause value, used mostly as value to wait before
* running a retry of a failed operation.
*/
public static string hbase_server_pause
/**
* default value of {@link #hbase_server_pause}.
*/
public static int default_hbase_server_pause   1000
/**
* parameter name for maximum retries, used as maximum for all retryable
* operations such as fetching of the root region from root region server,
* getting a cell's value, starting a row update, etc.
*/
public static string hbase_client_retries_number
/**
* default value of {@link #hbase_client_retries_number}.
*/
public static int default_hbase_client_retries_number   10
/**
* parameter name for maximum attempts, used to limit the number of times the
* client will try to obtain the proxy for a given region server.
*/
public static string hbase_client_rpc_maxattempts
/**
* default value of {@link #hbase_client_rpc_maxattempts}.
*/
public static int default_hbase_client_rpc_maxattempts   1
/**
* parameter name for client prefetch limit, used as the maximum number of regions
* info that will be prefetched.
*/
public static string hbase_client_prefetch_limit
/**
* default value of {@link #hbase_client_prefetch_limit}.
*/
public static int default_hbase_client_prefetch_limit   10
/**
* parameter name to set the default scanner caching for all clients.
*/
public static string hbase_client_scanner_caching
/**
* default value for {@link #hbase_client_scanner_caching}
*/
public static int default_hbase_client_scanner_caching   100
/**
* parameter name for number of rows that will be fetched when calling next on
* a scanner if it is not served from memory. higher caching values will
* enable faster scanners but will eat up more memory and some calls of next
* may take longer and longer times when the cache is empty.
*/
public static string hbase_meta_scanner_caching
/**
* default value of {@link #hbase_meta_scanner_caching}.
*/
public static int default_hbase_meta_scanner_caching   100
/**
* parameter name for unique identifier for this {@link org.apache.hadoop.conf.configuration}
* instance. if there are two or more {@link org.apache.hadoop.conf.configuration} instances that,
* for all intents and purposes, are the same except for their instance ids, then they will not be
* able to share the same org.apache.hadoop.hbase.client.hconnection instance. on the other hand,
* even if the instance ids are the same, it could result in non-shared
* org.apache.hadoop.hbase.client.hconnection instances if some of the other connection parameters
* differ.
*/
public static string hbase_client_instance_id
/**
* the client scanner timeout period in milliseconds.
*/
public static string hbase_client_scanner_timeout_period
/**
* default value of {@link #hbase_client_scanner_timeout_period}.
*/
public static int default_hbase_client_scanner_timeout_period   60000
/**
* timeout for each rpc
*/
public static string hbase_rpc_timeout_key
/**
* default value of {@link #hbase_rpc_timeout_key}
*/
public static int default_hbase_rpc_timeout   60000
/**
* value indicating the server name was saved with no sequence number.
*/
public static final long no_seqnum    1
/*
* cluster replication constants.
*/
public static final string
replication_enable_key
public static final string
replication_source_service_classname
public static final string
replication_sink_service_classname
public static final string replication_service_classname_default
/** hbck special code name used as server name when manipulating zk nodes */
public static final string hbck_code_name
public static final string key_for_hostname_seen_by_master
public static final string hbase_master_logcleaner_plugins
public static final string hbase_region_split_policy_key
/**
* configuration key for the size of the block cache
*/
public static final string hfile_block_cache_size_key
public static final float hfile_block_cache_size_default   0 25f
/*
* minimum percentage of free heap necessary for a successful cluster startup.
*/
public static final float hbase_cluster_minimum_memory_threshold   0 2f
public static final pattern cp_htd_attr_key_pattern   pattern compile
pattern case_insensitive
public static final pattern cp_htd_attr_value_pattern
pattern compile
public static final string cp_htd_attr_value_param_key_pattern
public static final string cp_htd_attr_value_param_value_pattern
public static final pattern cp_htd_attr_value_param_pattern   pattern compile
cp_htd_attr_value_param_key_pattern
cp_htd_attr_value_param_value_pattern
/** the delay when re-trying a socket operation in a loop (hbase-4712) */
public static final int socket_retry_wait_ms   200
/** host name of the local machine */
public static final string localhost
/**
* if this parameter is set to true, then hbase will read
* data and then verify checksums. checksum verification
* inside hdfs will be switched off.  however, if the hbase-checksum
* verification fails, then it will switch back to using
* hdfs checksums for verifiying data that is being read from storage.
*
* if this parameter is set to false, then hbase will not
* verify any checksums, instead it will depend on checksum verification
* being done in the hdfs client.
*/
public static final string hbase_checksum_verification
public static final string localhost_ip
/** conf key that enables distributed log splitting */
public static final string distributed_log_splitting_key
/**
* the name of the configuration parameter that specifies
* the number of bytes in a newly created checksum chunk.
*/
public static final string bytes_per_checksum
/**
* the name of the configuration parameter that specifies
* the name of an algorithm that is used to compute checksums
* for newly created blocks.
*/
public static final string checksum_type_name
/** enable file permission modification from standard hbase */
public static final string enable_data_file_umask
/** file permission umask to use when creating hbase data files */
public static final string data_file_umask_key
/** configuration name of hlog compression */
public static final string enable_wal_compression
/** region in transition metrics threshold time */
public static final string metrics_rit_stuck_warning_threshold
public static final string load_balancer_slop_key
/**
* the byte array represents for no_next_indexed_key;
* the actual value is irrelevant because this is always compared by reference.
*/
public static final byte  no_next_indexed_key   bytes tobytes
/** delimiter used between portions of a region name */
public static final int delimiter
public static final string hbase_config_read_zookeeper_config
public static final boolean default_hbase_config_read_zookeeper_config
false
/**
* qos attributes: these attributes are used to demarcate rpc call processing
* by different set of handlers. for example, high_qos tagged methods are
* handled by high priority handlers.
*/
public static final int normal_qos   0
public static final int qos_threshold   10
public static final int high_qos   100
public static final int replication_qos   5     normal_qos < replication_qos < high_qos
/** directory under /hbase where archived hfiles are stored */
public static final string hfile_archive_directory
/**
* name of the directory to store all snapshots. see snapshotdescriptionutils for
* remaining snapshot constants; this is here to keep hconstants dependencies at a minimum and
* uni-directional.
*/
public static final string snapshot_dir_name
/** temporary directory used for table creation and deletion */
public static final string hbase_temp_directory
/** directories that are not hbase table directories */
public static final list<string> hbase_non_table_dirs
collections unmodifiablelist arrays aslist new string   hregion_logdir_name
hregion_oldlogdir_name  corrupt_dir_name  split_logdir_name
hbck_sidelinedir_name  hfile_archive_directory  snapshot_dir_name  hbase_temp_directory
/** directories that are not hbase user table directories */
public static final list<string> hbase_non_user_table_dirs
collections unmodifiablelist arrays aslist  string arrayutils addall
new string   bytes tostring meta_table_name   bytes tostring root_table_name
hbase_non_table_dirs toarray
/** health script related settings. */
public static final string health_script_loc
public static final string health_script_timeout
public static final string health_chore_wake_freq
public static final long default_health_script_timeout   60000
/**
* the maximum number of health check failures a server can encounter consecutively.
*/
public static final string health_failure_threshold
public static final int default_health_failure_threshold   3
/**
* ip to use for the multicast status messages between the master and the clients.
* the default address is chosen as one among others within the ones suitable for multicast
* messages.
*/
public static final string status_multicast_address
public static final string default_status_multicast_address
/**
* the port to use for the multicast messages.
*/
public static final string status_multicast_port
public static final int default_status_multicast_port   60100
private hconstants
// can't be instantiated with this ctor.