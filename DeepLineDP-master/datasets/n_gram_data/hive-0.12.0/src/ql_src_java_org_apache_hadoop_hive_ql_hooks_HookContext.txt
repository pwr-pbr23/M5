/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql hooks
import java util arraylist
import java util list
import java util map
import java util set
import java util concurrent concurrenthashmap
import org apache hadoop fs contentsummary
import org apache hadoop hive conf hiveconf
import org apache hadoop hive ql queryplan
import org apache hadoop hive ql exec taskrunner
import org apache hadoop hive ql session sessionstate
import org apache hadoop hive shims shimloader
import org apache hadoop security usergroupinformation
/**
* hook context keeps all the necessary information for all the hooks.
* new implemented hook can get the query plan, job conf and the list of all completed tasks from this hook context
*/
public class hookcontext
static public enum hooktype
pre_exec_hook  post_exec_hook  on_failure_hook
private queryplan queryplan
private hiveconf conf
private list<taskrunner> completetasklist
private set<readentity> inputs
private set<writeentity> outputs
private lineageinfo linfo
private usergroupinformation ugi
private hooktype hooktype
final private map<string  contentsummary> inputpathtocontentsummary
public hookcontext queryplan queryplan  hiveconf conf  throws exception
this queryplan  conf  new concurrenthashmap<string  contentsummary>
public hookcontext queryplan queryplan  hiveconf conf
map<string  contentsummary> inputpathtocontentsummary  throws exception
this queryplan   queryplan
this conf   conf
this inputpathtocontentsummary   inputpathtocontentsummary
completetasklist   new arraylist<taskrunner>
inputs   queryplan getinputs
outputs   queryplan getoutputs
ugi   shimloader gethadoopshims   getugiforconf conf
linfo  null
if sessionstate get      null
linfo   sessionstate get   getlineagestate   getlineageinfo
public queryplan getqueryplan
return queryplan
public void setqueryplan queryplan queryplan
this queryplan   queryplan
public hiveconf getconf
return conf
public void setconf hiveconf conf
this conf   conf
public list<taskrunner> getcompletetasklist
return completetasklist
public void setcompletetasklist list<taskrunner> completetasklist
this completetasklist   completetasklist
public void addcompletetask taskrunner completetaskrunner
completetasklist add completetaskrunner
public set<readentity> getinputs
return inputs
public void setinputs set<readentity> inputs
this inputs   inputs
public set<writeentity> getoutputs
return outputs
public void setoutputs set<writeentity> outputs
this outputs   outputs
public lineageinfo getlinfo
return linfo
public void setlinfo lineageinfo linfo
this linfo   linfo
public usergroupinformation getugi
return ugi
public void setugi usergroupinformation ugi
this ugi   ugi
public map<string  contentsummary> getinputpathtocontentsummary
return inputpathtocontentsummary
public hooktype gethooktype
return hooktype
public void sethooktype hooktype hooktype
this hooktype   hooktype
public string getoperationname
return sessionstate get   gethiveoperation   name