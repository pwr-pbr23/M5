/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql plan
import java util arraylist
import java util map
import org apache commons logging log
import org apache commons logging logfactory
import org apache hadoop hive conf hiveconf
import org apache hadoop hive ql exec exprnodeevaluator
import org apache hadoop hive ql exec ptfutils
import org apache hadoop hive ql parse ptfinvocationspec order
import org apache hadoop hive ql parse ptfinvocationspec ptfqueryinputtype
import org apache hadoop hive ql parse ptftranslator leadlaginfo
import org apache hadoop hive ql parse rowresolver
import org apache hadoop hive ql parse typecheckctx
import org apache hadoop hive ql parse windowingspec direction
import org apache hadoop hive ql udf generic genericudafevaluator
import org apache hadoop hive ql udf ptf tablefunctionevaluator
import org apache hadoop hive serde2 serde
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop hive serde2 objectinspector structobjectinspector
@explain displayname
public class ptfdesc extends abstractoperatordesc
private static final long serialversionuid   1l
@suppresswarnings
private static final log log   logfactory getlog ptfdesc class getname
partitionedtablefunctiondef funcdef
leadlaginfo llinfo
/*
* is this ptfdesc for a map-side ptf operation?
*/
boolean ismapside   false
hiveconf cfg
static
ptfutils maketransient ptfdesc class
ptfutils maketransient ptfdesc class
public partitionedtablefunctiondef getfuncdef
return funcdef
public void setfuncdef partitionedtablefunctiondef funcdef
this funcdef   funcdef
public partitionedtablefunctiondef getstartofchain
return funcdef    null ? null   funcdef getstartofchain
public leadlaginfo getllinfo
return llinfo
public void setllinfo leadlaginfo llinfo
this llinfo   llinfo
public boolean forwindowing
return funcdef    null     funcdef instanceof windowtablefunctiondef
public boolean ismapside
return ismapside
public void setmapside boolean ismapside
this ismapside   ismapside
public hiveconf getcfg
return cfg
public void setcfg hiveconf cfg
this cfg   cfg
public abstract static class ptfinputdef
string expressiontreestring
shapedetails outputshape
string alias
public string getexpressiontreestring
return expressiontreestring
public void setexpressiontreestring string expressiontreestring
this expressiontreestring   expressiontreestring
public shapedetails getoutputshape
return outputshape
public void setoutputshape shapedetails outputshape
this outputshape   outputshape
public string getalias
return alias
public void setalias string alias
this alias   alias
public abstract ptfinputdef getinput
public static class ptfqueryinputdef extends ptfinputdef
string destination
ptfqueryinputtype type
public string getdestination
return destination
public void setdestination string destination
this destination   destination
public ptfqueryinputtype gettype
return type
public void settype ptfqueryinputtype type
this type   type
@override
public ptfinputdef getinput
return null
public static class partitionedtablefunctiondef extends  ptfinputdef
string name
string resolverclassname
shapedetails rawinputshape
boolean carryforwardnames
ptfinputdef input
arraylist<ptfexpressiondef> args
partitiondef partition
orderdef order
tablefunctionevaluator tfunction
boolean transformsrawinput
public string getname
return name
public void setname string name
this name   name
public shapedetails getrawinputshape
return rawinputshape
public void setrawinputshape shapedetails rawinputshape
this rawinputshape   rawinputshape
public boolean iscarryforwardnames
return carryforwardnames
public void setcarryforwardnames boolean carryforwardnames
this carryforwardnames   carryforwardnames
@override
public ptfinputdef getinput
return input
public void setinput ptfinputdef input
this input   input
public partitiondef getpartition
return partition
public void setpartition partitiondef partition
this partition   partition
public orderdef getorder
return order
public void setorder orderdef order
this order   order
public tablefunctionevaluator gettfunction
return tfunction
public void settfunction tablefunctionevaluator tfunction
this tfunction   tfunction
public arraylist<ptfexpressiondef> getargs
return args
public void setargs arraylist<ptfexpressiondef> args
this args   args
public void addarg ptfexpressiondef arg
args   args    null ? new arraylist<ptfexpressiondef>     args
args add arg
public partitionedtablefunctiondef getstartofchain
if  input instanceof partitionedtablefunctiondef
return   partitionedtablefunctiondef input  getstartofchain
return this
public boolean istransformsrawinput
return transformsrawinput
public void settransformsrawinput boolean transformsrawinput
this transformsrawinput   transformsrawinput
public string getresolverclassname
return resolverclassname
public void setresolverclassname string resolverclassname
this resolverclassname   resolverclassname
public static class windowtablefunctiondef extends partitionedtablefunctiondef
arraylist<windowfunctiondef> windowfunctions
public arraylist<windowfunctiondef> getwindowfunctions
return windowfunctions
public void setwindowfunctions arraylist<windowfunctiondef> windowfunctions
this windowfunctions   windowfunctions
public static class shapedetails
string serdeclassname
map<string  string> serdeprops
arraylist<string> columnnames
transient structobjectinspector oi
transient serde serde
transient rowresolver rr
transient typecheckctx typecheckctx
static
ptfutils maketransient shapedetails class
public string getserdeclassname
return serdeclassname
public void setserdeclassname string serdeclassname
this serdeclassname   serdeclassname
public map<string  string> getserdeprops
return serdeprops
public void setserdeprops map<string  string> serdeprops
this serdeprops   serdeprops
public arraylist<string> getcolumnnames
return columnnames
public void setcolumnnames arraylist<string> columnnames
this columnnames   columnnames
public structobjectinspector getoi
return oi
public void setoi structobjectinspector oi
oi   oi
public serde getserde
return serde
public void setserde serde serde
this serde   serde
public rowresolver getrr
return rr
public void setrr rowresolver rr
this rr   rr
public typecheckctx gettypecheckctx
return typecheckctx
public void settypecheckctx typecheckctx typecheckctx
this typecheckctx   typecheckctx
public static class partitiondef
arraylist<ptfexpressiondef> expressions
public arraylist<ptfexpressiondef> getexpressions
return expressions
public void setexpressions arraylist<ptfexpressiondef> expressions
this expressions   expressions
public void addexpression ptfexpressiondef e
expressions   expressions    null ? new arraylist<ptfexpressiondef>     expressions
expressions add e
public static class orderdef
arraylist<orderexpressiondef> expressions
public orderdef
public orderdef partitiondef pdef
for ptfexpressiondef edef   pdef getexpressions
addexpression new orderexpressiondef edef
public arraylist<orderexpressiondef> getexpressions
return expressions
public void setexpressions arraylist<orderexpressiondef> expressions
this expressions   expressions
public void addexpression orderexpressiondef e
expressions   expressions    null ? new arraylist<orderexpressiondef>     expressions
expressions add e
public static class orderexpressiondef extends ptfexpressiondef
order order
public orderexpressiondef
public orderexpressiondef ptfexpressiondef e
super e
order   order asc
public order getorder
return order
public void setorder order order
this order   order
public static class windowexpressiondef  extends ptfexpressiondef
string alias
public windowexpressiondef
public windowexpressiondef ptfexpressiondef edef
super edef
public string getalias
return alias
public void setalias string alias
this alias   alias
public static class windowfunctiondef extends windowexpressiondef
string name
boolean isstar
boolean isdistinct
arraylist<ptfexpressiondef> args
windowframedef windowframe
genericudafevaluator wfneval
boolean pivotresult
public string getname
return name
public void setname string name
this name   name
public boolean isstar
return isstar
public void setstar boolean isstar
this isstar   isstar
public boolean isdistinct
return isdistinct
public void setdistinct boolean isdistinct
this isdistinct   isdistinct
public arraylist<ptfexpressiondef> getargs
return args
public void setargs arraylist<ptfexpressiondef> args
this args   args
public void addarg ptfexpressiondef arg
args   args    null ? new arraylist<ptfexpressiondef>     args
args add arg
public windowframedef getwindowframe
return windowframe
public void setwindowframe windowframedef windowframe
this windowframe   windowframe
public genericudafevaluator getwfneval
return wfneval
public void setwfneval genericudafevaluator wfneval
this wfneval   wfneval
public boolean ispivotresult
return pivotresult
public void setpivotresult boolean pivotresult
this pivotresult   pivotresult
public static class windowframedef
boundarydef start
boundarydef end
public boundarydef getstart
return start
public void setstart boundarydef start
this start   start
public boundarydef getend
return end
public void setend boundarydef end
this end   end
public static abstract class boundarydef
direction direction
public direction getdirection
return direction
public void setdirection direction direction
this direction   direction
public abstract int getamt
public static class rangeboundarydef extends boundarydef
int amt
public int compareto boundarydef other
int c   getdirection   compareto other getdirection
if   c    0
return c
rangeboundarydef rb    rangeboundarydef  other
return getamt     rb getamt
@override
public int getamt
return amt
public void setamt int amt
this amt   amt
public static class currentrowdef extends boundarydef
public int compareto boundarydef other
return getdirection   compareto other getdirection
@override
public direction getdirection
return direction current
@override
public int getamt     return 0
public static class valueboundarydef extends boundarydef
ptfexpressiondef expressiondef
int amt
public int compareto boundarydef other
int c   getdirection   compareto other getdirection
if   c    0
return c
valueboundarydef vb    valueboundarydef  other
return getamt     vb getamt
public ptfexpressiondef getexpressiondef
return expressiondef
public void setexpressiondef ptfexpressiondef expressiondef
this expressiondef   expressiondef
public exprnodedesc getexprnode
return expressiondef    null ? null   expressiondef getexprnode
public exprnodeevaluator getexprevaluator
return expressiondef    null ? null   expressiondef getexprevaluator
public objectinspector getoi
return expressiondef    null ? null   expressiondef getoi
@override
public int getamt
return amt
public void setamt int amt
this amt   amt
public static class ptfexpressiondef
string expressiontreestring
exprnodedesc exprnode
transient exprnodeevaluator exprevaluator
transient objectinspector oi
static
ptfutils maketransient ptfexpressiondef class
public ptfexpressiondef
public ptfexpressiondef ptfexpressiondef e
expressiontreestring   e getexpressiontreestring
exprnode   e getexprnode
exprevaluator   e getexprevaluator
oi   e getoi
public string getexpressiontreestring
return expressiontreestring
public void setexpressiontreestring string expressiontreestring
this expressiontreestring   expressiontreestring
public exprnodedesc getexprnode
return exprnode
public void setexprnode exprnodedesc exprnode
this exprnode   exprnode
public exprnodeevaluator getexprevaluator
return exprevaluator
public void setexprevaluator exprnodeevaluator exprevaluator
this exprevaluator   exprevaluator
public objectinspector getoi
return oi
public void setoi objectinspector oi
oi   oi