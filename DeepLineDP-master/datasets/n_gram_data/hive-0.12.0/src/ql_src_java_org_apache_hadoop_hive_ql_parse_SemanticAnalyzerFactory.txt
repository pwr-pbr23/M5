/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql parse
import java util hashmap
import org apache hadoop hive conf hiveconf
import org apache hadoop hive ql plan hiveoperation
import org apache hadoop hive ql session sessionstate
/**
* semanticanalyzerfactory.
*
*/
public final class semanticanalyzerfactory
static hashmap<integer  hiveoperation> commandtype   new hashmap<integer  hiveoperation>
static hashmap<integer  hiveoperation> tablepartitioncommandtype   new hashmap<integer  hiveoperation>
static
commandtype put hiveparser tok_explain  hiveoperation explain
commandtype put hiveparser tok_load  hiveoperation load
commandtype put hiveparser tok_export  hiveoperation export
commandtype put hiveparser tok_import  hiveoperation import
commandtype put hiveparser tok_createdatabase  hiveoperation createdatabase
commandtype put hiveparser tok_dropdatabase  hiveoperation dropdatabase
commandtype put hiveparser tok_switchdatabase  hiveoperation switchdatabase
commandtype put hiveparser tok_createtable  hiveoperation createtable
commandtype put hiveparser tok_truncatetable  hiveoperation truncatetable
commandtype put hiveparser tok_droptable  hiveoperation droptable
commandtype put hiveparser tok_desctable  hiveoperation desctable
commandtype put hiveparser tok_descfunction  hiveoperation descfunction
commandtype put hiveparser tok_msck  hiveoperation msck
commandtype put hiveparser tok_altertable_addcols  hiveoperation altertable_addcols
commandtype put hiveparser tok_altertable_replacecols  hiveoperation altertable_replacecols
commandtype put hiveparser tok_altertable_renamecol  hiveoperation altertable_renamecol
commandtype put hiveparser tok_altertable_rename  hiveoperation altertable_rename
commandtype put hiveparser tok_altertable_dropparts  hiveoperation altertable_dropparts
commandtype put hiveparser tok_altertable_addparts  hiveoperation altertable_addparts
commandtype put hiveparser tok_altertable_touch  hiveoperation altertable_touch
commandtype put hiveparser tok_altertable_archive  hiveoperation altertable_archive
commandtype put hiveparser tok_altertable_unarchive  hiveoperation altertable_unarchive
commandtype put hiveparser tok_altertable_properties  hiveoperation altertable_properties
commandtype put hiveparser tok_droptable_properties  hiveoperation altertable_properties
commandtype put hiveparser tok_showdatabases  hiveoperation showdatabases
commandtype put hiveparser tok_showtables  hiveoperation showtables
commandtype put hiveparser tok_showcolumns  hiveoperation showcolumns
commandtype put hiveparser tok_show_tablestatus  hiveoperation show_tablestatus
commandtype put hiveparser tok_show_tblproperties  hiveoperation show_tblproperties
commandtype put hiveparser tok_show_createtable  hiveoperation show_createtable
commandtype put hiveparser tok_showfunctions  hiveoperation showfunctions
commandtype put hiveparser tok_showindexes  hiveoperation showindexes
commandtype put hiveparser tok_showpartitions  hiveoperation showpartitions
commandtype put hiveparser tok_showlocks  hiveoperation showlocks
commandtype put hiveparser tok_createfunction  hiveoperation createfunction
commandtype put hiveparser tok_dropfunction  hiveoperation dropfunction
commandtype put hiveparser tok_createmacro  hiveoperation createmacro
commandtype put hiveparser tok_dropmacro  hiveoperation dropmacro
commandtype put hiveparser tok_createview  hiveoperation createview
commandtype put hiveparser tok_dropview  hiveoperation dropview
commandtype put hiveparser tok_createindex  hiveoperation createindex
commandtype put hiveparser tok_dropindex  hiveoperation dropindex
commandtype put hiveparser tok_alterindex_rebuild  hiveoperation alterindex_rebuild
commandtype put hiveparser tok_alterindex_properties  hiveoperation alterindex_props
commandtype put hiveparser tok_alterview_properties  hiveoperation alterview_properties
commandtype put hiveparser tok_dropview_properties  hiveoperation alterview_properties
commandtype put hiveparser tok_alterview_addparts  hiveoperation altertable_addparts
commandtype put hiveparser tok_alterview_dropparts  hiveoperation altertable_dropparts
commandtype put hiveparser tok_query  hiveoperation query
commandtype put hiveparser tok_locktable  hiveoperation locktable
commandtype put hiveparser tok_unlocktable  hiveoperation unlocktable
commandtype put hiveparser tok_createrole  hiveoperation createrole
commandtype put hiveparser tok_droprole  hiveoperation droprole
commandtype put hiveparser tok_grant  hiveoperation grant_privilege
commandtype put hiveparser tok_revoke  hiveoperation revoke_privilege
commandtype put hiveparser tok_show_grant  hiveoperation show_grant
commandtype put hiveparser tok_grant_role  hiveoperation grant_role
commandtype put hiveparser tok_revoke_role  hiveoperation revoke_role
commandtype put hiveparser tok_show_role_grant  hiveoperation show_role_grant
commandtype put hiveparser tok_alterdatabase_properties  hiveoperation alterdatabase
commandtype put hiveparser tok_descdatabase  hiveoperation descdatabase
commandtype put hiveparser tok_altertable_skewed  hiveoperation altertable_skewed
commandtype put hiveparser tok_analyze  hiveoperation analyze_table
commandtype put hiveparser tok_alterview_rename  hiveoperation alterview_rename
static
tablepartitioncommandtype put
hiveparser tok_altertable_alterparts_protectmode
new hiveoperation   hiveoperation altertable_protectmode
hiveoperation alterpartition_protectmode
tablepartitioncommandtype put hiveparser tok_altertable_fileformat
new hiveoperation   hiveoperation altertable_fileformat
hiveoperation alterpartition_fileformat
tablepartitioncommandtype put hiveparser tok_altertable_location
new hiveoperation   hiveoperation altertable_location
hiveoperation alterpartition_location
tablepartitioncommandtype put hiveparser tok_altertable_alterparts_mergefiles
new hiveoperation  hiveoperation altertable_mergefiles
hiveoperation alterpartition_mergefiles
tablepartitioncommandtype put hiveparser tok_altertable_serializer
new hiveoperation  hiveoperation altertable_serializer
hiveoperation alterpartition_serializer
tablepartitioncommandtype put hiveparser tok_altertable_serdeproperties
new hiveoperation  hiveoperation altertable_serdeproperties
hiveoperation alterpartition_serdeproperties
tablepartitioncommandtype put hiveparser tok_altertable_renamepart
new hiveoperation  null  hiveoperation altertable_renamepart
tablepartitioncommandtype put hiveparser tok_altertblpart_skewed_location
new hiveoperation  hiveoperation altertblpart_skewed_location
hiveoperation altertblpart_skewed_location
tablepartitioncommandtype put hiveparser tok_tablebuckets
new hiveoperation  hiveoperation altertable_bucketnum
hiveoperation alterpartition_bucketnum
tablepartitioncommandtype put hiveparser tok_altertable_cluster_sort
new hiveoperation  hiveoperation altertable_cluster_sort
hiveoperation altertable_cluster_sort
public static basesemanticanalyzer get hiveconf conf  astnode tree
throws semanticexception
if  tree gettoken      null
throw new runtimeexception
else
setsessioncommandtype commandtype get tree gettoken   gettype
switch  tree gettoken   gettype
case hiveparser tok_explain
return new explainsemanticanalyzer conf
case hiveparser tok_load
return new loadsemanticanalyzer conf
case hiveparser tok_export
return new exportsemanticanalyzer conf
case hiveparser tok_import
return new importsemanticanalyzer conf
case hiveparser tok_createdatabase
case hiveparser tok_dropdatabase
case hiveparser tok_switchdatabase
case hiveparser tok_droptable
case hiveparser tok_dropview
case hiveparser tok_descdatabase
case hiveparser tok_desctable
case hiveparser tok_descfunction
case hiveparser tok_msck
case hiveparser tok_altertable_addcols
case hiveparser tok_altertable_renamecol
case hiveparser tok_altertable_replacecols
case hiveparser tok_altertable_rename
case hiveparser tok_altertable_dropparts
case hiveparser tok_altertable_addparts
case hiveparser tok_altertable_properties
case hiveparser tok_droptable_properties
case hiveparser tok_altertable_serializer
case hiveparser tok_altertable_serdeproperties
case hiveparser tok_alterindex_rebuild
case hiveparser tok_alterindex_properties
case hiveparser tok_alterview_properties
case hiveparser tok_dropview_properties
case hiveparser tok_alterview_addparts
case hiveparser tok_alterview_dropparts
case hiveparser tok_alterview_rename
case hiveparser tok_showdatabases
case hiveparser tok_showtables
case hiveparser tok_showcolumns
case hiveparser tok_show_tablestatus
case hiveparser tok_show_tblproperties
case hiveparser tok_show_createtable
case hiveparser tok_showfunctions
case hiveparser tok_showpartitions
case hiveparser tok_showindexes
case hiveparser tok_showlocks
case hiveparser tok_createindex
case hiveparser tok_dropindex
case hiveparser tok_altertable_cluster_sort
case hiveparser tok_altertable_touch
case hiveparser tok_altertable_archive
case hiveparser tok_altertable_unarchive
case hiveparser tok_altertable_alterparts
case hiveparser tok_locktable
case hiveparser tok_unlocktable
case hiveparser tok_createrole
case hiveparser tok_droprole
case hiveparser tok_grant
case hiveparser tok_revoke
case hiveparser tok_show_grant
case hiveparser tok_grant_role
case hiveparser tok_revoke_role
case hiveparser tok_show_role_grant
case hiveparser tok_alterdatabase_properties
case hiveparser tok_altertable_skewed
case hiveparser tok_truncatetable
case hiveparser tok_exchangepartition
return new ddlsemanticanalyzer conf
case hiveparser tok_altertable_partition
hiveoperation commandtype   null
integer type     astnode  tree getchild 1   gettoken   gettype
if  tree getchild 0  getchildcount   > 1
commandtype   tablepartitioncommandtype get type
else
commandtype   tablepartitioncommandtype get type
setsessioncommandtype commandtype
return new ddlsemanticanalyzer conf
case hiveparser tok_createfunction
case hiveparser tok_dropfunction
return new functionsemanticanalyzer conf
case hiveparser tok_analyze
return new columnstatssemanticanalyzer conf  tree
case hiveparser tok_createmacro
case hiveparser tok_dropmacro
return new macrosemanticanalyzer conf
default
return new semanticanalyzer conf
private static void setsessioncommandtype hiveoperation commandtype
if  sessionstate get      null
sessionstate get   setcommandtype commandtype
private semanticanalyzerfactory
// prevent instantiation