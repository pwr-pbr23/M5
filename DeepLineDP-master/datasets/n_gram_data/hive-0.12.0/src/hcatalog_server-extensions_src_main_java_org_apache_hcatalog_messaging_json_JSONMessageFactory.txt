/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing,
* software distributed under the license is distributed on an
* "as is" basis, without warranties or conditions of any
* kind, either express or implied.  see the license for the
* specific language governing permissions and limitations
* under the license.
*/
package org apache hcatalog messaging json
import org apache hadoop hive metastore api database
import org apache hadoop hive metastore api partition
import org apache hadoop hive metastore api table
import org apache hcatalog messaging addpartitionmessage
import org apache hcatalog messaging createdatabasemessage
import org apache hcatalog messaging createtablemessage
import org apache hcatalog messaging dropdatabasemessage
import org apache hcatalog messaging droppartitionmessage
import org apache hcatalog messaging droptablemessage
import org apache hcatalog messaging messagedeserializer
import org apache hcatalog messaging messagefactory
import java util arrays
import java util linkedhashmap
import java util map
/**
* the json implementation of the messagefactory. constructs json implementations of
* each message-type.
* @deprecated use/modify {@link org.apache.hive.hcatalog.messaging.json.jsonmessagefactory} instead
*/
public class jsonmessagefactory extends messagefactory
private static jsonmessagedeserializer deserializer   new jsonmessagedeserializer
@override
public messagedeserializer getdeserializer
return deserializer
@override
public string getversion
return
@override
public string getmessageformat
return
@override
public createdatabasemessage buildcreatedatabasemessage database db
return new jsoncreatedatabasemessage hcat_server_url  hcat_service_principal  db getname
system currenttimemillis     1000
@override
public dropdatabasemessage builddropdatabasemessage database db
return new jsondropdatabasemessage hcat_server_url  hcat_service_principal  db getname
system currenttimemillis     1000
@override
public createtablemessage buildcreatetablemessage table table
return new jsoncreatetablemessage hcat_server_url  hcat_service_principal  table getdbname
table gettablename    system currenttimemillis   1000
@override
public droptablemessage builddroptablemessage table table
return new jsondroptablemessage hcat_server_url  hcat_service_principal  table getdbname    table gettablename
system currenttimemillis   1000
@override
public addpartitionmessage buildaddpartitionmessage table table  partition partition
return new jsonaddpartitionmessage hcat_server_url  hcat_service_principal  partition getdbname
partition gettablename    arrays aslist getpartitionkeyvalues table  partition
system currenttimemillis   1000
@override
public droppartitionmessage builddroppartitionmessage table table  partition partition
return new jsondroppartitionmessage hcat_server_url  hcat_service_principal  partition getdbname
partition gettablename    arrays aslist getpartitionkeyvalues table  partition
system currenttimemillis   1000
private static map<string  string> getpartitionkeyvalues table table  partition partition
map<string  string> partitionkeys   new linkedhashmap<string  string>
for  int i 0  i<table getpartitionkeyssize      i
partitionkeys put table getpartitionkeys   get i  getname
partition getvalues   get i
return partitionkeys