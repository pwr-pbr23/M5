/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql plan
import java util list
/*
* encapsulates statistics about the duration of all reduce tasks
* corresponding to a specific jobid.
* the stats are computed in the hadoopjobexechelper when the
* job completes and then populated inside the queryplan for
* each job, from where it can be later on accessed.
* the reducer statistics consist of minimum/maximum/mean/stdv of the
* run times of all the reduce tasks for a job. all the run times are
* in milliseconds.
*/
public class reducertimestatsperjob
// stores the jobid of the job
private final string jobid
// stores the temporal statistics in milliseconds for reducers
// specific to a job
private final long minimumtime
private final long maximumtime
private final double meantime
private final double standarddeviationtime
/*
* computes the temporal run time statistics of the reducers
* for a specific jobid.
*/
public reducertimestatsperjob list<integer> reducersruntimes  string jobid
this jobid   jobid
// if no run times present, then set -1, indicating no values
if   reducersruntimes isempty
long minimumtime   reducersruntimes get 0
long maximumtime   reducersruntimes get 0
long totaltime   reducersruntimes get 0
double standarddeviationtime   0 0
double meantime   0 0
for  int i   1  i < reducersruntimes size    i
if  reducersruntimes get i  < minimumtime
minimumtime   reducersruntimes get i
if  reducersruntimes get i  > maximumtime
maximumtime   reducersruntimes get i
totaltime    reducersruntimes get i
meantime    double  totaltime   reducersruntimes size
for  int i   0  i < reducersruntimes size    i
standarddeviationtime    math pow meantime   reducersruntimes get i   2
standarddeviationtime    reducersruntimes size
standarddeviationtime   math sqrt standarddeviationtime
this minimumtime   minimumtime
this maximumtime   maximumtime
this meantime   meantime
this standarddeviationtime   standarddeviationtime
return
this minimumtime    1
this maximumtime    1
this meantime    1 0
this standarddeviationtime    1 0
return
public long getminimumtime
return this minimumtime
public long getmaximumtime
return this maximumtime
public double getmeantime
return this meantime
public double getstandarddeviationtime
return this standarddeviationtime
public string getjobid
return this jobid