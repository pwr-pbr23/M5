/*
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
* http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hbase security access
import java util collection
import java util map
import org apache hadoop classification interfaceaudience
import org apache hadoop classification interfacestability
import org apache hadoop hbase tablename
import org apache hadoop hbase keyvalue
import org apache hadoop hbase security user
import org apache hadoop hbase util bytes
/**
* represents the result of an authorization check for logging and error
* reporting.
*/
@interfaceaudience public
@interfacestability evolving
public class authresult
private final boolean allowed
private final string namespace
private final tablename table
private final permission action action
private final string request
private final string reason
private final user user
// "family" and "qualifier" should only be used if "families" is null.
private final byte family
private final byte qualifier
private final map<byte  ? extends collection<?>> families
public authresult boolean allowed  string request  string reason  user user
permission action action  tablename table  byte family  byte qualifier
this allowed   allowed
this request   request
this reason   reason
this user   user
this table   table
this family   family
this qualifier   qualifier
this action   action
this families   null
this namespace   null
public authresult boolean allowed  string request  string reason  user user
permission action action  tablename table
map<byte  ? extends collection<?>> families
this allowed   allowed
this request   request
this reason   reason
this user   user
this table   table
this family   null
this qualifier   null
this action   action
this families   families
this namespace   null
public authresult boolean allowed  string request  string reason  user user
permission action action  string namespace
this allowed   allowed
this request   request
this reason   reason
this user   user
this namespace   namespace
this action   action
this table   null
this family   null
this qualifier   null
this families   null
public boolean isallowed
return allowed
public user getuser
return user
public string getreason
return reason
public tablename gettablename
return table
public byte getfamily
return family
public byte getqualifier
return qualifier
public permission action getaction
return action
public string getrequest
return request
string tofamilystring
stringbuilder sb   new stringbuilder
if  families    null
boolean first   true
for  map entry<byte  ? extends collection<?>> entry   families entryset
string familyname   bytes tostring entry getkey
if  entry getvalue      null     entry getvalue   isempty
for  object o   entry getvalue
string qualifier
if  o instanceof byte
qualifier   bytes tostring  byte o
else if  o instanceof keyvalue
byte rawqualifier     keyvalue o  getqualifier
qualifier   bytes tostring rawqualifier
else
// shouldn't really reach this?
qualifier   o tostring
if   first
sb append
first   false
sb append familyname  append    append qualifier
else
if   first
sb append
first   false
sb append familyname
else if  family    null
sb append bytes tostring family
if  qualifier    null
sb append    append bytes tostring qualifier
return sb tostring
public string tocontextstring
stringbuilder sb   new stringbuilder
sb append
append user    null ? user getname
append
sb append
append namespace    null ? namespace   table    null ?     table
if namespace    null
sb append
append
append tofamilystring
append
sb append
append action    null ? action tostring
append
return sb tostring
public string tostring
return     tocontextstring
public static authresult allow string request  string reason  user user
permission action action  string namespace
return new authresult true  request  reason  user  action  namespace
public static authresult allow string request  string reason  user user
permission action action  tablename table  byte family  byte qualifier
return new authresult true  request  reason  user  action  table  family  qualifier
public static authresult allow string request  string reason  user user
permission action action  tablename table
map<byte  ? extends collection<?>> families
return new authresult true  request  reason  user  action  table  families
public static authresult deny string request  string reason  user user
permission action action  string namespace
return new authresult false  request  reason  user  action  namespace
public static authresult deny string request  string reason  user user
permission action action  tablename table  byte family  byte qualifier
return new authresult false  request  reason  user  action  table  family  qualifier
public static authresult deny string request  string reason  user user
permission action action  tablename table
map<byte  ? extends collection<?>> families
return new authresult false  request  reason  user  action  table  families