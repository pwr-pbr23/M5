/**
* copyright 2010 the apache software foundation
*
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hbase zookeeper
import java util properties
import java util map entry
import org apache hadoop conf configuration
import org apache hadoop hbase hbaseconfiguration
/**
* tool for reading a zookeeper server from hbase xml configuration producing
* the '-server host:port' argument to pass zookeepermain.  this program
* emits either '-server host:port" where host is one of the zk ensemble
* members plus zk client port or it emits '' if no zk servers found (yes,
* it emits '-server' too).
*/
public class zookeepermainserverarg
public string parse final configuration c
// note that we do not simply grab the property
// hconstants.zookeeper_quorum from the hbaseconfiguration because the
// user may be using a zoo.cfg file.
properties zkprops   zkconfig makezkprops c
string host   null
string clientport   null
for  entry<object  object> entry  zkprops entryset
string key   entry getkey   tostring   trim
string value   entry getvalue   tostring   trim
if  key startswith       host    null
string parts   value split
host   parts
else if  key endswith
clientport   value
if  host    null    clientport    null  break
return host    null    clientport    null? host       clientport  null
/**
* run the tool.
* @param args command line arguments. first arg is path to zookeepers file.
*/
public static void main string args
configuration conf   hbaseconfiguration create
string hostport   new zookeepermainserverarg   parse conf
system out println  hostport    null    hostport length      0 ?
hostport