/**
* copyright 2010 the apache software foundation
*
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hbase filter
import org apache hadoop hbase keyvalue
import java util arraylist
/**
* this filter is used to filter based on the column family. it takes an
* operator (equal, greater, not equal, etc) and a byte [] comparator for the
* column family portion of a key.
* <p/>
* this filter can be wrapped with {@link org.apache.hadoop.hbase.filter.whilematchfilter} and {@link org.apache.hadoop.hbase.filter.skipfilter}
* to add more control.
* <p/>
* multiple filters can be combined using {@link org.apache.hadoop.hbase.filter.filterlist}.
* <p/>
* if an already known column family is looked for, use {@link org.apache.hadoop.hbase.client.get#addfamily(byte[])}
* directly rather than a filter.
*/
public class familyfilter extends comparefilter
/**
* writable constructor, do not use.
*/
public familyfilter
/**
* constructor.
*
* @param familycompareop  the compare op for column family matching
* @param familycomparator the comparator for column family matching
*/
public familyfilter final compareop familycompareop
final writablebytearraycomparable familycomparator
super familycompareop  familycomparator
@override
public returncode filterkeyvalue keyvalue v
int familylength   v getfamilylength
if  familylength > 0
if  docompare this compareop  this comparator  v getbuffer
v getfamilyoffset    familylength
return returncode skip
return returncode include
public static filter createfilterfromarguments arraylist<byte > filterarguments
arraylist arguments   comparefilter extractarguments filterarguments
compareop compareop    compareop arguments get 0
writablebytearraycomparable comparator    writablebytearraycomparable arguments get 1
return new familyfilter compareop  comparator