/**
* copyright 2010 the apache software foundation
*
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hbase filter
import org apache hadoop hbase util bytes
import java io datainput
import java io dataoutput
import java io ioexception
/**
* this comparator is for use with singlecolumnvaluefilter, for filtering based on
* the value of a given column. use it to test if a given substring appears
* in a cell value in the column. the comparison is case insensitive.
* <p>
* only equal or not_equal tests are valid with this comparator.
* <p>
* for example:
* <p>
* <pre>
* singlecolumnvaluefilter scvf =
*   new singlecolumnvaluefilter("col", compareop.equal,
*     new substringcomparator("substr"));
* </pre>
*/
public class substringcomparator extends writablebytearraycomparable
private string substr
/** nullary constructor for writable, do not use */
public substringcomparator
super
/**
* constructor
* @param substr the substring
*/
public substringcomparator string substr
super bytes tobytes substr tolowercase
this substr   substr tolowercase
@override
public byte getvalue
return bytes tobytes substr
@override
public int compareto byte value  int offset  int length
return bytes tostring value  offset  length  tolowercase   contains substr  ? 0
1
@override
public void readfields datainput in  throws ioexception
string substr   in readutf
this value   bytes tobytes substr
this substr   substr
@override
public void write dataoutput out  throws ioexception
out writeutf substr