/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hbase regionserver
import org apache hadoop hbase hconstants
/**
* a {@link regionsplitpolicy} implementation which splits a region
* as soon as any of its store files exceeds a maximum configurable
* size.
* <p>this is the default split policy.</p>
*/
public class constantsizeregionsplitpolicy extends regionsplitpolicy
private long desiredmaxfilesize
@override
protected void configureforregion hregion region
super configureforregion region
long maxfilesize   region gettabledesc   getmaxfilesize
// by default we split region if a file > hconstants.default_max_file_size.
if  maxfilesize    hconstants default_max_file_size
maxfilesize   getconf   getlong hconstants hregion_max_filesize
hconstants default_max_file_size
this desiredmaxfilesize   maxfilesize
@override
protected boolean shouldsplit
boolean force   region shouldforcesplit
boolean foundabigstore   false
for  store store   region getstores   values
// if any of the stores are unable to split (eg they contain reference files)
// then don't split
if    store cansplit
return false
// mark if any store is big enough
if  store getsize   > desiredmaxfilesize
foundabigstore   true
return foundabigstore    force
long getdesiredmaxfilesize
return desiredmaxfilesize