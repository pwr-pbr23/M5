/***** begin license block *****
* version: cpl 1.0/gpl 2.0/lgpl 2.1
*
* the contents of this file are subject to the common public
* license version 1.0 (the "license"); you may not use this file
* except in compliance with the license. you may obtain a copy of
* the license at http://www.eclipse.org/legal/cpl-v10.html
*
* software distributed under the license is distributed on an "as
* is" basis, without warranty of any kind, either express or
* implied. see the license for the specific language governing
* rights and limitations under the license.
*
* copyright (c) 2007 ola bini <ola@ologix.com>
*
* alternatively, the contents of this file may be used under the terms of
* either of the gnu general public license version 2 or later (the "gpl"),
* or the gnu lesser general public license version 2.1 or later (the "lgpl"),
* in which case the provisions of the gpl or the lgpl are applicable instead
* of those above. if you wish to allow use of your version of this file only
* under the terms of either the gpl or the lgpl, and not to allow others to
* use your version of this file under the terms of the cpl, indicate your
* decision by deleting the provisions above and replace them with the notice
* and other provisions required by the gpl or the lgpl. if you do not delete
* the provisions above, a recipient may use your version of this file under
* the terms of any one of the cpl, the gpl or the lgpl.
***** end license block *****/
package org jvyamlb
import java io fileinputstream
import java io inputstream
import java util hashmap
import java util hashset
import java util iterator
import java util map
import java util set
import java util regex pattern
import org jruby util bytelist
/**
* @author <a href="mailto:ola.bini@ki.se">ola bini</a>
*/
public class constructorimpl extends safeconstructorimpl
private final static map yamlconstructors   new hashmap
private final static map yamlmulticonstructors   new hashmap
private final static map yamlmultiregexps   new hashmap
public yamlconstructor getyamlconstructor final object key
yamlconstructor mine    yamlconstructor yamlconstructors get key
if mine    null
mine   super getyamlconstructor key
return mine
public yamlmulticonstructor getyamlmulticonstructor final object key
yamlmulticonstructor mine    yamlmulticonstructor yamlmulticonstructors get key
if mine    null
mine   super getyamlmulticonstructor key
return mine
public pattern getyamlmultiregexp final object key
pattern mine    pattern yamlmultiregexps get key
if mine    null
mine   super getyamlmultiregexp key
return mine
public set getyamlmultiregexps
final set all   new hashset super getyamlmultiregexps
all addall yamlmultiregexps keyset
return all
public static void addconstructor final string tag  final yamlconstructor ctor
yamlconstructors put tag ctor
public static void addmulticonstructor final string tagprefix  final yamlmulticonstructor ctor
yamlmulticonstructors put tagprefix ctor
yamlmultiregexps put tagprefix pattern compile   tagprefix
public constructorimpl final composer composer
super composer
public static void main final string args  throws exception
final string filename   args
system out println
final bytelist input   new bytelist 1024
final inputstream reader   new fileinputstream filename
byte buff   new byte
int read   0
while true
read   reader read buff
input append buff 0 read
if read < 1024
break
reader close
final long before   system currenttimemillis
for int i 0 i<1 i
final constructor ctor   new constructorimpl new composerimpl new parserimpl new scannerimpl input   new resolverimpl
for final iterator iter   ctor eachdocument   iter hasnext   iter next
iter next
//                                system.out.println(iter.next());
final long after   system currenttimemillis
final long time   after before
final double times    after before  1000 0
system out println     filename       time       times
constructorimpl