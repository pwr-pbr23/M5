/*
* to change this template, choose tools | templates
* and open the template in the editor.
*/
package org jruby ext
import java io ioexception
import java lang ref weakreference
import org jruby ruby
import org jruby rubyclass
import org jruby rubyexception
import org jruby rubykernel
import org jruby rubyobject
import org jruby anno jrubymethod
import org jruby exceptions raiseexception
import org jruby runtime block
import org jruby runtime objectallocator
import org jruby runtime visibility
import org jruby runtime builtin irubyobject
import org jruby runtime load library
/**
*
* @author headius
*/
public class weakref extends rubyobject
private weakreference<irubyobject> ref
private static final objectallocator weakref_allocator   new objectallocator
public irubyobject allocate ruby runtime  rubyclass klazz
return new weakref runtime  klazz
public static class weakreflibrary implements library
public void load ruby runtime  boolean wrap  throws ioexception
rubykernel require runtime getkernel    runtime newstring     block null_block
rubyclass delegatorclass    rubyclass runtime getclassfrompath
rubyclass weakrefclass   runtime defineclass    delegatorclass  weakref_allocator
weakrefclass defineannotatedmethods weakref class
runtime defineclass    runtime getstandarderror    runtime getstandarderror   getallocator
public weakref ruby runtime  rubyclass klazz
super runtime  klazz
@jrubymethod name
public irubyobject getobj
irubyobject obj   ref get
if  obj    null
// fixme weakref.rb also does caller(2) here for the backtrace
throw newreferror
return obj
@jrubymethod name      required   1  meta   true
public static irubyobject newinstance irubyobject clazz  irubyobject arg
weakref weakref    weakref   rubyclass clazz  allocate
weakref callinit new irubyobject  arg   block null_block
return weakref
@jrubymethod name      required   1  frame   true  visibility   visibility private
public irubyobject initialize irubyobject obj
ref   new weakreference<irubyobject> obj
return callsuper getruntime   getcurrentcontext    new irubyobject  obj   block null_block
@jrubymethod name
public irubyobject weakref_alive_p
return ref get      null ? getruntime   gettrue     getruntime   getfalse
private raiseexception newreferror string message
rubyexception exception
rubyexception getruntime   getclass    newinstance getruntime   getcurrentcontext
new irubyobject  getruntime   newstring message    block null_block
return new raiseexception exception