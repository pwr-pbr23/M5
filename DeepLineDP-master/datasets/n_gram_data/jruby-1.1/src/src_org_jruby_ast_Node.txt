/*
***** begin license block *****
* version: cpl 1.0/gpl 2.0/lgpl 2.1
*
* the contents of this file are subject to the common public
* license version 1.0 (the "license"); you may not use this file
* except in compliance with the license. you may obtain a copy of
* the license at http://www.eclipse.org/legal/cpl-v10.html
*
* software distributed under the license is distributed on an "as
* is" basis, without warranty of any kind, either express or
* implied. see the license for the specific language governing
* rights and limitations under the license.
*
* copyright (c) 2001-2002 jan arne petersen <jpetersen@uni-bonn.de>
* copyright (c) 2001-2002 benoit cerrina <b.cerrina@wanadoo.fr>
* copyright (c) 2002-2004 anders bengtsson <ndrsbngtssn@yahoo.se>
* copyright (c) 2004 thomas e enebo <enebo@acm.org>
* copyright (c) 2004 stefan matthias aust <sma@3plus4.de>
* copyright (c) 2006 thomas corbat <tcorbat@hsr.ch>
*
* alternatively, the contents of this file may be used under the terms of
* either of the gnu general public license version 2 or later (the "gpl"),
* or the gnu lesser general public license version 2.1 or later (the "lgpl"),
* in which case the provisions of the gpl or the lgpl are applicable instead
* of those above. if you wish to allow use of your version of this file only
* under the terms of either the gpl or the lgpl, and not to allow others to
* use your version of this file under the terms of the cpl, indicate your
* decision by deleting the provisions above and replace them with the notice
* and other provisions required by the gpl or the lgpl. if you do not delete
* the provisions above, a recipient may use your version of this file under
* the terms of any one of the cpl, the gpl or the lgpl.
***** end license block *****/
package org jruby ast
import java util arraylist
import java util collection
import java util list
import org jruby ast visitor nodevisitor
import org jruby evaluator instruction
import org jruby lexer yacc isourceposition
import org jruby lexer yacc isourcepositionholder
import org jruby lexer yacc idesourceposition
/**
* base class for all nodes in the ast
*/
public abstract class node implements isourcepositionholder
// we define an actual list to get around bug in java integration (1387115)
static final list<node> empty_list   new arraylist<node>
public static final list<commentnode> empty_comment_list   new arraylist<commentnode>
public final nodetype nodeid
private isourceposition position
public node isourceposition position  nodetype id
assert position    null
this position   position
this nodeid   id
/**
* location of this node within the source
*/
public isourceposition getposition
return position
public void setposition isourceposition position
this position   position
public abstract instruction accept nodevisitor visitor
public abstract list<node> childnodes
protected static list<node> createlist node    nodes
arraylist<node> list   new arraylist<node>
for  node node  nodes
if  node    null  list add node
return list
public string tostring
return getnodename
protected string getnodename
string name   getclass   getname
int i   name lastindexof
string nodetype   name substring i   1
return nodetype
public void addcomment commentnode comment
collection<commentnode> comments   position getcomments
if  comments    null
comments   new arraylist<commentnode>
position setcomments comments
comments add comment
public void addcomments collection<commentnode> morecomments
collection<commentnode> comments   position getcomments
if  comments    empty_comment_list
comments   new arraylist<commentnode>
position setcomments comments
comments addall morecomments
public collection<commentnode> getcomments
return position getcomments
public boolean hascomments
return getcomments      empty_comment_list
public isourceposition getpositionincludingcomments
if   hascomments    return position
string filename   position getfile
int startoffset   position getstartoffset
int endoffset   position getendoffset
int startline   position getstartline
int endline   position getendline
// since this is only used for ides this is safe code, but there is an obvious abstraction issue here.
isourceposition commentincludingpos
new idesourceposition filename  startline  endline  startoffset  endoffset
for  commentnode comment  getcomments
commentincludingpos
idesourceposition combineposition commentincludingpos  comment getposition
return commentincludingpos