/*
**** begin license block *****
* version: cpl 1.0/gpl 2.0/lgpl 2.1
*
* the contents of this file are subject to the common public
* license version 1.0 (the "license"); you may not use this file
* except in compliance with the license. you may obtain a copy of
* the license at http://www.eclipse.org/legal/cpl-v10.html
*
* software distributed under the license is distributed on an "as
* is" basis, without warranty of any kind, either express or
* implied. see the license for the specific language governing
* rights and limitations under the license.
*
* copyright (c) 2001 alan moore <alan_moore@gmx.net>
* copyright (c) 2001-2004 jan arne petersen <jpetersen@uni-bonn.de>
* copyright (c) 2002 anders bengtsson <ndrsbngtssn@yahoo.se>
* copyright (c) 2002 benoit cerrina <b.cerrina@wanadoo.fr>
* copyright (c) 2002-2004 thomas e enebo <enebo@acm.org>
* copyright (c) 2004 stefan matthias aust <sma@3plus4.de>
* copyright (c) 2005 charles o nutter <headius@headius.com>
*
* alternatively, the contents of this file may be used under the terms of
* either of the gnu general public license version 2 or later (the "gpl"),
* or the gnu lesser general public license version 2.1 or later (the "lgpl"),
* in which case the provisions of the gpl or the lgpl are applicable instead
* of those above. if you wish to allow use of your version of this file only
* under the terms of either the gpl or the lgpl, and not to allow others to
* use your version of this file under the terms of the cpl, indicate your
* decision by deleting the provisions above and replace them with the notice
* and other provisions required by the gpl or the lgpl. if you do not delete
* the provisions above, a recipient may use your version of this file under
* the terms of any one of the cpl, the gpl or the lgpl.
***** end license block *****/
package org jruby
import org jruby anno jrubymethod
import org jruby runtime block
import org jruby runtime callbackfactory
import org jruby runtime methodindex
import org jruby runtime objectallocator
import org jruby runtime threadcontext
import org jruby runtime builtin irubyobject
/** implementation of the integer class.
*
* @author  jpetersen
*/
public abstract class rubyinteger extends rubynumeric
public static rubyclass createintegerclass ruby runtime
rubyclass integer   runtime defineclass    runtime getnumeric
objectallocator not_allocatable_allocator
runtime setinteger integer
integer kindof   new rubymodule kindof
public boolean iskindof irubyobject obj  rubymodule type
return obj instanceof rubyinteger
callbackfactory callbackfactory   runtime callbackfactory rubyinteger class
integer getsingletonclass   undefinemethod
integer includemodule runtime getprecision
integer defineannotatedmethods rubyinteger class
integer dispatcher   callbackfactory createdispatcher integer
return integer
public rubyinteger ruby runtime  rubyclass rubyclass
super runtime  rubyclass
public rubyinteger ruby runtime  rubyclass rubyclass  boolean useobjectspace
super runtime  rubyclass  useobjectspace
public rubyinteger converttointeger
return this
// conversion
protected rubyfloat tofloat
return rubyfloat newfloat getruntime    getdoublevalue
/*  ================
*  instance methods
*  ================
*/
/** int_int_p
*
*/
@jrubymethod name
public irubyobject integer_p
return getruntime   gettrue
/** int_upto
*
*/
@jrubymethod name      required   1  frame   true
public irubyobject upto threadcontext context  irubyobject to  block block
ruby runtime   getruntime
if  this instanceof rubyfixnum    to instanceof rubyfixnum
rubyfixnum tofixnum    rubyfixnum  to
long tovalue   tofixnum getlongvalue
long fromvalue   getlongvalue
for  long i   fromvalue  i <  tovalue  i
block yield context  rubyfixnum newfixnum runtime  i
else
rubynumeric i   this
while  true
if  i callmethod context  methodindex op_gt     to  istrue
break
block yield context  i
i    rubynumeric  i callmethod context  methodindex op_plus     rubyfixnum one runtime
return this
/** int_downto
*
*/
// todo: make callcoerced work in block context...then fix downto, step, and upto.
@jrubymethod name      required   1  frame   true
public irubyobject downto threadcontext context  irubyobject to  block block
if  this instanceof rubyfixnum    to instanceof rubyfixnum
rubyfixnum tofixnum    rubyfixnum  to
long tovalue   tofixnum getlongvalue
for  long i   getlongvalue    i >  tovalue  i
block yield context  rubyfixnum newfixnum getruntime    i
else
rubynumeric i   this
while  true
if  i callmethod context  methodindex op_lt     to  istrue
break
block yield context  i
i    rubynumeric  i callmethod context  methodindex op_minus     rubyfixnum one getruntime
return this
@jrubymethod name      frame   true
public irubyobject times threadcontext context  block block
if  this instanceof rubyfixnum
long value   getlongvalue
for  long i   0  i < value  i
block yield context  rubyfixnum newfixnum getruntime    i
else
rubynumeric i   rubyfixnum zero getruntime
while  true
if   i callmethod context  methodindex op_lt     this  istrue
break
block yield context  i
i    rubynumeric  i callmethod context  methodindex op_plus     rubyfixnum one getruntime
return this
/** int_succ
*
*/
@jrubymethod name
public irubyobject succ threadcontext context
if  this instanceof rubyfixnum
return rubyfixnum newfixnum getruntime    getlongvalue     1l
else
return callmethod context  methodindex op_plus     rubyfixnum one getruntime
/** int_chr
*
*/
@jrubymethod name
public rubystring chr
if  getlongvalue   < 0    getlongvalue   > 0xff
throw getruntime   newrangeerror this tostring
return getruntime   newstring new string new char    char  getlongvalue
/** int_to_i
*
*/
@jrubymethod name
public rubyinteger to_i
return this
/*  ================
*  singleton methods
*  ================
*/
/** rb_int_induced_from
*
*/
@jrubymethod name      meta   true  required   1
public static irubyobject induced_from threadcontext context  irubyobject recv  irubyobject other
if  other instanceof rubyfixnum    other instanceof rubybignum
return other
else if  other instanceof rubyfloat
return other callmethod context  methodindex to_i
else
throw recv getruntime   newtypeerror
other getmetaclass   getname