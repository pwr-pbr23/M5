package org jruby maven
import java io file
import java io filewriter
import java io ioexception
import java util arraylist
import java util arrays
import java util list
import org apache maven plugin mojoexecutionexception
import org apache tools ant taskdefs java
/**
* @goal rake
*/
public class rakemojo extends abstractjrubymojo
/**
* @parameter expression="${jruby.rakefile}"
*/
private string rakefile   null
/**
* @parameter expression="${project.build.directory}"
* @required
*/
private file outputdirectory
/**
* @parameter
*/
private string script   null
/**
* @parameter expression="${jruby.rake.args}"
*/
private string args   null
public void execute   throws mojoexecutionexception
outputdirectory mkdirs
ensuregem
list allargs   new arraylist
allargs add
allargs add
if  script    null
file scriptfile   new file outputdirectory
try
filewriter writer   new filewriter scriptfile
writer write script
writer close
catch  ioexception io
throw new mojoexecutionexception
allargs add
allargs add scriptfile getpath
else if  rakefile    null
allargs add
allargs add rakefile
if  args    null
allargs addall arrays aslist args split
java jruby   jruby  string  allargs toarray new string
jruby execute