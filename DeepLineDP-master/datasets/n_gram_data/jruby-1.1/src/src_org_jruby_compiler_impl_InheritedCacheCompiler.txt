/*
* to change this template, choose tools | templates
* and open the template in the editor.
*/
package org jruby compiler impl
import org jruby runtime callsite
import org jruby runtime calltype
import org jruby runtime methodindex
import static org jruby util codegenutils
/**
*
* @author headius
*/
public class inheritedcachecompiler extends fieldbasedcachecompiler
public static final int max_inherited_call_sites   0
int callsitecount   0
//    int bytelistcount = 0;
//    int sourcepositionscount = 0;
//    int symbolcount = 0;
public inheritedcachecompiler standardasmcompiler scriptcompiler
super scriptcompiler
public void cachecallsite skinnymethodadapter method  string name  calltype calltype
string fieldname       callsitecount
// retrieve call adapter
skinnymethodadapter initmethod   scriptcompiler getinitmethod
initmethod aload standardasmcompiler this
method aload standardasmcompiler this
initmethod ldc name
if  calltype equals calltype normal
initmethod invokestatic p methodindex class      sig callsite class  params string class
else if  calltype equals calltype functional
initmethod invokestatic p methodindex class      sig callsite class  params string class
else if  calltype equals calltype variable
initmethod invokestatic p methodindex class      sig callsite class  params string class
if  callsitecount >  max_inherited_call_sites
scriptcompiler getnewfield ci callsite class   fieldname  null
initmethod putfield scriptcompiler getclassname    fieldname  ci callsite class
method getfield scriptcompiler getclassname    fieldname  ci callsite class
else
initmethod putfield scriptcompiler getclassname    fieldname  ci callsite class
method getfield scriptcompiler getclassname    fieldname  ci callsite class
callsitecount