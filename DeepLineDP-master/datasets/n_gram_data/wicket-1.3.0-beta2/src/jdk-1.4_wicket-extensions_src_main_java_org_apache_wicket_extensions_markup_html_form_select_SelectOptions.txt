/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket extensions markup html form select
import java io serializable
import java util collection
import java util iterator
import org apache wicket wicketruntimeexception
import org apache wicket markup componenttag
import org apache wicket markup markupstream
import org apache wicket markup html webmarkupcontainer
import org apache wicket markup repeater repeatingview
import org apache wicket model imodel
import org apache wicket model model
/**
* component that makes it easy to produce a list of selectoption components
*
* @author igor vaynberg (ivaynberg)
*
*/
public class selectoptions extends repeatingview
private static final long serialversionuid   1l
private boolean recreatechoices   false
private ioptionrenderer renderer
/**
* constructor
*
* @param id
* @param model
* @param renderer
*/
public selectoptions string id  imodel model  ioptionrenderer renderer
super id  model
this renderer   renderer
setrenderbodyonly true
/**
* constructor
*
* @param id
* @param elements
* @param renderer
*/
public selectoptions string id  collection elements  ioptionrenderer renderer
this id  new model  serializable elements   renderer
/**
* controls whether or not selectchoice objects are recreated every request
*
* @param refresh
* @return this for chaining
*/
public selectoptions setrecreatechoices boolean refresh
this recreatechoices   refresh
return this
/**
* @see org.apache.wicket.component#onbeforerender()
*/
protected void onbeforerender
super onbeforerender
if  size      0    recreatechoices
// populate this repeating view with selectoption components
removeall
object modelobject   getmodelobject
if  modelobject    null
if    modelobject instanceof collection
throw new wicketruntimeexception     modelobject
// iterator over model objects for selectoption components
iterator it     collection modelobject  iterator
while  it hasnext
// we need a container to represent a row in repeater
webmarkupcontainer row   new webmarkupcontainer newchildid
row setrenderbodyonly true
add row
// we add our actual selectoption component to the row
object value   it next
string text   renderer getdisplayvalue value
imodel model   renderer getmodel value
row add new simpleselectoption    model  text
private static class simpleselectoption extends selectoption
private string text
/**
* @param id
* @param model
* @param text
*/
public simpleselectoption string id  imodel model  string text
super id  model
this text   text
protected void oncomponenttagbody markupstream markupstream  componenttag opentag
replacecomponenttagbody markupstream  opentag  text
private static final long serialversionuid   1l