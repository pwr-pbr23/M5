/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket util license
import java io file
import java io filereader
import java io ioexception
import java io inputstream
import java io inputstreamreader
import java io linenumberreader
import junit framework assert
import org apache wicket util string strings
abstract class abstractlicenseheaderhandler implements ilicenseheaderhandler
protected static final string line_ending   system getproperty
private string licenseheader
private string ignorefiles
/**
* construct.
*
* @param ignorefiles
*/
public abstractlicenseheaderhandler string ignorefiles
this ignorefiles   ignorefiles
public string getignorefiles
return ignorefiles
public boolean addlicenseheader file file
system out println
return false
public string getlicensetype file file
return null
protected abstract string getlicenseheaderfilename
protected string getlicenseheader
if  strings isempty licenseheader
string header
linenumberreader linenumberreader   null
inputstream inputstream   null
inputstreamreader inputstreamreader   null
try
inputstream   apachelicenseheadertestcase class getresourceasstream getlicenseheaderfilename
inputstreamreader   new inputstreamreader inputstream
linenumberreader   new linenumberreader inputstreamreader
string line   linenumberreader readline
while  line    null
header    line   line_ending
line   linenumberreader readline
licenseheader   header trim
catch  exception e
assert fail e getmessage
finally
if  linenumberreader    null   try   linenumberreader close       catch  exception e       ignore
if  inputstream    null        try   inputstream close     	  catch  exception e       ignore
if  inputstreamreader    null  try   inputstreamreader close      catch  exception e       ignore
return licenseheader
protected string extractlicenseheader file file  int start  int length
string header
filereader filereader   null
try
filereader   new filereader file
linenumberreader linenumberreader   new linenumberreader filereader
for  int i   start  i < length  i
header    linenumberreader readline     line_ending
catch  exception e
assert fail e getmessage
finally
if  filereader    null
try
filereader close
catch  ioexception e
assert fail e getmessage
return header trim
/**
* add the license header to the start of the file without caring about
* existing license headers.
*
* @param file
*            the file to add the license header to.
*/
protected void prependlicenseheader file file
try
string content   new org apache wicket util file file file  readstring
content   getlicenseheader     line_ending   content
new org apache wicket util file file file  write content
catch  exception e
assert fail e getmessage