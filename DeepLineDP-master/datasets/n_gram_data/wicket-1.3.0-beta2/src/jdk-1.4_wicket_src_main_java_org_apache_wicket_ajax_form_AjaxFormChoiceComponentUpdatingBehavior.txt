/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket ajax form
import org apache wicket component
import org apache wicket wicketruntimeexception
import org apache wicket ajax abstractdefaultajaxbehavior
import org apache wicket ajax ajaxrequesttarget
import org apache wicket markup html iheaderresponse
import org apache wicket markup html form checkboxmultiplechoice
import org apache wicket markup html form checkgroup
import org apache wicket markup html form formcomponent
import org apache wicket markup html form radiochoice
import org apache wicket markup html form radiogroup
import org apache wicket util string appendingstringbuffer
/**
* @author jcompagner
*
*/
public abstract class ajaxformchoicecomponentupdatingbehavior extends abstractdefaultajaxbehavior
private static final long serialversionuid   1l
protected component component
/**
* default constructor
*/
public ajaxformchoicecomponentupdatingbehavior
super
/**
* @see wicket.ajax.abstractdefaultajaxbehavior#renderhead(wicket.markup.html.iheaderresponse)
*/
public void renderhead iheaderresponse response
super renderhead response
appendingstringbuffer asb   new appendingstringbuffer
asb append
asb append
asb append
asb append
asb append
asb append
asb append
asb append
asb append
asb append
asb append
response renderjavascript asb
response renderonloadjavascript     component getmarkupid        geteventhandler
/**
* listener invoked on the ajax request. this listener is invoked after the
* component's model has been updated.
*
* @param target
*/
protected abstract void onupdate ajaxrequesttarget target
/**
* called to handle any error resulting from updating form component. errors
* thrown from {@link #onupdate(ajaxrequesttarget)} will not be caught here.
*
* the runtimeexception will be null if it was just a validation or conversion
* error of the formcomponent
*
* @param target
* @param e
*/
protected void onerror ajaxrequesttarget target  runtimeexception e
if e    null  throw e
/**
*
* @see wicket.behavior.abstractajaxbehavior#onbind()
*/
protected void onbind
super onbind
if    getcomponent   instanceof radiochoice
getcomponent   instanceof checkboxmultiplechoice
getcomponent   instanceof radiogroup
getcomponent   instanceof checkgroup
throw new wicketruntimeexception     getclass   getname
/**
*
* @return formcomponent
*/
protected final formcomponent getformcomponent
return  formcomponent getcomponent
/**
* @return event handler
*/
protected final charsequence geteventhandler
return generatecallbackscript new appendingstringbuffer    append
getcallbackurl    append
getcomponent   getmarkupid
/**
*
* @see wicket.ajax.abstractdefaultajaxbehavior#respond(wicket.ajax.ajaxrequesttarget)
*/
protected final void respond final ajaxrequesttarget target
final formcomponent formcomponent   getformcomponent
try
formcomponent inputchanged
formcomponent validate
if  formcomponent haserrormessage
formcomponent invalid
onerror target  null
else
formcomponent valid
formcomponent updatemodel
onupdate target
catch  runtimeexception e
onerror target  e