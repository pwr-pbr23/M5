/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket examples captcha
import org apache wicket pageparameters
import org apache wicket examples wicketexamplepage
import org apache wicket extensions markup html captcha captchaimageresource
import org apache wicket markup componenttag
import org apache wicket markup html form form
import org apache wicket markup html form requiredtextfield
import org apache wicket markup html image image
import org apache wicket markup html panel feedbackpanel
import org apache wicket model propertymodel
import org apache wicket util value valuemap
/**
* captcha example page.
*
* @author joshua perlow
*/
public class captcha extends wicketexamplepage
private final class captchaform extends form
private static final long serialversionuid   1l
private final captchaimageresource captchaimageresource
/**
* construct.
*
* @param id
*/
public captchaform string id
super id
captchaimageresource   new captchaimageresource imagepass
add new image    captchaimageresource
add new requiredtextfield    new propertymodel properties
protected final void oncomponenttag final componenttag tag
super oncomponenttag tag
// clear the field after each render
tag put
/**
* @see org.apache.wicket.markup.html.form.form#onsubmit()
*/
public void onsubmit
if   imagepass equals getpassword
error     getpassword
imagepass
else
info
// force redrawing
captchaimageresource invalidate
private static final long serialversionuid   1l
private static int randomint int min  int max
return  int  math random      max   min    min
private static string randomstring int min  int max
int num   randomint min  max
byte b   new byte
for  int i   0  i < num  i
b    byte randomint
return new string b
/** random captcha password to match against. */
private string imagepass   randomstring 6  8
private final valuemap properties   new valuemap
/**
* construct.
*
* @param parameters
*/
public captcha final pageparameters parameters
final feedbackpanel feedback   new feedbackpanel
add feedback
add new captchaform
private string getpassword
return properties getstring