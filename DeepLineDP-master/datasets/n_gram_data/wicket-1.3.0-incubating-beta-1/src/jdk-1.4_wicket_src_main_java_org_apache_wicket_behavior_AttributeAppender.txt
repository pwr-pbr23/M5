/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket behavior
import org apache wicket attributemodifier
import org apache wicket model imodel
import org apache wicket util string appendingstringbuffer
import org apache wicket util string strings
/**
* attributemodifier that appends the given value, rather than replace it. this
* is especially useful for adding css classes to markup elements, or adding
* javascript snippets to existing element handlers.
*
* <pre>
*     &lt;a href=&quot;#&quot; wicket:id=&quot;foo&quot; class=&quot;link&quot; onmouseover=&quot;dosomething()&quot;&gt;
* </pre>
*
* can be modified with these attributeappenders:
*
* <pre>
* link.add(new attributeappender(&quot;class&quot;, new model(&quot;hot&quot;), &quot; &quot;));
* link.add(new attributeappender(&quot;onmouseover&quot;, new model(&quot;foo();return false;&quot;), &quot;;&quot;));
* </pre>
*
* this will result in the following markup:
*
* <pre>
*     &lt;a href=&quot;#&quot; wicket:id=&quot;foo&quot; class=&quot;link hot&quot; onmouseover=&quot;dosomething();foo();return false;&quot;&gt;
* </pre>
*
* @author martijn dashorst
*/
public class attributeappender extends attributemodifier
/** for serialization. */
private static final long serialversionuid   1l
/**
* separates the existing attribute value and the append value.
*/
private final string separator
/**
* creates an attributemodifier that appends the appendmodel's value to the
* current value of the attribute, and will add the attribute when
* addattributeifnotpresent is true.
*
* @param attribute
*            the attribute to append the appendmodels value to
* @param addattributeifnotpresent
*            when true, adds the attribute to the tag
* @param appendmodel
*            the model supplying the value to append
* @param separator
*            the separator string, comes between the original value and the
*            append value
*/
public attributeappender string attribute  boolean addattributeifnotpresent
imodel appendmodel  string separator
super attribute  addattributeifnotpresent  appendmodel
this separator   separator
/**
* creates an attributemodifier that appends the appendmodel's value to the
* current value of the attribute, and will add the attribute when it is not
* there already.
*
* @param attribute
*            the attribute to append the appendmodels value to
* @param appendmodel
*            the model supplying the value to append
* @param separator
*            the separator string, comes between the original value and the
*            append value
*/
public attributeappender string attribute  imodel appendmodel  string separator
super attribute  true  appendmodel
this separator   separator
/**
* @see org.apache.wicket.attributemodifier#newvalue(java.lang.string,
*      java.lang.string)
*/
protected string newvalue string currentvalue  string appendvalue
final int appendvaluelen    appendvalue    null  ? 0   appendvalue length
final appendingstringbuffer sb
if  currentvalue    null
sb   new appendingstringbuffer appendvaluelen   separator length
else
sb   new appendingstringbuffer currentvalue length     appendvaluelen
separator length
sb append currentvalue
// if the current value or the append value is empty, the separator is
// not needed.
if   strings isempty currentvalue      strings isempty appendvalue
sb append separator
// only append the value when it is not empty.
if   strings isempty appendvalue
sb append appendvalue
return sb tostring