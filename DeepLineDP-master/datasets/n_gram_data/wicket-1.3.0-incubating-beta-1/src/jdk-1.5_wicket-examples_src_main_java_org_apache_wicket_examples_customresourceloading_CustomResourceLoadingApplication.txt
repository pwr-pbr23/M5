/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket examples customresourceloading
import java net malformedurlexception
import java net url
import org apache commons logging log
import org apache commons logging logfactory
import org apache wicket wicketruntimeexception
import org apache wicket examples wicketexampleapplication
import org apache wicket protocol http webapplication
import org apache wicket util resource iresourcestream
import org apache wicket util resource urlresourcestream
import org apache wicket util resource locator iresourcestreamlocator
import org apache wicket util resource locator resourcestreamlocator
import org apache wicket util string strings
/**
* application class for the custom resource loading example.
*
* @author eelco hillenius
*/
public class customresourceloadingapplication extends wicketexampleapplication
/** log. */
private static final log log   logfactory getlog customresourceloadingapplication class
/**
* custom implementation of {@link iresourcestreamlocator}.
*/
private final class customresourcestreamlocator extends resourcestreamlocator
/**
* @see org.apache.wicket.util.resource.locator.resourcestreamlocator#locate(java.lang.class,
*      java.lang.string)
*/
public iresourcestream locate class clazz  string path
// log attempt
if  log isdebugenabled
log debug     path
string location
if  clazz    alternativepagefromwebcontext class
// this custom case disregards the path and tries it's own
// scheme
string extension   path substring path lastindexof      1
string simplefilename   strings lastpathcomponent clazz getname
location       simplefilename       extension
else
// use the normal package to path conversion of the passed in
// path variable
location       path
url url
try
// try to load the resource from the web context
url   getservletcontext   getresource location
if  url    null
return new urlresourcestream url
catch  malformedurlexception e
throw new wicketruntimeexception e
// resource not found; fall back on class loading
return super locate clazz  path
/**
* constructor.
*/
public customresourceloadingapplication
/**
* @see org.apache.wicket.application#gethomepage()
*/
public class gethomepage
return index class
/**
* @see webapplication#init()
*/
protected void init
// instruct the application to use our custom resource stream locator
getresourcesettings   setresourcestreamlocator new customresourcestreamlocator