/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket authentication
import org apache wicket request
import org apache wicket session
import org apache wicket authorization strategies role roles
import org apache wicket protocol http websession
/**
* basic authenticated web session. subclasses must provide a method that
* authenticates the session based on a username and password, and a method
* implementation that gets the roles
*
* @author jonathan locke
*/
public abstract class authenticatedwebsession extends websession
/**
* @return current authenticated web session
*/
public static authenticatedwebsession get
return  authenticatedwebsession session get
/** true when the user is signed in */
private boolean signedin
/**
* construct.
*
* @param application
*            the web application
* @param request
*            the current request object
* @param response
*/
public authenticatedwebsession final authenticatedwebapplication application  request request
super application  request
/**
* authenticates this session using the given username and password
*
* @param username
*            the username
* @param password
*            the password
* @return true if the user was authenticated successfully
*/
public abstract boolean authenticate final string username  final string password
/**
* @return get the roles that this session can play
*/
public abstract roles getroles
/**
* @return true if the user is signed in to this session
*/
public final boolean issignedin
return signedin
/**
* signs user in by authenticating them with a username and password
*
* @param username
*            the username
* @param password
*            the password
* @return true if the user was signed in successfully
*/
public final boolean signin final string username  final string password
return signedin   authenticate username  password
/**
* sign the user out.
*/
public void signout
signedin   false