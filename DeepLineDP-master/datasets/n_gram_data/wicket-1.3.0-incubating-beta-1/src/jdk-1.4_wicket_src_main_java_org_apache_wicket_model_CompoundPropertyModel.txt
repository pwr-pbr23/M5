/*
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache wicket model
import org apache wicket component
import org apache wicket util string appendingstringbuffer
/**
* a simple compound model which uses the component's name as the property
* expression to retrieve properties on the nested model object.
*
* compoundpropertymodel is a chaining model so it will call get/setobject
* on the given object if the object is an instanceof imodel itself.
*
* @see org.apache.wicket.model.imodel
* @see org.apache.wicket.model.model
* @see org.apache.wicket.model.abstractdetachablemodel
* @see ichainingmodel
*
* @author jonathan locke
*/
public class compoundpropertymodel implements icomponentinheritedmodel  ichainingmodel
private static final long serialversionuid   1l
private object target
/**
* constructor
*
* @param object
*            the model object, which may or may not implement imodel
*/
public compoundpropertymodel final object object
this target   object
/**
* @see org.apache.wicket.model.imodel#getobject()
*/
public object getobject
if  target instanceof imodel
return   imodel target  getobject
return target
/**
* @see org.apache.wicket.model.imodel#setobject(java.lang.object)
*/
public void setobject object object
if  target instanceof imodel
imodel target  setobject object
else
this target   object
/**
* @see org.apache.wicket.model.ichainingmodel#getchainedmodel()
*/
public imodel getchainedmodel
if  target instanceof imodel
return  imodel target
return null
/**
* @see org.apache.wicket.model.ichainingmodel#setchainedmodel(org.apache.wicket.model.imodel)
*/
public void setchainedmodel imodel model
target   model
/**
* @see org.apache.wicket.model.idetachable#detach()
*/
public void detach
if  target instanceof imodel
imodel target  detach
/**
* returns the property expression that should be used against the target
* object
*
* @param component
* @return property expression that should be used against the target object
*/
protected string propertyexpression component component
return component getid
/**
* @see org.apache.wicket.model.icomponentinheritedmodel#wraponinheritance(org.apache.wicket.component)
*/
public iwrapmodel wraponinheritance component component
return new attachedcompoundpropertymodel component
/**
* binds this model to a special property by returning a model
* that has this compound model as its nested/wrapped model and
* the property which should be evaluted.
* this can be used if the id of the component isn't a valid property
* for the data object.
*
* @param property
* @return the imodel that is a wrapper around the current model and the property
*/
public imodel bind string property
return new propertymodel this property
/**
* component aware variation of the {@link compoundpropertymodel} that
* components that inherit the model get
*
* @author ivaynberg
*/
private class attachedcompoundpropertymodel extends abstractpropertymodel
implements  iwrapmodel
private static final long serialversionuid   1l
private final component owner
/**
* constructor
*
* @param owner
*            component that this model has been attached to
*/
public attachedcompoundpropertymodel component owner
super compoundpropertymodel this
this owner   owner
/**
* @see org.apache.wicket.model.abstractpropertymodel#propertyexpression()
*/
protected string propertyexpression
return compoundpropertymodel this propertyexpression owner
/**
* @see org.apache.wicket.model.iwrapmodel#getwrappedmodel()
*/
public imodel getwrappedmodel
return compoundpropertymodel this
/**
* @see org.apache.wicket.model.abstractpropertymodel#detach()
*/
public void detach
super detach
compoundpropertymodel this detach
/**
* @see java.lang.object#tostring()
*/
public string tostring
appendingstringbuffer sb   new appendingstringbuffer   append
getclass   getname
sb append    append target  append
return sb tostring
// todo these methods are for helping people upgrade. remove after
// deprecation release.
/**
* @param component
* @return
* @deprecated replace by {@link imodel#getobject()}.
*/
public final object getobject component component
throw new unsupportedoperationexception
/**
* @param component
* @param object
* @deprecated replace by {@link imodel#setobject(object)}.
*/
public final void setobject component component  object object
throw new unsupportedoperationexception