/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel component hbase
import java net uri
import java util map
import org apache camel endpoint
import org apache camel component hbase model hbasecell
import org apache camel component hbase model hbaserow
import org apache camel impl defaultcomponent
import org apache hadoop conf configuration
import org apache hadoop hbase hbaseconfiguration
import org apache hadoop hbase client htablepool
/**
* represents the component that manages {@link hbaseendpoint}.
*/
public class hbasecomponent extends defaultcomponent
private configuration configuration
private htablepool tablepool
private int poolmaxsize   10
@override
protected void dostart   throws exception
if  configuration    null
configuration   hbaseconfiguration create
tablepool   new htablepool configuration  poolmaxsize
@override
protected void dostop   throws exception
if  tablepool    null
tablepool close
protected endpoint createendpoint string uri  string remaining  map<string  object> parameters  throws exception
uri endpointuri   new uri uri
string tablename   endpointuri gethost
hbaseendpoint endpoint   new hbaseendpoint uri  this  tablepool  tablename
hbaserow parameterrowmodel   createrowmodel parameters
setproperties endpoint  parameters
if  endpoint getrowmodel      null
endpoint setrowmodel parameterrowmodel
return endpoint
/**
* creates an {@link hbaserow} model from the specified endpoint parameters.
*
* @param parameters
* @return
*/
public hbaserow createrowmodel map<string  object> parameters
hbaserow rowmodel   new hbaserow
if  parameters containskey hbaseattribute hbase_row_type asoption
string rowtype   string valueof parameters remove hbaseattribute hbase_row_type asoption
if  rowtype    null     rowtype isempty
rowmodel setrowtype getcamelcontext   getclassresolver   resolveclass rowtype
for  int i   1  parameters get hbaseattribute hbase_family asoption i      null
parameters get hbaseattribute hbase_qualifier asoption i      null  i
hbasecell cellmodel   new hbasecell
cellmodel setfamily string valueof parameters remove hbaseattribute hbase_family asoption i
cellmodel setqualifier string valueof parameters remove hbaseattribute hbase_qualifier asoption i
cellmodel setvalue string valueof parameters remove hbaseattribute hbase_value asoption i
if  parameters containskey hbaseattribute hbase_value_type asoption
string valuetype   string valueof parameters remove hbaseattribute hbase_value_type asoption
if  valuetype    null     valuetype isempty
rowmodel setrowtype getcamelcontext   getclassresolver   resolveclass valuetype
rowmodel getcells   add cellmodel
return rowmodel
public configuration getconfiguration
return configuration
public void setconfiguration configuration configuration
this configuration   configuration
public int getpoolmaxsize
return poolmaxsize
public void setpoolmaxsize int poolmaxsize
this poolmaxsize   poolmaxsize