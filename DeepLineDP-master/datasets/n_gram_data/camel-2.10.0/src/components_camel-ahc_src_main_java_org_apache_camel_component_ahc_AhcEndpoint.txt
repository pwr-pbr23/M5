/**
* licensed to the apache software foundation (asf) under one or more
* contributor license agreements.  see the notice file distributed with
* this work for additional information regarding copyright ownership.
* the asf licenses this file to you under the apache license, version 2.0
* (the "license"); you may not use this file except in compliance with
* the license.  you may obtain a copy of the license at
*
*      http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache camel component ahc
import java net uri
import javax net ssl sslcontext
import com ning http client asynchttpclient
import com ning http client asynchttpclientconfig
import org apache camel consumer
import org apache camel processor
import org apache camel producer
import org apache camel impl defaultendpoint
import org apache camel spi headerfilterstrategy
import org apache camel spi headerfilterstrategyaware
import org apache camel util objecthelper
import org apache camel util jsse sslcontextparameters
/**
*
*/
public class ahcendpoint extends defaultendpoint implements headerfilterstrategyaware
private asynchttpclient client
private asynchttpclientconfig clientconfig
private headerfilterstrategy headerfilterstrategy   new httpheaderfilterstrategy
private ahcbinding binding
private uri httpuri
private boolean bridgeendpoint
private boolean throwexceptiononfailure   true
private boolean transferexception
private sslcontextparameters sslcontextparameters
public ahcendpoint string endpointuri  ahccomponent component  uri httpuri
super endpointuri  component
this httpuri   httpuri
@override
public ahccomponent getcomponent
return  ahccomponent  super getcomponent
@override
public producer createproducer   throws exception
objecthelper notnull client     this
objecthelper notnull httpuri     this
objecthelper notnull binding     this
return new ahcproducer this
@override
public consumer createconsumer processor processor  throws exception
throw new unsupportedoperationexception
@override
public boolean islenientproperties
// true to allow dynamic uri options to be configured and passed to external system for eg. the httpproducer
return true
@override
public boolean issingleton
return true
public asynchttpclient getclient
return client
public void setclient asynchttpclient client
this client   client
public asynchttpclientconfig getclientconfig
return clientconfig
public void setclientconfig asynchttpclientconfig clientconfig
this clientconfig   clientconfig
public uri gethttpuri
return httpuri
public void sethttpuri uri httpuri
this httpuri   httpuri
public ahcbinding getbinding
return binding
public void setbinding ahcbinding binding
this binding   binding
public headerfilterstrategy getheaderfilterstrategy
return headerfilterstrategy
public void setheaderfilterstrategy headerfilterstrategy headerfilterstrategy
this headerfilterstrategy   headerfilterstrategy
public boolean isbridgeendpoint
return bridgeendpoint
public void setbridgeendpoint boolean bridgeendpoint
this bridgeendpoint   bridgeendpoint
public boolean isthrowexceptiononfailure
return throwexceptiononfailure
public void setthrowexceptiononfailure boolean throwexceptiononfailure
this throwexceptiononfailure   throwexceptiononfailure
public boolean istransferexception
return transferexception
public void settransferexception boolean transferexception
this transferexception   transferexception
public sslcontextparameters getsslcontextparameters
return sslcontextparameters
public void setsslcontextparameters sslcontextparameters sslcontextparameters
this sslcontextparameters   sslcontextparameters
@override
protected void dostart   throws exception
super dostart
if  client    null
asynchttpclientconfig config   null
if  clientconfig    null
asynchttpclientconfig builder builder   ahccomponent cloneconfig clientconfig
if  sslcontextparameters    null
// todo: remove us, but part of investigation issue on java7 on ubuntu
system out println sslcontextparameters
sslcontext ssl   sslcontextparameters createsslcontext
system out println ssl
builder setsslcontext ssl
config   builder build
else
if  sslcontextparameters    null
asynchttpclientconfig builder builder
new asynchttpclientconfig builder
// todo: remove us, but part of investigation issue on java7 on ubuntu
system out println sslcontextparameters
sslcontext ssl   sslcontextparameters createsslcontext
system out println ssl
builder setsslcontext ssl
config   builder build
if  config    null
client   new asynchttpclient
else
client   new asynchttpclient config
@override
protected void dostop   throws exception
super dostop
// ensure client is closed when stopping
if  client    null     client isclosed
client close
client   null