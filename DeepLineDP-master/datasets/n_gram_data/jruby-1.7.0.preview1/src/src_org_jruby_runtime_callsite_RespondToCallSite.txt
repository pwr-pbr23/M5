package org jruby runtime callsite
import org jruby ruby
import org jruby runtime threadcontext
import org jruby runtime builtin irubyobject
import org jruby rubyclass
import org jruby internal runtime methods dynamicmethod
import org jruby runtime visibility
public class respondtocallsite extends normalcachingcallsite
private volatile respondtotuple respondtotuple   respondtotuple null_cache
private static class respondtotuple
static final respondtotuple null_cache   new respondtotuple    true  cacheentry null_cache  cacheentry null_cache  null
public final string name
public final boolean checkvisibility
public final cacheentry respondtomethod
public final cacheentry entry
public final irubyobject respondsto
public respondtotuple string name  boolean checkvisibility  cacheentry respondtomethod  cacheentry entry  irubyobject respondsto
this name   name
this checkvisibility   checkvisibility
this respondtomethod   respondtomethod
this entry   entry
this respondsto   respondsto
public boolean cacheok rubyclass klass
return respondtomethod typeok klass     entry typeok klass
public respondtocallsite
super
@override
public irubyobject call threadcontext context  irubyobject caller  irubyobject self  irubyobject name
rubyclass klass   self getmetaclass
respondtotuple tuple   respondtotuple
if  tuple cacheok klass
string strname   name asjavastring
if  strname equals tuple name     tuple checkvisibility  return tuple respondsto
// go through normal call logic, which will hit overridden cacheandcall
irubyobject respond   super call context  caller  self  name
if   respond istrue      context getruntime   is1_9
respond   self callmethod context     new irubyobject name  context getruntime   getfalse
respond   context getruntime   newboolean respond istrue
return respond
@override
public irubyobject call threadcontext context  irubyobject caller  irubyobject self  irubyobject name  irubyobject bool
rubyclass klass   self getmetaclass
respondtotuple tuple   respondtotuple
if  tuple cacheok klass
string strname   name asjavastring
if  strname equals tuple name      bool istrue      tuple checkvisibility  return tuple respondsto
// go through normal call logic, which will hit overridden cacheandcall
irubyobject respond   super call context  caller  self  name  bool
if   respond istrue      context getruntime   is1_9
respond   self callmethod context     new irubyobject name  bool
respond   context getruntime   newboolean respond istrue
return respond
@override
protected irubyobject cacheandcall irubyobject caller  rubyclass selftype  threadcontext context  irubyobject self  irubyobject arg
cacheentry entry   selftype searchwithcache methodname
dynamicmethod method   entry method
if  methodmissing method  caller
return callmethodmissing context  self  method  arg
// alternate logic to cache the result of respond_to if it's the standard one
if  entry method    context getruntime   getrespondtomethod
string name   arg asjavastring
respondtotuple tuple   recacherespondsto entry  name  selftype  true  context
respondtotuple   tuple
return tuple respondsto
// normal logic if it's not the builtin respond_to? method
cache   entry
return method call context  self  selftype  methodname  arg
@override
protected irubyobject cacheandcall irubyobject caller  rubyclass selftype  threadcontext context  irubyobject self  irubyobject arg0  irubyobject arg1
cacheentry entry   selftype searchwithcache methodname
dynamicmethod method   entry method
if  methodmissing method  caller
return callmethodmissing context  self  method  arg0  arg1
// alternate logic to cache the result of respond_to if it's the standard one
if  entry method    context getruntime   getrespondtomethod
string name   arg0 asjavastring
respondtotuple tuple   recacherespondsto entry  name  selftype   arg1 istrue    context
respondtotuple   tuple
return tuple respondsto
// normal logic if it's not the builtin respond_to? method
cache   entry
return method call context  self  selftype  methodname  arg0  arg1
private static respondtotuple recacherespondsto cacheentry respondtomethod  string newstring  rubyclass klass  boolean checkvisibility  threadcontext context
ruby runtime   context getruntime
cacheentry respondtolookupresult   klass searchwithcache newstring
irubyobject respondsto
if   respondtolookupresult method isundefined       respondtolookupresult method isnotimplemented
respondsto   checkvisibilityandcache respondtolookupresult  checkvisibility  runtime
else
respondsto   runtime getfalse
return new respondtotuple newstring  checkvisibility  respondtomethod  respondtolookupresult  respondsto
private static irubyobject checkvisibilityandcache cacheentry respondentry  boolean checkvisibility  ruby runtime
if   checkvisibility    respondentry method getvisibility      visibility private
return runtime gettrue
else
return runtime getfalse