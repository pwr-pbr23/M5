/*
derby - class org.apache.derby.iapi.sql.preparedstatement
licensed to the apache software foundation (asf) under one or more
contributor license agreements.  see the notice file distributed with
this work for additional information regarding copyright ownership.
the asf licenses this file to you under the apache license, version 2.0
(the "license"); you may not use this file except in compliance with
the license.  you may obtain a copy of the license at
http://www.apache.org/licenses/license-2.0
unless required by applicable law or agreed to in writing, software
distributed under the license is distributed on an "as is" basis,
without warranties or conditions of any kind, either express or implied.
see the license for the specific language governing permissions and
limitations under the license.
*/
package org apache derby iapi sql
import org apache derby iapi error standardexception
import org apache derby iapi sql conn languageconnectioncontext
import org apache derby iapi sql depend dependent
import org apache derby iapi sql depend provider
import org apache derby iapi types datatypedescriptor
import java sql timestamp
import java sql sqlwarning
/**
* the preparedstatement interface provides methods to execute prepared
* statements, store them, and get metadata about them.
*
*/
public interface preparedstatement
extends dependent
/**
* checks whether this preparedstatement is up to date.
* a preparedstatement can become out of date if any of several
* things happen:
*
*	a schema used by the statement is dropped
*	a table used by the statement is dropped
*	a table used by the statement, or a column in such a table,
*		is altered in one of several ways: a column is dropped,
*		a privilege is dropped, a constraint is added or
*		dropped, an index is dropped.
*	a view used by the statement is dropped.
*
* in general, anything that happened since the plan was generated
* that might cause the plan to fail, or to generate incorrect results,
* will cause this method to return false.
*
* @return	true if the preparedstatement is up to date,
*		false if it is not up to date
*/
boolean	uptodate   throws standardexception
/**
* re-prepare the statement if it is not up to date or,
* if requested, simply not optimal.
* if there are open cursors using this prepared statement,
* then we will not be able to recompile the statement.
*
* @param lcc			the languageconnectioncontext.
*
* @exception standardexception thrown if unable to perform
*/
void reprepare languageconnectioncontext lcc
throws standardexception
/**
* preparedstatements are re-entrant - that is, more than one
* execution can be active at a time for a single prepared statement.
* an activation contains all the local state information to
* execute a prepared statement (as opposed to the constant
* information, such as literal values and code). each activation
* class contains the code specific to the prepared statement
* represented by an instance of this class (preparedstatement).
*
* @param lcc			the languageconnectioncontext.
* @return	the new activation.
*
* @exception standardexception		thrown on failure
*/
activation	getactivation languageconnectioncontext lcc  boolean scrollable  throws standardexception
/**
* execute the preparedstatement and return results, used for top level
* statements (not substatements) in a connection.
*<p>
* there is no executequery() or
* executeupdate(); a method is provided in
* resultset to tell whether to expect rows to be returned.
*
* @param activation the activation containing all the local state
*		to execute the plan.
* @param timeoutmillis timeout value in milliseconds.
*
* @return	a resultset for a statement. a resultset represents
*		the results returned from the statement, if any.
*		will return null if the plan for the preparedstatement
*		has aged out of cache, or the plan is out of date.
*
* @exception standardexception		thrown on failure
*/
resultset execute activation activation
long timeoutmillis
throws standardexception
/**
* execute a statement as part of another statement (ithout a nested
* connection) and return results.
* <p>
* there is no executequery() or
* executeupdate(); a method is provided in
* resultset to tell whether to expect rows to be returned.
*
* @param parent the activation of the superstatement
* @param activation the activation containing all the local state
*		to execute the plan for substatement
* @param rollbackparentcontext true if in the event of a statement-level
*	 exception, the parent context needs to be rolled back, too.
* @param timeoutmillis timeout value in milliseconds.
*
* @return	a resultset for a statement. a resultset represents
*		the results returned from the statement, if any.
*		will return null if the plan for the preparedstatement
*		has aged out of cache, or the plan is out of date.
*
* @exception standardexception		thrown on failure
*/
resultset executesubstatement activation parent
activation activation
boolean rollbackparentcontext
long timeoutmillis
throws standardexception
/**
* execute a statement as part of another statement (without a nested
* connection) and return results.
* <p>
* creates a new single use activation and executes it, but also passes
* rollbackparentcontext parameter.
* @param lcc language connection context
* @param rollbackparentcontext  true if in the event of a statement-level
*	 exception, the parent context needs to be rolled back, too.
* @param timeoutmillis timeout value in milliseconds.
* @see #executesubstatement(activation, activation, boolean, long)
*/
resultset executesubstatement languageconnectioncontext lcc
boolean rollbackparentcontext
long timeoutmillis
throws standardexception
/**
* get the resultdescription for the statement.  the resultdescription
* describes what the results look like: what are the rows and columns?
* <p>
* this is available here and on the resultset so that users can
* see the shape of the result before they execute.
*
* @return	a resultdescription describing the results.
*
*/
resultdescription	getresultdescription
/**
* return true if the query node for this statement references session schema tables.
*
* @return	true if references session schema tables, else false
*/
boolean referencessessionschema
/**
* get an array of datatypedescriptors describing the types of the
* parameters of this preparedstatement. the nth element of the array
* describes the nth parameter.
*
* @return		an array of datatypedescriptors telling the
*			type, length, precision, scale, etc. of each
*			parameter of this preparedstatement.
*/
datatypedescriptor	getparametertypes
/**
*	return the sql string that this statement is for.
*
*	@return the sql string this statement is for.
*/
string getsource
/**
*	return the sps name for this statement.
*
*	@return the sps name for this statement
*/
string getspsname
/**
* get the total compile time for the associated query in milliseconds.
* compile time can be divided into parse, bind, optimize and generate times.
*
* @return long		the total compile time for the associated query in milliseconds.
*/
public long getcompiletimeinmillis
/**
* get the parse time for the associated query in milliseconds.
*
* @return long		the parse time for the associated query in milliseconds.
*/
public long getparsetimeinmillis
/**
* get the bind time for the associated query in milliseconds.
*
* @return long		the bind time for the associated query in milliseconds.
*/
public long getbindtimeinmillis
/**
* get the optimize time for the associated query in milliseconds.
*
* @return long		the optimize time for the associated query in milliseconds.
*/
public long getoptimizetimeinmillis
/**
* get the generate time for the associated query in milliseconds.
*
* @return long		the generate time for the associated query in milliseconds.
*/
public long getgeneratetimeinmillis
/**
* get the timestamp for the beginning of compilation
*
* @return timestamp	the timestamp for the beginning of compilation.
*/
public timestamp getbegincompiletimestamp
/**
* get the timestamp for the end of compilation
*
* @return timestamp	the timestamp for the end of compilation.
*/
public timestamp getendcompiletimestamp
/**
* returns whether or not this statement requires should
* behave atomically -- i.e. whether a user is permitted
* to do a commit/rollback during the execution of this
* statement.
*
* @return boolean	whether or not this statement is atomic
*/
boolean isatomic
/**
return any compile time warnings. null if no warnings exist.
*/
public sqlwarning getcompiletimewarnings