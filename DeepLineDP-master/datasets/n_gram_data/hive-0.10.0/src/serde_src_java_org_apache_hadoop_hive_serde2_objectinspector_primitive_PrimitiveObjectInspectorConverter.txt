/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 objectinspector primitive
import java sql timestamp
import org apache hadoop hive serde2 bytestream
import org apache hadoop hive serde2 lazy lazyinteger
import org apache hadoop hive serde2 lazy lazylong
import org apache hadoop hive serde2 objectinspector objectinspectorconverters converter
import org apache hadoop hive serde2 objectinspector primitiveobjectinspector
import org apache hadoop io text
/**
* primitiveobjectinspectorconverter.
*
*/
public class primitiveobjectinspectorconverter
/**
* a converter for the byte type.
*/
public static class booleanconverter implements converter
primitiveobjectinspector inputoi
settablebooleanobjectinspector outputoi
object r
public booleanconverter primitiveobjectinspector inputoi
settablebooleanobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create false
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getboolean input
inputoi
catch  numberformatexception e
return null
/**
* a converter for the byte type.
*/
public static class byteconverter implements converter
primitiveobjectinspector inputoi
settablebyteobjectinspector outputoi
object r
public byteconverter primitiveobjectinspector inputoi
settablebyteobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create  byte  0
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getbyte input
inputoi
catch  numberformatexception e
return null
/**
* a converter for the short type.
*/
public static class shortconverter implements converter
primitiveobjectinspector inputoi
settableshortobjectinspector outputoi
object r
public shortconverter primitiveobjectinspector inputoi
settableshortobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create  short  0
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getshort input
inputoi
catch  numberformatexception e
return null
/**
* a converter for the int type.
*/
public static class intconverter implements converter
primitiveobjectinspector inputoi
settableintobjectinspector outputoi
object r
public intconverter primitiveobjectinspector inputoi
settableintobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create 0
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getint input
inputoi
catch  numberformatexception e
return null
/**
* a converter for the long type.
*/
public static class longconverter implements converter
primitiveobjectinspector inputoi
settablelongobjectinspector outputoi
object r
public longconverter primitiveobjectinspector inputoi
settablelongobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create 0
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getlong input
inputoi
catch  numberformatexception e
return null
/**
* a converter for the float type.
*/
public static class floatconverter implements converter
primitiveobjectinspector inputoi
settablefloatobjectinspector outputoi
object r
public floatconverter primitiveobjectinspector inputoi
settablefloatobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create 0
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getfloat input
inputoi
catch  numberformatexception e
return null
/**
* a converter for the double type.
*/
public static class doubleconverter implements converter
primitiveobjectinspector inputoi
settabledoubleobjectinspector outputoi
object r
public doubleconverter primitiveobjectinspector inputoi
settabledoubleobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create 0
@override
public object convert object input
if  input    null
return null
try
return outputoi set r  primitiveobjectinspectorutils getdouble input
inputoi
catch  numberformatexception e
return null
public static class timestampconverter implements converter
primitiveobjectinspector inputoi
settabletimestampobjectinspector outputoi
object r
public timestampconverter primitiveobjectinspector inputoi
settabletimestampobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create new timestamp 0
public object convert object input
if  input    null
return null
return outputoi set r  primitiveobjectinspectorutils gettimestamp input
inputoi
public static class binaryconverter implements converter
primitiveobjectinspector inputoi
settablebinaryobjectinspector outputoi
object r
public binaryconverter primitiveobjectinspector inputoi
settablebinaryobjectinspector outputoi
this inputoi   inputoi
this outputoi   outputoi
r   outputoi create new byte
@override
public object convert object input
return outputoi set r  primitiveobjectinspectorutils getbinary input
inputoi
/**
* a helper class to convert any primitive to text.
*/
public static class textconverter implements converter
private final primitiveobjectinspector inputoi
private final text t   new text
private final bytestream output out   new bytestream output
private static byte truebytes
private static byte falsebytes
public textconverter primitiveobjectinspector inputoi
// the output objectinspector is writablestringobjectinspector.
this inputoi   inputoi
public text convert object input
if  input    null
return null
switch  inputoi getprimitivecategory
case void
return null
case boolean
t set   booleanobjectinspector  inputoi  get input  ? truebytes
falsebytes
return t
case byte
out reset
lazyinteger writeutf8noexception out    byteobjectinspector  inputoi  get input
t set out getdata    0  out getcount
return t
case short
out reset
lazyinteger writeutf8noexception out    shortobjectinspector  inputoi  get input
t set out getdata    0  out getcount
return t
case int
out reset
lazyinteger writeutf8noexception out    intobjectinspector  inputoi  get input
t set out getdata    0  out getcount
return t
case long
out reset
lazylong writeutf8noexception out    longobjectinspector  inputoi  get input
t set out getdata    0  out getcount
return t
case float
t set string valueof   floatobjectinspector  inputoi  get input
return t
case double
t set string valueof   doubleobjectinspector  inputoi  get input
return t
case string
if  inputoi preferwritable
t set   stringobjectinspector  inputoi  getprimitivewritableobject input
else
t set   stringobjectinspector  inputoi  getprimitivejavaobject input
return t
case timestamp
t set   timestampobjectinspector  inputoi
getprimitivewritableobject input  tostring
return t
case binary
t set   binaryobjectinspector  inputoi  getprimitivewritableobject input  getbytes
return t
default
throw new runtimeexception     inputoi gettypename
/**
* a helper class to convert any primitive to string.
*/
public static class stringconverter implements converter
primitiveobjectinspector inputoi
public stringconverter primitiveobjectinspector inputoi
// the output objectinspector is writablestringobjectinspector.
this inputoi   inputoi
@override
public object convert object input
return primitiveobjectinspectorutils getstring input  inputoi