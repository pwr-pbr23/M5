/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql exec
import java util collection
import java util hashmap
import java util map
import org apache hadoop io longwritable
public class stat
// stored stats
private final map<string  longwritable> statsmap
// additional bookkeeping info for the stored stats
private final map<string  integer> bookkeepinginfo
public stat
statsmap   new hashmap<string  longwritable>
bookkeepinginfo   new hashmap<string  integer>
public void addtostat string stattype  long amount
longwritable currentvalue   statsmap get stattype
if  currentvalue    null
statsmap put stattype  new longwritable amount
else
currentvalue set currentvalue get     amount
public long getstat string stattype
longwritable currvalue   statsmap get stattype
if  currvalue    null
return 0
return currvalue get
public collection<string> getstoredstats
return statsmap keyset
public void clear
statsmap clear
// additional information about stats (e.g., virtual column number
public void setbookkeepinginfo string stattype  int info
bookkeepinginfo put stattype  info
public int getbookkeepinginfo string stattype
integer info   bookkeepinginfo get stattype
if  info    null
return  1
return info intvalue