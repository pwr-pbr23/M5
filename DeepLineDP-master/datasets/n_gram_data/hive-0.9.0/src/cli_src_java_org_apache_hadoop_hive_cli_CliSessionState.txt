/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive cli
import java util arraylist
import java util list
import java util properties
import org apache hadoop hive conf hiveconf
import org apache hadoop hive ql metadata hive
import org apache hadoop hive ql metadata hiveexception
import org apache hadoop hive ql session sessionstate
import org apache hadoop hive service hiveclient
import org apache thrift texception
import org apache thrift protocol tbinaryprotocol
import org apache thrift protocol tprotocol
import org apache thrift transport tsocket
import org apache thrift transport ttransport
import org apache thrift transport ttransportexception
/**
* clisessionstate.
*
*/
public class clisessionstate extends sessionstate
/**
* -e option if any that the session has been invoked with.
*/
public string execstring
/**
* -f option if any that the session has been invoked with.
*/
public string filename
/**
* properties set from -hiveconf via cmdline.
*/
public properties cmdproperties   new properties
/**
* -i option if any that the session has been invoked with.
*/
public list<string> initfiles   new arraylist<string>
/**
* host name and port number of remote hive server
*/
protected string host
protected int port
private boolean remotemode
private ttransport transport
private hiveclient client
private hive hive     currently only used  and init'ed  in getcurrentdbname
public clisessionstate
super
remotemode   false
public clisessionstate hiveconf conf
super conf
remotemode   false
/**
* connect to hive server
*/
public void connect   throws ttransportexception
transport   new tsocket host  port
tprotocol protocol   new tbinaryprotocol transport
client   new hiveclient protocol
transport open
remotemode   true
public void sethost string host
this host   host
public string gethost
return host
public int getport
return port
public void close
try
if  remotemode
client clean
transport close
catch  texception e
e printstacktrace
public boolean isremotemode
return remotemode
public hiveclient getclient
return client
/**
* return the name of the current database
* @return the name of the current database or, if an error, null
*/
public string getcurrentdbname
if  hive    null
try
hive   hive get conf
catch  hiveexception e
return null
return hive getcurrentdatabase