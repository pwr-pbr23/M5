/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql security authorization
import java util enumset
import org apache hadoop hive ql parse hiveparser
/**
* privilege defines a privilege in hive. each privilege has a name and scope associated with it.
* this class contains all of the predefined privileges in hive.
*/
public class privilege
public enum privilegetype
all
alter_data
alter_metadata
create
drop
index
lock
select
show_database
unknown
public static privilegetype getprivtypebytoken int token
switch  token
case hiveparser tok_priv_all
return privilegetype all
case hiveparser tok_priv_alter_data
return privilegetype alter_data
case hiveparser tok_priv_alter_metadata
return privilegetype alter_metadata
case hiveparser tok_priv_create
return privilegetype create
case hiveparser tok_priv_drop
return privilegetype drop
case hiveparser tok_priv_index
return privilegetype index
case hiveparser tok_priv_lock
return privilegetype lock
case hiveparser tok_priv_select
return privilegetype select
case hiveparser tok_priv_show_database
return privilegetype show_database
default
return privilegetype unknown
public static privilegetype getprivtypebyname string privilegename
string canonicalizedname   privilegename tolowercase
if  canonicalizedname equals
return privilegetype all
else if  canonicalizedname equals
return privilegetype alter_data
else if  canonicalizedname equals
return privilegetype alter_metadata
else if  canonicalizedname equals
return privilegetype create
else if  canonicalizedname equals
return privilegetype drop
else if  canonicalizedname equals
return privilegetype index
else if  canonicalizedname equals
return privilegetype lock
else if  canonicalizedname equals
return privilegetype select
else if  canonicalizedname equals
return privilegetype show_database
return privilegetype unknown
private privilegetype priv
private enumset<privilegescope> supportedscopeset
private privilege privilegetype priv  enumset<privilegescope> scopeset
super
this priv   priv
this supportedscopeset   scopeset
public privilege privilegetype priv
super
this priv   priv
public privilegetype getpriv
return priv
public void setpriv privilegetype priv
this priv   priv
public boolean supportcolumnlevel
return supportedscopeset    null
supportedscopeset contains privilegescope column_level_scope
public boolean supportdblevel
return supportedscopeset    null
supportedscopeset contains privilegescope db_level_scope
public boolean supporttablelevel
return supportedscopeset    null
supportedscopeset contains privilegescope table_level_scope
@override
public string tostring
switch  this priv
case all
return
case alter_data
return
case alter_metadata
return
case create
return
case drop
return
case index
return
case lock
return
case select
return
case show_database
return
default
return
public privilege
public static privilege all   new privilege privilegetype all
privilegescope allscope_except_column
public static privilege alter_metadata   new privilege privilegetype alter_metadata
privilegescope allscope_except_column
public static privilege alter_data   new privilege privilegetype alter_data
privilegescope allscope_except_column
public static privilege create   new privilege privilegetype create
privilegescope allscope_except_column
public static privilege drop   new privilege privilegetype drop
privilegescope allscope_except_column
public static privilege index   new privilege privilegetype index
privilegescope allscope
public static privilege lock   new privilege privilegetype lock
privilegescope allscope_except_column
public static privilege select   new privilege privilegetype select
privilegescope allscope
public static privilege show_database   new privilege privilegetype show_database
enumset of privilegescope user_level_scope