/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql io
import org apache hadoop io byteswritable
import org apache hadoop io writablecomparator
/**
* hivekey is a simple wrapper on text which allows us to set the hashcode
* easily. hashcode is used for hadoop partitioner.
*/
public class hivekey extends byteswritable
private static final int length_bytes   4
boolean hashcodevalid
public hivekey
hashcodevalid   false
protected int myhashcode
public void sethashcode int myhashcode
hashcodevalid   true
this myhashcode   myhashcode
@override
public int hashcode
if   hashcodevalid
throw new runtimeexception
hivekey class
return myhashcode
/** a comparator optimized for hivekey. */
public static class comparator extends writablecomparator
public comparator
super hivekey class
/**
* compare the buffers in serialized form.
*/
@override
public int compare byte b1  int s1  int l1  byte b2  int s2  int l2
return comparebytes b1  s1   length_bytes  l1   length_bytes  b2  s2
length_bytes  l2   length_bytes
static
writablecomparator define hivekey class  new comparator