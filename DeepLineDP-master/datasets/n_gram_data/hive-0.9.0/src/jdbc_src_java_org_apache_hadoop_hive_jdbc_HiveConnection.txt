/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive jdbc
import org apache hadoop hive conf hiveconf
import org apache hadoop hive metastore api metaexception
import org apache hadoop hive service hiveclient
import org apache hadoop hive service hiveinterface
import org apache hadoop hive service hiveserver
import org apache thrift texception
import org apache thrift protocol tbinaryprotocol
import org apache thrift protocol tprotocol
import org apache thrift transport tsocket
import org apache thrift transport ttransport
import org apache thrift transport ttransportexception
import java sql array
import java sql blob
import java sql callablestatement
import java sql clob
import java sql connection
import java sql databasemetadata
import java sql nclob
import java sql preparedstatement
import java sql sqlclientinfoexception
import java sql sqlexception
import java sql sqlwarning
import java sql sqlxml
import java sql savepoint
import java sql statement
import java sql struct
import java util map
import java util properties
/**
* hiveconnection.
*
*/
public class hiveconnection implements java sql connection
private ttransport transport
private hiveinterface client
private boolean isclosed   true
private sqlwarning warningchain   null
private static final string uri_prefix
/**
* create a connection to a local hive
*
* @param hiveconf
* @throws sqlexception
*/
public hiveconnection hiveconf hiveconf  throws sqlexception
try
client   new hiveserver hiveserverhandler hiveconf
catch  metaexception e
throw new sqlexception
e getmessage      e
isclosed   false
configureconnection
/**
* todo: - parse uri (use java.net.uri?).
*/
public hiveconnection string uri  properties info  throws sqlexception
if   uri startswith uri_prefix
throw new sqlexception     uri
// remove prefix
uri   uri substring uri_prefix length
// if uri is not specified, use local mode.
if  uri isempty
try
client   new hiveserver hiveserverhandler
catch  metaexception e
throw new sqlexception
e getmessage      e
else
// parse uri
// form: hostname:port/databasename
string parts   uri split
string hostport   parts split
int port   10000
string host   hostport
try
port   integer parseint hostport
catch  exception e
transport   new tsocket host  port
tprotocol protocol   new tbinaryprotocol transport
client   new hiveclient protocol
try
transport open
catch  ttransportexception e
throw new sqlexception
uri       e getmessage
isclosed   false
configureconnection
private void configureconnection   throws sqlexception
statement stmt   createstatement
stmt execute
stmt close
/*
* (non-javadoc)
*
* @see java.sql.connection#clearwarnings()
*/
public void clearwarnings   throws sqlexception
warningchain   null
/*
* (non-javadoc)
*
* @see java.sql.connection#close()
*/
public void close   throws sqlexception
if   isclosed
try
client clean
catch  texception e
throw new sqlexception    e
finally
isclosed   true
if  transport    null
transport close
/*
* (non-javadoc)
*
* @see java.sql.connection#commit()
*/
public void commit   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createarrayof(java.lang.string,
* java.lang.object[])
*/
public array createarrayof string arg0  object arg1  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createblob()
*/
public blob createblob   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createclob()
*/
public clob createclob   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createnclob()
*/
public nclob createnclob   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createsqlxml()
*/
public sqlxml createsqlxml   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/**
* creates a statement object for sending sql statements to the database.
*
* @throws sqlexception
*           if a database access error occurs.
* @see java.sql.connection#createstatement()
*/
public statement createstatement   throws sqlexception
if  isclosed
throw new sqlexception
return new hivestatement client
/*
* (non-javadoc)
*
* @see java.sql.connection#createstatement(int, int)
*/
public statement createstatement int resultsettype  int resultsetconcurrency
throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createstatement(int, int, int)
*/
public statement createstatement int resultsettype  int resultsetconcurrency
int resultsetholdability  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#createstruct(java.lang.string, java.lang.object[])
*/
public struct createstruct string typename  object attributes
throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#getautocommit()
*/
public boolean getautocommit   throws sqlexception
return true
/*
* (non-javadoc)
*
* @see java.sql.connection#getcatalog()
*/
public string getcatalog   throws sqlexception
return
/*
* (non-javadoc)
*
* @see java.sql.connection#getclientinfo()
*/
public properties getclientinfo   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#getclientinfo(java.lang.string)
*/
public string getclientinfo string name  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#getholdability()
*/
public int getholdability   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#getmetadata()
*/
public databasemetadata getmetadata   throws sqlexception
return new hivedatabasemetadata client
/*
* (non-javadoc)
*
* @see java.sql.connection#gettransactionisolation()
*/
public int gettransactionisolation   throws sqlexception
return connection transaction_none
/*
* (non-javadoc)
*
* @see java.sql.connection#gettypemap()
*/
public map<string  class<?>> gettypemap   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#getwarnings()
*/
public sqlwarning getwarnings   throws sqlexception
return warningchain
/*
* (non-javadoc)
*
* @see java.sql.connection#isclosed()
*/
public boolean isclosed   throws sqlexception
return isclosed
/*
* (non-javadoc)
*
* @see java.sql.connection#isreadonly()
*/
public boolean isreadonly   throws sqlexception
return false
/*
* (non-javadoc)
*
* @see java.sql.connection#isvalid(int)
*/
public boolean isvalid int timeout  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#nativesql(java.lang.string)
*/
public string nativesql string sql  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#preparecall(java.lang.string)
*/
public callablestatement preparecall string sql  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#preparecall(java.lang.string, int, int)
*/
public callablestatement preparecall string sql  int resultsettype
int resultsetconcurrency  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#preparecall(java.lang.string, int, int, int)
*/
public callablestatement preparecall string sql  int resultsettype
int resultsetconcurrency  int resultsetholdability  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#preparestatement(java.lang.string)
*/
public preparedstatement preparestatement string sql  throws sqlexception
return new hivepreparedstatement client  sql
/*
* (non-javadoc)
*
* @see java.sql.connection#preparestatement(java.lang.string, int)
*/
public preparedstatement preparestatement string sql  int autogeneratedkeys
throws sqlexception
return new hivepreparedstatement client  sql
/*
* (non-javadoc)
*
* @see java.sql.connection#preparestatement(java.lang.string, int[])
*/
public preparedstatement preparestatement string sql  int columnindexes
throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#preparestatement(java.lang.string,
* java.lang.string[])
*/
public preparedstatement preparestatement string sql  string columnnames
throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#preparestatement(java.lang.string, int, int)
*/
public preparedstatement preparestatement string sql  int resultsettype
int resultsetconcurrency  throws sqlexception
return new hivepreparedstatement client  sql
/*
* (non-javadoc)
*
* @see java.sql.connection#preparestatement(java.lang.string, int, int, int)
*/
public preparedstatement preparestatement string sql  int resultsettype
int resultsetconcurrency  int resultsetholdability  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#releasesavepoint(java.sql.savepoint)
*/
public void releasesavepoint savepoint savepoint  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#rollback()
*/
public void rollback   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#rollback(java.sql.savepoint)
*/
public void rollback savepoint savepoint  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#setautocommit(boolean)
*/
public void setautocommit boolean autocommit  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#setcatalog(java.lang.string)
*/
public void setcatalog string catalog  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#setclientinfo(java.util.properties)
*/
public void setclientinfo properties properties
throws sqlclientinfoexception
// todo auto-generated method stub
throw new sqlclientinfoexception    null
/*
* (non-javadoc)
*
* @see java.sql.connection#setclientinfo(java.lang.string, java.lang.string)
*/
public void setclientinfo string name  string value
throws sqlclientinfoexception
// todo auto-generated method stub
throw new sqlclientinfoexception    null
/*
* (non-javadoc)
*
* @see java.sql.connection#setholdability(int)
*/
public void setholdability int holdability  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#setreadonly(boolean)
*/
public void setreadonly boolean readonly  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#setsavepoint()
*/
public savepoint setsavepoint   throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#setsavepoint(java.lang.string)
*/
public savepoint setsavepoint string name  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#settransactionisolation(int)
*/
public void settransactionisolation int level  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.connection#settypemap(java.util.map)
*/
public void settypemap map<string  class<?>> map  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.wrapper#iswrapperfor(java.lang.class)
*/
public boolean iswrapperfor class<?> iface  throws sqlexception
// todo auto-generated method stub
throw new sqlexception
/*
* (non-javadoc)
*
* @see java.sql.wrapper#unwrap(java.lang.class)
*/
public <t> t unwrap class<t> iface  throws sqlexception
// todo auto-generated method stub
throw new sqlexception