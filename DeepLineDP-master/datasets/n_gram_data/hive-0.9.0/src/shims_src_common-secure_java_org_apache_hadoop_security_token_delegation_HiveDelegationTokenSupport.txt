/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop security token delegation
import java io bytearrayinputstream
import java io bytearrayoutputstream
import java io datainputstream
import java io dataoutputstream
import java io ioexception
import org apache hadoop io writableutils
import org apache hadoop security token delegation abstractdelegationtokensecretmanager delegationtokeninformation
/**
* workaround for serialization of {@link delegationtokeninformation} through package access.
* future version of hadoop should add this to delegationtokeninformation itself.
*/
public final class hivedelegationtokensupport
private hivedelegationtokensupport
public static byte encodedelegationtokeninformation delegationtokeninformation token
try
bytearrayoutputstream bos   new bytearrayoutputstream
dataoutputstream out   new dataoutputstream bos
writableutils writevint out  token password length
out write token password
out writelong token renewdate
out flush
return bos tobytearray
catch  ioexception ex
throw new runtimeexception    ex
public static delegationtokeninformation decodedelegationtokeninformation byte tokenbytes
throws ioexception
datainputstream in   new datainputstream new bytearrayinputstream tokenbytes
delegationtokeninformation token   new delegationtokeninformation 0  null
int len   writableutils readvint in
token password   new byte
in readfully token password
token renewdate   in readlong
return token
public static void rollmasterkey
abstractdelegationtokensecretmanager<? extends abstractdelegationtokenidentifier> mgr
throws ioexception
mgr rollmasterkey