/*
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive common cli
import java util properties
import org apache commons cli commandline
import org apache commons cli gnuparser
import org apache commons cli helpformatter
import org apache commons cli option
import org apache commons cli optionbuilder
import org apache commons cli options
import org apache commons cli parseexception
/**
* reusable code for hive cli's.
* <p>
* basic usage is: create an instance (usually a subclass if you want to
* all your own options or processing instructions), parse, and then use
* the resulting information.
* <p>
* see {@link org.apache.hadoop.hive.service.hiveserver} or
*     {@link org.apache.hadoop.hive.metastore.hivemetastore}
*     for examples of use.
*
*/
public class commonclioptions
/**
* options for parsing the command line.
*/
protected final options options   new options
protected commandline commandline
/**
* the name of this cli.
*/
protected final string cliname
private boolean verbose   false
/**
* create an instance with common options (help, verbose, etc...).
*
* @param cliname the name of the command
* @param includehiveconf include "hiveconf" as an option if true
*/
@suppresswarnings
public commonclioptions string cliname  boolean includehiveconf
this cliname   cliname
// [-v|--verbose]
options addoption new option       false
// [-h|--help]
options addoption new option       false
if  includehiveconf
options addoption optionbuilder
withvalueseparator
hasargs 2
withargname
withlongopt
withdescription
create
/**
* add the hiveconf properties to the java system properties, override
* anything therein.
*
* @return a copy of the properties specified in hiveconf
*/
public properties addhiveconftosystemproperties
properties confprops   commandline getoptionproperties
for  string propkey   confprops stringpropertynames
if  verbose
system err println
propkey       confprops getproperty propkey
system setproperty propkey  confprops getproperty propkey
return confprops
/**
* print usage information for the cli.
*/
public void printusage
new helpformatter   printhelp cliname  options
/**
* parse the arguments.
* @param args
*/
public void parse string args
try
commandline   new gnuparser   parse options  args
if  commandline hasoption
printusage
system exit 1
if  commandline hasoption
verbose   true
catch  parseexception e
system err println e getmessage
printusage
system exit 1
/**
* should the client be verbose.
*/
public boolean isverbose
return verbose