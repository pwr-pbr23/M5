/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive contrib udaf example
import org apache hadoop hive ql exec udaf
import org apache hadoop hive ql exec udafevaluator
import org apache hadoop hive ql exec description
import org apache hadoop hive serde2 io doublewritable
import org apache hadoop hive serde2 io shortwritable
import org apache hadoop hive shims shimloader
import org apache hadoop io floatwritable
import org apache hadoop io intwritable
import org apache hadoop io longwritable
import org apache hadoop io text
@description name      value
public class udafexamplemax extends udaf
static public class maxshortevaluator implements udafevaluator
private short mmax
private boolean mempty
public maxshortevaluator
super
init
public void init
mmax   0
mempty   true
public boolean iterate shortwritable o
if  o    null
if  mempty
mmax   o get
mempty   false
else
mmax    short  math max mmax  o get
return true
public shortwritable terminatepartial
return mempty ? null   new shortwritable mmax
public boolean merge shortwritable o
return iterate o
public shortwritable terminate
return mempty ? null   new shortwritable mmax
static public class maxintevaluator implements udafevaluator
private int mmax
private boolean mempty
public maxintevaluator
super
init
public void init
mmax   0
mempty   true
public boolean iterate intwritable o
if  o    null
if  mempty
mmax   o get
mempty   false
else
mmax   math max mmax  o get
return true
public intwritable terminatepartial
return mempty ? null   new intwritable mmax
public boolean merge intwritable o
return iterate o
public intwritable terminate
return mempty ? null   new intwritable mmax
static public class maxlongevaluator implements udafevaluator
private long mmax
private boolean mempty
public maxlongevaluator
super
init
public void init
mmax   0
mempty   true
public boolean iterate longwritable o
if  o    null
if  mempty
mmax   o get
mempty   false
else
mmax   math max mmax  o get
return true
public longwritable terminatepartial
return mempty ? null   new longwritable mmax
public boolean merge longwritable o
return iterate o
public longwritable terminate
return mempty ? null   new longwritable mmax
static public class maxfloatevaluator implements udafevaluator
private float mmax
private boolean mempty
public maxfloatevaluator
super
init
public void init
mmax   0
mempty   true
public boolean iterate floatwritable o
if  o    null
if  mempty
mmax   o get
mempty   false
else
mmax   math max mmax  o get
return true
public floatwritable terminatepartial
return mempty ? null   new floatwritable mmax
public boolean merge floatwritable o
return iterate o
public floatwritable terminate
return mempty ? null   new floatwritable mmax
static public class maxdoubleevaluator implements udafevaluator
private double mmax
private boolean mempty
public maxdoubleevaluator
super
init
public void init
mmax   0
mempty   true
public boolean iterate doublewritable o
if  o    null
if  mempty
mmax   o get
mempty   false
else
mmax   math max mmax  o get
return true
public doublewritable terminatepartial
return mempty ? null   new doublewritable mmax
public boolean merge doublewritable o
return iterate o
public doublewritable terminate
return mempty ? null   new doublewritable mmax
static public class maxstringevaluator implements udafevaluator
private text mmax
private boolean mempty
public maxstringevaluator
super
init
public void init
mmax   null
mempty   true
public boolean iterate text o
if  o    null
if  mempty
mmax   new text o
mempty   false
else if  shimloader gethadoopshims   comparetext mmax  o  < 0
mmax set o
return true
public text terminatepartial
return mempty ? null   mmax
public boolean merge text o
return iterate o
public text terminate
return mempty ? null   mmax