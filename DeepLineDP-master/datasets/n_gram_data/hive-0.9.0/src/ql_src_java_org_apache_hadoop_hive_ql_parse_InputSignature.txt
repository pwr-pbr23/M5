/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql parse
import java util arraylist
import org apache commons logging log
import org apache commons logging logfactory
import org apache hadoop hive serde2 typeinfo typeinfo
import org apache hadoop hive serde2 typeinfo typeinfofactory
/**
* the input signature of a function or operator. the signature basically
* consists of name, list of parameter types.
*
**/
public class inputsignature
private final string name
private final arraylist<typeinfo> typearray
@suppresswarnings
private static final log log   logfactory getlog inputsignature class
getname
public inputsignature string name
this name   name
typearray   new arraylist<typeinfo>
public inputsignature string name  typeinfo    classlist
this name
if  classlist length    0
for  typeinfo cl   classlist
typearray add cl
public inputsignature string name  class<?>    classlist
this name
if  classlist length    0
for  class<?> cl   classlist
typearray add typeinfofactory
getprimitivetypeinfofromprimitivewritable cl
public void add typeinfo paramtype
typearray add paramtype
public string getname
return name touppercase
public arraylist<typeinfo> gettypearray
return typearray
@override
public boolean equals object obj
if  obj    null
return false
inputsignature other   null
try
other    inputsignature  obj
catch  classcastexception cce
return false
return name equalsignorecase other getname
other typearray equals typearray
@override
public int hashcode
return tostring   hashcode
@override
public string tostring
stringbuilder sb   new stringbuilder
sb append getname
sb append
boolean isfirst   true
for  typeinfo cls   gettypearray
if   isfirst
sb append
sb append cls tostring
isfirst   false
sb append
return sb tostring