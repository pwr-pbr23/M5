/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive contrib udaf example
import org apache hadoop hive ql exec udaf
import org apache hadoop hive ql exec udafevaluator
import org apache hadoop hive ql exec description
import org apache hadoop hive serde2 io doublewritable
import org apache hadoop hive serde2 io shortwritable
import org apache hadoop hive shims shimloader
import org apache hadoop io floatwritable
import org apache hadoop io intwritable
import org apache hadoop io longwritable
import org apache hadoop io text
@description name      value
public class udafexamplemin extends udaf
static public class minshortevaluator implements udafevaluator
private short mmin
private boolean mempty
public minshortevaluator
super
init
public void init
mmin   0
mempty   true
public boolean iterate shortwritable o
if  o    null
if  mempty
mmin   o get
mempty   false
else
mmin    short  math min mmin  o get
return true
public shortwritable terminatepartial
return mempty ? null   new shortwritable mmin
public boolean merge shortwritable o
return iterate o
public shortwritable terminate
return mempty ? null   new shortwritable mmin
static public class minintevaluator implements udafevaluator
private int mmin
private boolean mempty
public minintevaluator
super
init
public void init
mmin   0
mempty   true
public boolean iterate intwritable o
if  o    null
if  mempty
mmin   o get
mempty   false
else
mmin   math min mmin  o get
return true
public intwritable terminatepartial
return mempty ? null   new intwritable mmin
public boolean merge intwritable o
return iterate o
public intwritable terminate
return mempty ? null   new intwritable mmin
static public class minlongevaluator implements udafevaluator
private long mmin
private boolean mempty
public minlongevaluator
super
init
public void init
mmin   0
mempty   true
public boolean iterate longwritable o
if  o    null
if  mempty
mmin   o get
mempty   false
else
mmin   math min mmin  o get
return true
public longwritable terminatepartial
return mempty ? null   new longwritable mmin
public boolean merge longwritable o
return iterate o
public longwritable terminate
return mempty ? null   new longwritable mmin
static public class minfloatevaluator implements udafevaluator
private float mmin
private boolean mempty
public minfloatevaluator
super
init
public void init
mmin   0
mempty   true
public boolean iterate floatwritable o
if  o    null
if  mempty
mmin   o get
mempty   false
else
mmin   math min mmin  o get
return true
public floatwritable terminatepartial
return mempty ? null   new floatwritable mmin
public boolean merge floatwritable o
return iterate o
public floatwritable terminate
return mempty ? null   new floatwritable mmin
static public class mindoubleevaluator implements udafevaluator
private double mmin
private boolean mempty
public mindoubleevaluator
super
init
public void init
mmin   0
mempty   true
public boolean iterate doublewritable o
if  o    null
if  mempty
mmin   o get
mempty   false
else
mmin   math min mmin  o get
return true
public doublewritable terminatepartial
return mempty ? null   new doublewritable mmin
public boolean merge doublewritable o
return iterate o
public doublewritable terminate
return mempty ? null   new doublewritable mmin
static public class minstringevaluator implements udafevaluator
private text mmin
private boolean mempty
public minstringevaluator
super
init
public void init
mmin   null
mempty   true
public boolean iterate text o
if  o    null
if  mempty
mmin   new text o
mempty   false
else if  shimloader gethadoopshims   comparetext mmin  o  > 0
mmin set o
return true
public text terminatepartial
return mempty ? null   mmin
public boolean merge text o
return iterate o
public text terminate
return mempty ? null   mmin