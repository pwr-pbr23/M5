/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive thrift
import java io ioexception
import java util arraylist
import java util list
import java util map
import java util concurrent concurrenthashmap
import java util concurrent atomic atomicinteger
import org apache hadoop conf configuration
import org apache hadoop security token delegation abstractdelegationtokensecretmanager delegationtokeninformation
/**
* default in-memory token store implementation.
*/
public class memorytokenstore implements delegationtokenstore
private final map<integer  string> masterkeys
new concurrenthashmap<integer  string>
private final concurrenthashmap<delegationtokenidentifier  delegationtokeninformation> tokens
new concurrenthashmap<delegationtokenidentifier  delegationtokeninformation>
private final atomicinteger masterkeyseq   new atomicinteger
private configuration conf
@override
public void setconf configuration conf
this conf   conf
@override
public configuration getconf
return this conf
@override
public int addmasterkey string s
int keyseq   masterkeyseq getandincrement
masterkeys put keyseq  s
return keyseq
@override
public void updatemasterkey int keyseq  string s
masterkeys put keyseq  s
@override
public boolean removemasterkey int keyseq
return masterkeys remove keyseq     null
@override
public string getmasterkeys
return masterkeys values   toarray new string
@override
public boolean addtoken delegationtokenidentifier tokenidentifier
delegationtokeninformation token
delegationtokeninformation tokeninfo   tokens putifabsent tokenidentifier  token
return  tokeninfo    null
@override
public boolean removetoken delegationtokenidentifier tokenidentifier
delegationtokeninformation tokeninfo   tokens remove tokenidentifier
return tokeninfo    null
@override
public delegationtokeninformation gettoken delegationtokenidentifier tokenidentifier
return tokens get tokenidentifier
@override
public list<delegationtokenidentifier> getalldelegationtokenidentifiers
list<delegationtokenidentifier> result   new arraylist<delegationtokenidentifier>
tokens size
for  delegationtokenidentifier id   tokens keyset
result add id
return result
@override
public void close   throws ioexception
//no-op