/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql udf generic
import java util arraylist
import java util list
import java util map
import java util map entry
import org apache hadoop hive ql exec description
import org apache hadoop hive ql exec taskexecutionexception
import org apache hadoop hive ql exec udfargumentexception
import org apache hadoop hive ql metadata hiveexception
import org apache hadoop hive serde2 objectinspector listobjectinspector
import org apache hadoop hive serde2 objectinspector mapobjectinspector
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop hive serde2 objectinspector objectinspectorfactory
import org apache hadoop hive serde2 objectinspector structobjectinspector
/**
* genericudtfexplode.
*
*/
@description name
value
public class genericudtfexplode extends genericudtf
private objectinspector inputoi   null
@override
public void close   throws hiveexception
@override
public structobjectinspector initialize objectinspector args  throws udfargumentexception
if  args length    1
throw new udfargumentexception
arraylist<string> fieldnames   new arraylist<string>
arraylist<objectinspector> fieldois   new arraylist<objectinspector>
switch  args getcategory
case list
inputoi   args
fieldnames add
fieldois add   listobjectinspector inputoi  getlistelementobjectinspector
break
case map
inputoi   args
fieldnames add
fieldnames add
fieldois add   mapobjectinspector inputoi  getmapkeyobjectinspector
fieldois add   mapobjectinspector inputoi  getmapvalueobjectinspector
break
default
throw new udfargumentexception
return objectinspectorfactory getstandardstructobjectinspector fieldnames
fieldois
private final object forwardlistobj   new object
private final object forwardmapobj   new object
@override
public void process object o  throws hiveexception
switch  inputoi getcategory
case list
listobjectinspector listoi    listobjectinspector inputoi
list<?> list   listoi getlist o
if  list    null
return
for  object r   list
forwardlistobj   r
forward forwardlistobj
break
case map
mapobjectinspector mapoi    mapobjectinspector inputoi
map<? ?> map   mapoi getmap o
if  map    null
return
for  entry<? ?> r   map entryset
forwardmapobj   r getkey
forwardmapobj   r getvalue
forward forwardmapobj
break
default
throw new taskexecutionexception
@override
public string tostring
return