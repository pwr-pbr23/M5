/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql metadata
import java util map
import org apache hadoop conf configuration
import org apache hadoop hive metastore hivemetahook
import org apache hadoop hive ql plan tabledesc
import org apache hadoop hive serde2 serde
import org apache hadoop hive serde2 lazy lazysimpleserde
import org apache hadoop hive ql security authorization hiveauthorizationprovider
import org apache hadoop hive ql security authorization defaulthiveauthorizationprovider
import org apache hadoop mapred inputformat
import org apache hadoop mapred outputformat
import org apache hadoop mapred sequencefileinputformat
import org apache hadoop mapred sequencefileoutputformat
/**
* defaultstoragehandler is an implementation of {@link hivestoragehandler}
* which supplies the standard defaults for all options.  this can be useful
* either as the base class for custom storage handlers, or as a mock in tests
* (providing something which appears to be a non-native table with respect to
* metadata even though its behavior is otherwise identical to a native table).
*/
public class defaultstoragehandler implements hivestoragehandler
private configuration conf
@override
public class<? extends inputformat> getinputformatclass
return sequencefileinputformat class
@override
public class<? extends outputformat> getoutputformatclass
return sequencefileoutputformat class
@override
public class<? extends serde> getserdeclass
return lazysimpleserde class
@override
public hivemetahook getmetahook
// no hook by default
return null
public hiveauthorizationprovider getauthorizationprovider
throws hiveexception
return new defaulthiveauthorizationprovider
@override
public void configureinputjobproperties tabledesc tabledesc
map<string  string> jobproperties
// do nothing by default
@override
public void configureoutputjobproperties tabledesc tabledesc
map<string  string> jobproperties
// do nothing by default
@override
public void configuretablejobproperties tabledesc tabledesc
map<string  string> jobproperties
//do nothing by default
@override
public configuration getconf
return conf
@override
public void setconf configuration conf
this conf   conf