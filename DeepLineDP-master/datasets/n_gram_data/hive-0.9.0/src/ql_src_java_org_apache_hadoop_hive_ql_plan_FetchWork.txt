/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql plan
import java io serializable
import java util arraylist
import java util list
import org apache hadoop fs path
/**
* fetchwork.
*
*/
@explain displayname
public class fetchwork implements serializable
private static final long serialversionuid   1l
private string tbldir
private tabledesc tbldesc
private arraylist<string> partdir
private arraylist<partitiondesc> partdesc
private int limit
private int leastnumrows
/**
* serialization null format for the serde used to fetch data.
*/
private string serializationnullformat
public fetchwork
public fetchwork string tbldir  tabledesc tbldesc
this tbldir  tbldesc   1
public fetchwork string tbldir  tabledesc tbldesc  int limit
this tbldir   tbldir
this tbldesc   tbldesc
this limit   limit
public fetchwork list<string> partdir  list<partitiondesc> partdesc
this partdir  partdesc   1
public fetchwork list<string> partdir  list<partitiondesc> partdesc  int limit
this partdir   new arraylist<string> partdir
this partdesc   new arraylist<partitiondesc> partdesc
this limit   limit
public string getserializationnullformat
return serializationnullformat
public void setserializationnullformat string format
serializationnullformat   format
/**
* @return the tbldir
*/
public string gettbldir
return tbldir
/**
* @return the tbldir
*/
public path gettbldirpath
return new path tbldir
/**
* @param tbldir
*          the tbldir to set
*/
public void settbldir string tbldir
this tbldir   tbldir
/**
* @return the tbldesc
*/
public tabledesc gettbldesc
return tbldesc
/**
* @param tbldesc
*          the tbldesc to set
*/
public void settbldesc tabledesc tbldesc
this tbldesc   tbldesc
/**
* @return the partdir
*/
public arraylist<string> getpartdir
return partdir
public list<path> getpartdirpath
return fetchwork convertstringtopatharray partdir
public static list<string> convertpathtostringarray list<path> paths
if  paths    null
return null
list<string> pathsstr   new arraylist<string>
for  path path   paths
pathsstr add path tostring
return pathsstr
public static list<path> convertstringtopatharray list<string> paths
if  paths    null
return null
list<path> pathsstr   new arraylist<path>
for  string path   paths
pathsstr add new path path
return pathsstr
/**
* @param partdir
*          the partdir to set
*/
public void setpartdir arraylist<string> partdir
this partdir   partdir
/**
* @return the partdesc
*/
public arraylist<partitiondesc> getpartdesc
return partdesc
/**
* @param partdesc
*          the partdesc to set
*/
public void setpartdesc arraylist<partitiondesc> partdesc
this partdesc   partdesc
/**
* @return the limit
*/
@explain displayname
public int getlimit
return limit
/**
* @param limit
*          the limit to set
*/
public void setlimit int limit
this limit   limit
public int getleastnumrows
return leastnumrows
public void setleastnumrows int leastnumrows
this leastnumrows   leastnumrows
@override
public string tostring
if  tbldir    null
return new string     tbldir
if  partdir    null
return
string ret
for  string part   partdir
ret   ret concat part
return ret