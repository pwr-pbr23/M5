/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2
import java util arraylist
import org apache hadoop conf configuration
import org apache hadoop util stringutils
/**
* columnprojectionutils.
*
*/
public final class columnprojectionutils
public static final string read_column_ids_conf_str
/**
* sets read columns' ids(start from zero) for rcfile's reader. once a column
* is included in the list, rcfile's reader will not skip its value.
*
*/
public static void setreadcolumnids configuration conf  arraylist<integer> ids
string id   toreadcolumnidstring ids
setreadcolumnidconf conf  id
/**
* sets read columns' ids(start from zero) for rcfile's reader. once a column
* is included in the list, rcfile's reader will not skip its value.
*
*/
public static void appendreadcolumnids configuration conf
arraylist<integer> ids
string id   toreadcolumnidstring ids
if  id    null
string old   conf get read_column_ids_conf_str  null
string newconfstr   id
if  old    null
newconfstr   newconfstr   stringutils comma_str   old
setreadcolumnidconf conf  newconfstr
private static void setreadcolumnidconf configuration conf  string id
if  id    null    id length   <  0
conf set read_column_ids_conf_str
return
conf set read_column_ids_conf_str  id
private static string toreadcolumnidstring arraylist<integer> ids
string id   null
if  ids    null
for  int i   0  i < ids size    i
if  i    0
id       ids get i
else
id   id   stringutils comma_str   ids get i
return id
/**
* returns an array of column ids(start from zero) which is set in the given
* parameter <tt>conf</tt>.
*/
public static arraylist<integer> getreadcolumnids configuration conf
if  conf    null
return new arraylist<integer> 0
string skips   conf get read_column_ids_conf_str
string list   stringutils split skips
arraylist<integer> result   new arraylist<integer> list length
for  string element   list
// it may contain duplicates, remove duplicates
integer toadd   integer parseint element
if   result contains toadd
result add toadd
return result
/**
* clears the read column ids set in the conf, and will read all columns.
*/
public static void setfullyreadcolumns configuration conf
conf set read_column_ids_conf_str
private columnprojectionutils
// prevent instantiation