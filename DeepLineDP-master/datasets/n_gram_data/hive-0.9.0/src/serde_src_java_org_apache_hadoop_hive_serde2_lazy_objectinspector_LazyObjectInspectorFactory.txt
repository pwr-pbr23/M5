/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 lazy objectinspector
import java util arraylist
import java util hashmap
import java util list
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop io text
/**
* objectinspectorfactory is the primary way to create new objectinspector
* instances.
*
* serde classes should call the static functions in this library to create an
* objectinspector to return to the caller of serde2.getobjectinspector().
*
* the reason of having caches here is that objectinspectors do not have an
* internal state - so objectinspectors with the same construction parameters
* should result in exactly the same objectinspector.
*/
public final class lazyobjectinspectorfactory
static hashmap<arraylist<object>  lazysimplestructobjectinspector> cachedlazysimplestructobjectinspector
new hashmap<arraylist<object>  lazysimplestructobjectinspector>
public static lazysimplestructobjectinspector getlazysimplestructobjectinspector
list<string> structfieldnames
list<objectinspector> structfieldobjectinspectors  byte separator
text nullsequence  boolean lastcolumntakesrest  boolean escaped
byte escapechar
return getlazysimplestructobjectinspector structfieldnames
structfieldobjectinspectors  null  separator  nullsequence
lastcolumntakesrest  escaped  escapechar
public static lazysimplestructobjectinspector getlazysimplestructobjectinspector
list<string> structfieldnames
list<objectinspector> structfieldobjectinspectors  list<string> structfieldcomments
byte separator  text nullsequence  boolean lastcolumntakesrest
boolean escaped byte escapechar
arraylist<object> signature   new arraylist<object>
signature add structfieldnames
signature add structfieldobjectinspectors
signature add byte valueof separator
signature add nullsequence tostring
signature add boolean valueof lastcolumntakesrest
signature add boolean valueof escaped
signature add byte valueof escapechar
if structfieldcomments    null
signature add structfieldcomments
lazysimplestructobjectinspector result   cachedlazysimplestructobjectinspector
get signature
if  result    null
result   new lazysimplestructobjectinspector structfieldnames
structfieldobjectinspectors  structfieldcomments  separator
nullsequence  lastcolumntakesrest  escaped  escapechar
cachedlazysimplestructobjectinspector put signature  result
return result
static hashmap<arraylist<object>  lazylistobjectinspector> cachedlazysimplelistobjectinspector   new hashmap<arraylist<object>  lazylistobjectinspector>
public static lazylistobjectinspector getlazysimplelistobjectinspector
objectinspector listelementobjectinspector  byte separator
text nullsequence  boolean escaped  byte escapechar
arraylist<object> signature   new arraylist<object>
signature add listelementobjectinspector
signature add byte valueof separator
signature add nullsequence tostring
signature add boolean valueof escaped
signature add byte valueof escapechar
lazylistobjectinspector result   cachedlazysimplelistobjectinspector
get signature
if  result    null
result   new lazylistobjectinspector listelementobjectinspector
separator  nullsequence  escaped  escapechar
cachedlazysimplelistobjectinspector put signature  result
return result
static hashmap<arraylist<object>  lazymapobjectinspector> cachedlazysimplemapobjectinspector   new hashmap<arraylist<object>  lazymapobjectinspector>
public static lazymapobjectinspector getlazysimplemapobjectinspector
objectinspector mapkeyobjectinspector
objectinspector mapvalueobjectinspector  byte itemseparator
byte keyvalueseparator  text nullsequence  boolean escaped
byte escapechar
arraylist<object> signature   new arraylist<object>
signature add mapkeyobjectinspector
signature add mapvalueobjectinspector
signature add byte valueof itemseparator
signature add byte valueof keyvalueseparator
signature add nullsequence tostring
signature add boolean valueof escaped
signature add byte valueof escapechar
lazymapobjectinspector result   cachedlazysimplemapobjectinspector
get signature
if  result    null
result   new lazymapobjectinspector mapkeyobjectinspector
mapvalueobjectinspector  itemseparator  keyvalueseparator
nullsequence  escaped  escapechar
cachedlazysimplemapobjectinspector put signature  result
return result
static hashmap<list<object>  lazyunionobjectinspector>
cachedlazyunionobjectinspector
new hashmap<list<object>  lazyunionobjectinspector>
public static lazyunionobjectinspector getlazyunionobjectinspector
list<objectinspector> ois  byte separator  text nullsequence
boolean escaped  byte escapechar
list<object> signature   new arraylist<object>
signature add ois
signature add byte valueof separator
signature add nullsequence tostring
signature add boolean valueof escaped
signature add byte valueof escapechar
lazyunionobjectinspector result   cachedlazyunionobjectinspector
get signature
if  result    null
result   new lazyunionobjectinspector ois  separator
nullsequence  escaped  escapechar
cachedlazyunionobjectinspector put signature  result
return result
private lazyobjectinspectorfactory
// prevent instantiation