/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql stats
import org apache hadoop conf configuration
/**
* an interface for any possible implementation for gathering statistics.
*/
public interface statsaggregator
/**
* this method connects to the temporary storage.
*
* @param hconf
*          hiveconf that contains the connection parameters.
* @return true if connection is successful, false otherwise.
*/
public boolean connect configuration hconf
/**
* this method aggregates a given statistic from all tasks (partial stats).
* after aggregation, this method also automatically removes all records
* that have been aggregated.
*
* @param keyprefix
*          a prefix of the keys used in statspublisher to publish stats.
*          any rows that starts with the same prefix will be aggregated. for example, if
*          the statspublisher uses the following compound key to publish stats:
*
*          the output directory name (unique per filesinkoperator) +
*          the partition specs (only for dynamic partitions) +
*          taskid (last component of task file)
*
*          the keyprefix for aggregation could be first 2 components. this will aggregates stats
*          across all tasks for each partition.
*
* @param stattype
*          a string noting the key to be published. ex: "numrows".
* @return a string representation of a long value, null if there are any error/exception.
*/
public string aggregatestats string keyprefix  string stattype
/**
* this method closes the connection to the temporary storage.
*
* @return true if close connection is successful, false otherwise.
*/
public boolean closeconnection
/**
* this method is called after all statistics have been aggregated. since we support multiple
* statistics, we do not perform automatic cleanup after aggregation.
* after this method is called, closeconnection must be called as well.
* this method is also used to clear the temporary statistics that have been published without
* being aggregated.
* typically this happens when a job fails, or is forcibly stopped after publishing some
* statistics.
*
* @param keyprefix
*          a prefix of the keys used in statspublisher to publish stats. it is the same
*          as the first parameter in aggregatestats().
* @return true if cleanup is successful, false otherwise.
*/
public boolean cleanup string keyprefix