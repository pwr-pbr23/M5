/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql udf generic
import org apache hadoop hive ql exec description
import org apache hadoop hive ql exec udfargumentexception
import org apache hadoop hive ql exec udfargumenttypeexception
import org apache hadoop hive ql metadata hiveexception
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop hive serde2 objectinspector primitiveobjectinspector
import org apache hadoop hive serde2 objectinspector primitive primitiveobjectinspectorfactory
import org apache hadoop io booleanwritable
@description name      value
public class genericudfbetween extends genericudf
genericudfopequalorgreaterthan egt   new genericudfopequalorgreaterthan
genericudfopequalorlessthan elt   new genericudfopequalorlessthan
private objectinspector argumentois
private final booleanwritable result   new booleanwritable
@override
public objectinspector initialize objectinspector arguments  throws udfargumentexception
if   arguments gettypename   equals
throw new udfargumenttypeexception 0
egt initialize new objectinspector  arguments  arguments
elt initialize new objectinspector  arguments  arguments
argumentois   arguments
return primitiveobjectinspectorfactory writablebooleanobjectinspector
@override
public object evaluate deferredobject arguments  throws hiveexception
boolean invert    boolean    primitiveobjectinspector  argumentois
getprimitivejavaobject arguments get
booleanwritable left     booleanwritable egt evaluate new deferredobject  arguments  arguments
if  left    null
return null
if   invert     left get
result set false
return result
booleanwritable right     booleanwritable elt evaluate new deferredobject  arguments  arguments
if  right    null
return null
boolean between   left get      right get
result set invert ?  between   between
return result
@override
public string getdisplaystring string children
stringbuilder sb   new stringbuilder
sb append children
if  boolean valueof children
sb append
sb append
sb append children  append    append children
return sb tostring