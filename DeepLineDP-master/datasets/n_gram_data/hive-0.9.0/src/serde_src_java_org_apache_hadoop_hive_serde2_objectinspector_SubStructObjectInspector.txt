/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 objectinspector
import java util arraylist
import java util list
/**
* subsetstructobjectinspector implement a wrapper around a base object inspector (baseoi)
* such that when the row corresponding to the baseoi is given together with this object
* inspector, it will mask out some fields in the row as if they are not there.
*/
public class substructobjectinspector extends structobjectinspector
protected structobjectinspector baseoi     base object inspector
protected int startcol     start column number
protected int numcols      number of columns
protected list<structfield> fields
/**
* create a new object inspector based on a base object inspector and the subset of
* columns will be inspected (from startcol to startcol+numcols).
* @param baseoi
* @param startcol
* @param numcols
*/
public substructobjectinspector structobjectinspector baseoi  int startcol  int numcols
this baseoi   baseoi
this startcol   startcol
this numcols   numcols
list<? extends structfield> basefields   baseoi getallstructfieldrefs
assert startcol < basefields size      startcol   numcols < basefields size
this fields   new arraylist<structfield> numcols
this fields addall baseoi getallstructfieldrefs   sublist startcol  startcol   numcols
@override
public string gettypename
return objectinspectorutils getstandardstructtypename this
@override
public category getcategory
return category struct
@override
public list<? extends structfield> getallstructfieldrefs
return this fields
@override
public structfield getstructfieldref string fieldname
return objectinspectorutils getstandardstructfieldref fieldname  fields
@override
public object getstructfielddata object data  structfield fieldref
return baseoi getstructfielddata data  fieldref
@override
public list<object> getstructfieldsdataaslist object data
return baseoi getstructfieldsdataaslist data  sublist startcol  startcol numcols