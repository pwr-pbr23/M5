/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 lazybinary
import java util arraylist
import java util list
import org apache hadoop hive serde2 lazybinary objectinspector lazybinarylistobjectinspector
import org apache hadoop hive serde2 lazybinary objectinspector lazybinarymapobjectinspector
import org apache hadoop hive serde2 lazybinary objectinspector lazybinarystructobjectinspector
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop hive serde2 objectinspector objectinspectorfactory
import org apache hadoop hive serde2 objectinspector primitiveobjectinspector
import org apache hadoop hive serde2 objectinspector primitiveobjectinspector primitivecategory
import org apache hadoop hive serde2 objectinspector primitive writablebinaryobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writablebooleanobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writablebyteobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writabledoubleobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writablefloatobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writableintobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writablelongobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writableshortobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writablestringobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writabletimestampobjectinspector
import org apache hadoop hive serde2 objectinspector primitive writablevoidobjectinspector
import org apache hadoop hive serde2 typeinfo typeinfo
/**
* lazybinaryfactory.
*
*/
public final class lazybinaryfactory
/**
* create a lazy binary primitive class given the type name.
*/
public static lazybinaryprimitive<?  ?> createlazybinaryprimitiveclass
primitiveobjectinspector oi
primitivecategory p   oi getprimitivecategory
switch  p
case boolean
return new lazybinaryboolean  writablebooleanobjectinspector  oi
case byte
return new lazybinarybyte  writablebyteobjectinspector  oi
case short
return new lazybinaryshort  writableshortobjectinspector  oi
case int
return new lazybinaryinteger  writableintobjectinspector  oi
case long
return new lazybinarylong  writablelongobjectinspector  oi
case float
return new lazybinaryfloat  writablefloatobjectinspector  oi
case double
return new lazybinarydouble  writabledoubleobjectinspector  oi
case string
return new lazybinarystring  writablestringobjectinspector  oi
case void     for null
return new lazybinaryvoid  writablevoidobjectinspector  oi
case timestamp
return new lazybinarytimestamp  writabletimestampobjectinspector  oi
case binary
return new lazybinarybinary  writablebinaryobjectinspector  oi
default
throw new runtimeexception     p
/**
* create a hierarchical lazybinaryobject based on the given typeinfo.
*/
public static lazybinaryobject createlazybinaryobject objectinspector oi
objectinspector category c   oi getcategory
switch  c
case primitive
return createlazybinaryprimitiveclass  primitiveobjectinspector  oi
case map
return new lazybinarymap  lazybinarymapobjectinspector  oi
case list
return new lazybinaryarray  lazybinarylistobjectinspector  oi
case struct
return new lazybinarystruct  lazybinarystructobjectinspector  oi
throw new runtimeexception
private lazybinaryfactory
// prevent instantiation
public static objectinspector createcolumnarstructinspector list<string> columnnames
list<typeinfo> columntypes
arraylist<objectinspector> columnobjectinspectors   new arraylist<objectinspector>
columntypes size
for  int i   0  i < columntypes size    i
columnobjectinspectors
add lazybinaryutils getlazybinaryobjectinspectorfromtypeinfo columntypes get i
return objectinspectorfactory getcolumnarstructobjectinspector columnnames
columnobjectinspectors