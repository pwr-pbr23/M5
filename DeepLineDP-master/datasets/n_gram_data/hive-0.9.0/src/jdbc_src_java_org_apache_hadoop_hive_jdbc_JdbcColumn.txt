/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive jdbc
import java sql sqlexception
import java sql types
/**
* column metadata.
*/
public class jdbccolumn
private final string columnname
private final string tablename
private final string tablecatalog
private final string type
private final string comment
private final int ordinalpos
jdbccolumn string columnname  string tablename  string tablecatalog
string type  string comment  int ordinalpos
this columnname   columnname
this tablename   tablename
this tablecatalog   tablecatalog
this type   type
this comment   comment
this ordinalpos   ordinalpos
public string getcolumnname
return columnname
public string gettablename
return tablename
public string gettablecatalog
return tablecatalog
public string gettype
return type
public integer getsqltype   throws sqlexception
return utils hivetypetosqltype type
static int columndisplaysize int columntype  throws sqlexception
// according to hivetypetosqltype possible options are:
switch columntype
case types boolean
return columnprecision columntype
case types varchar
return integer max_value     hive has no max limit for strings
case types tinyint
case types smallint
case types integer
case types bigint
return columnprecision columntype    1     allow
// see http://download.oracle.com/javase/6/docs/api/constant-values.html#java.lang.float.max_exponent
case types float
return 24     e g    17#  e ###
// see http://download.oracle.com/javase/6/docs/api/constant-values.html#java.lang.double.max_exponent
case types double
return 25     e g    17#  e ####
default
throw new sqlexception     columntype
static int columnprecision int columntype  throws sqlexception
// according to hivetypetosqltype possible options are:
switch columntype
case types boolean
return 1
case types varchar
return integer max_value     hive has no max limit for strings
case types tinyint
return 3
case types smallint
return 5
case types integer
return 10
case types bigint
return 19
case types float
return 7
case types double
return 15
default
throw new sqlexception     columntype
static int columnscale int columntype  throws sqlexception
// according to hivetypetosqltype possible options are:
switch columntype
case types boolean
case types varchar
case types tinyint
case types smallint
case types integer
case types bigint
return 0
case types float
return 7
case types double
return 15
default
throw new sqlexception     columntype
public integer getcolumnsize   throws sqlexception
int precision   columnprecision utils hivetypetosqltype type
return precision    0 ? null   precision
public integer getdecimaldigits   throws sqlexception
return columnscale utils hivetypetosqltype type
public integer getnumprecradix
if  type equalsignorecase
return 10
else if  type equalsignorecase
return 10
else if  type equalsignorecase
return 10
else if  type equalsignorecase
return 10
else if  type equalsignorecase
return 2
else if  type equalsignorecase
return 2
else      anything else including boolean and string is null
return null
public string getcomment
return comment
public int getordinalpos
return ordinalpos