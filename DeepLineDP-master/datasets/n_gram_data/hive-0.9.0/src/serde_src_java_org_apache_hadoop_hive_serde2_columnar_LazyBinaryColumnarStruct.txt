/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 columnar
import java util arraylist
import org apache hadoop hive serde2 lazy bytearrayref
import org apache hadoop hive serde2 lazy lazyobjectbase
import org apache hadoop hive serde2 lazybinary lazybinaryfactory
import org apache hadoop hive serde2 lazybinary lazybinaryutils
import org apache hadoop hive serde2 lazybinary lazybinaryutils vint
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop hive serde2 objectinspector primitiveobjectinspector
import org apache hadoop hive serde2 objectinspector objectinspector category
import org apache hadoop hive serde2 objectinspector primitiveobjectinspector primitivecategory
public class lazybinarycolumnarstruct extends columnarstructbase
public lazybinarycolumnarstruct objectinspector oi  arraylist<integer> notskippedcolumnids
super oi  notskippedcolumnids
static vint vint   new lazybinaryutils vint
@override
protected int getlength objectinspector objectinspector  bytearrayref cachedbytearrayref
int start  int length
if  length    0
return  1
category category   objectinspector getcategory
if  category equals category primitive
primitivecategory primitivecategory     primitiveobjectinspector  objectinspector
getprimitivecategory
if  primitivecategory equals primitivecategory string      length    1
cachedbytearrayref getdata
lazybinarycolumnarserde invalid_utf__single_byte
return 0
return length
@override
protected lazyobjectbase createlazyobjectbase objectinspector objectinspector
return lazybinaryfactory createlazybinaryobject objectinspector