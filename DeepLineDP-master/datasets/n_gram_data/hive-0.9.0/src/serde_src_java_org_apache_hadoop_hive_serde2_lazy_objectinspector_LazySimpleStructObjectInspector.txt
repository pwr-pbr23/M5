/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 lazy objectinspector
import java util arraylist
import java util list
import org apache commons logging log
import org apache commons logging logfactory
import org apache hadoop hive serde2 lazy lazystruct
import org apache hadoop hive serde2 objectinspector objectinspector
import org apache hadoop hive serde2 objectinspector objectinspectorutils
import org apache hadoop hive serde2 objectinspector structfield
import org apache hadoop hive serde2 objectinspector structobjectinspector
import org apache hadoop io text
/**
* lazysimplestructobjectinspector works on struct data that is stored in
* lazystruct.
*
* the names of the struct fields and the internal structure of the struct
* fields are specified in the ctor of the lazysimplestructobjectinspector.
*
* always use the objectinspectorfactory to create new objectinspector objects,
* instead of directly creating an instance of this class.
*/
public class lazysimplestructobjectinspector extends structobjectinspector
public static final log log   logfactory
getlog lazysimplestructobjectinspector class getname
protected static class myfield implements structfield
protected int fieldid
protected string fieldname
protected objectinspector fieldobjectinspector
protected string fieldcomment
public myfield int fieldid  string fieldname
objectinspector fieldobjectinspector
this fieldid   fieldid
this fieldname   fieldname tolowercase
this fieldobjectinspector   fieldobjectinspector
public myfield int fieldid  string fieldname  objectinspector fieldobjectinspector  string fieldcomment
this fieldid  fieldname  fieldobjectinspector
this fieldcomment   fieldcomment
public int getfieldid
return fieldid
public string getfieldname
return fieldname
public objectinspector getfieldobjectinspector
return fieldobjectinspector
public string getfieldcomment
return fieldcomment
@override
public string tostring
return     fieldid       fieldname
protected list<myfield> fields
@override
public string gettypename
return objectinspectorutils getstandardstructtypename this
byte separator
text nullsequence
boolean lastcolumntakesrest
boolean escaped
byte escapechar
/**
* call objectinspectorfactory.getlazysimplestructobjectinspector instead.
*/
protected lazysimplestructobjectinspector list<string> structfieldnames
list<objectinspector> structfieldobjectinspectors  byte separator
text nullsequence  boolean lastcolumntakesrest  boolean escaped
byte escapechar
init structfieldnames  structfieldobjectinspectors  null  separator
nullsequence  lastcolumntakesrest  escaped  escapechar
public lazysimplestructobjectinspector list<string> structfieldnames
list<objectinspector> structfieldobjectinspectors
list<string> structfieldcomments  byte separator  text nullsequence
boolean lastcolumntakesrest  boolean escaped  byte escapechar
init structfieldnames  structfieldobjectinspectors  structfieldcomments
separator  nullsequence  lastcolumntakesrest  escaped  escapechar
protected void init list<string> structfieldnames
list<objectinspector> structfieldobjectinspectors
list<string> structfieldcomments  byte separator
text nullsequence  boolean lastcolumntakesrest  boolean escaped
byte escapechar
assert  structfieldnames size      structfieldobjectinspectors size
assert  structfieldcomments    null
structfieldnames size      structfieldcomments size
this separator   separator
this nullsequence   nullsequence
this lastcolumntakesrest   lastcolumntakesrest
this escaped   escaped
this escapechar   escapechar
fields   new arraylist<myfield> structfieldnames size
for  int i   0  i < structfieldnames size    i
fields add new myfield i  structfieldnames get i
structfieldobjectinspectors get i
structfieldcomments    null ? null   structfieldcomments get i
protected lazysimplestructobjectinspector list<structfield> fields
byte separator  text nullsequence
init fields  separator  nullsequence
protected void init list<structfield> fields  byte separator
text nullsequence
this separator   separator
this nullsequence   nullsequence
this fields   new arraylist<myfield> fields size
for  int i   0  i < fields size    i
this fields add new myfield i  fields get i  getfieldname    fields
get i  getfieldobjectinspector    fields get i  getfieldcomment
@override
public final category getcategory
return category struct
// without data
@override
public structfield getstructfieldref string fieldname
return objectinspectorutils getstandardstructfieldref fieldname  fields
@override
public list<? extends structfield> getallstructfieldrefs
return fields
// with data
@override
public object getstructfielddata object data  structfield fieldref
if  data    null
return null
lazystruct struct    lazystruct  data
myfield f    myfield  fieldref
int fieldid   f getfieldid
assert  fieldid >  0    fieldid < fields size
return struct getfield fieldid
@override
public list<object> getstructfieldsdataaslist object data
if  data    null
return null
lazystruct struct    lazystruct  data
return struct getfieldsaslist
// for lazystruct
public byte getseparator
return separator
public text getnullsequence
return nullsequence
public boolean getlastcolumntakesrest
return lastcolumntakesrest
public boolean isescaped
return escaped
public byte getescapechar
return escapechar