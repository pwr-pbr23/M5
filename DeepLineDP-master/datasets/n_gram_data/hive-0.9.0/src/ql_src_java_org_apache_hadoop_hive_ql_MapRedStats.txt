/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive ql
import org apache hadoop mapred counters
import org apache hadoop mapred counters counter
/**
* mapredstats.
*
* a data structure to keep one mapreduce's stats:
* number of mappers, number of reducers, accumulative cpu time and whether it
* succeeds.
*
*/
public class mapredstats
int nummap
int numreduce
long cpumsec
counters counters   null
boolean success
string jobid
public mapredstats int nummap  int numreduce  long cpumsec  boolean ifsuccess  string jobid
this nummap   nummap
this numreduce   numreduce
this cpumsec   cpumsec
this success   ifsuccess
this jobid   jobid
public boolean issuccess
return success
public long getcpumsec
return cpumsec
public int getnummap
return nummap
public void setnummap int nummap
this nummap   nummap
public int getnumreduce
return numreduce
public void setnumreduce int numreduce
this numreduce   numreduce
public void setcounters counters taskcounters
this counters   taskcounters
public counters getcounters
return this counters
public void setcpumsec long cpumsec
this cpumsec   cpumsec
public void setsuccess boolean success
this success   success
public string getjobid
return jobid
public void setjobid string jobid
this jobid   jobid
@override
public string tostring
stringbuilder sb   new stringbuilder
if  nummap > 0
sb append     nummap
if  numreduce > 0
sb append     numreduce
if  cpumsec > 0
sb append      cpumsec   1000d
if  counters    null
counter hdfsreadcntr   counters findcounter
long hdfsread
if  hdfsreadcntr    null     hdfsread   hdfsreadcntr getvalue    >  0
sb append     hdfsread
counter hdfswrittencntr   counters findcounter
long hdfswritten
if  hdfswrittencntr    null     hdfswritten   hdfswrittencntr getvalue    >  0
sb append     hdfswritten
sb append      success ?
return sb tostring