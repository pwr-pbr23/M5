/**
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org apache hadoop hive serde2 lazy
import java nio charset charactercodingexception
import org apache commons codec binary base64
import org apache commons logging log
import org apache commons logging logfactory
import org apache hadoop hive serde2 lazy objectinspector primitive lazybinaryobjectinspector
import org apache hadoop io byteswritable
import org apache hadoop io text
public class lazybinary extends lazyprimitive<lazybinaryobjectinspector  byteswritable>
private static final log log   logfactory getlog lazybinary class
lazybinary lazybinaryobjectinspector oi
super oi
data   new byteswritable
public lazybinary lazybinary other
super other
byteswritable incoming   other getwritableobject
byte bytes   new byte
system arraycopy incoming getbytes    0  bytes  0  incoming getlength
data   new byteswritable bytes
@override
public void init bytearrayref bytes  int start  int length
byte recv   new byte
system arraycopy bytes getdata    start  recv  0  length
boolean arraybytebase64   base64 isarraybytebase64 recv
if  arraybytebase64
log debug
byte decoded   arraybytebase64 ? base64 decodebase64 recv    recv
data set decoded  0  decoded length