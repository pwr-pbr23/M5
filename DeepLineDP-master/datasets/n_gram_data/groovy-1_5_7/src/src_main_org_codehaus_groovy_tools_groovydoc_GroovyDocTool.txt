/*
* copyright 2007 jeremy rayner
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package org codehaus groovy tools groovydoc
import antlr recognitionexception
import antlr tokenstreamexception
import org codehaus groovy groovydoc groovyrootdoc
import java io file
import java io ioexception
import java util list
import java util arraylist
public class groovydoctool
/**
* constructor for use by people who only want to interact with the groovy doclet tree (rootdoc)
* @param sourcepath where the sources to be added can be found
*/
public groovydoctool string sourcepath
this null sourcepath null
public groovydoctool resourcemanager resourcemanager  string sourcepath  string classtemplate
this resourcemanager  sourcepath  new string    new string    new string  classtemplate   new arraylist
public groovydoctool resourcemanager resourcemanager  string sourcepath  string doctemplates  string packagetemplates  string classtemplates  list links
rootdocbuilder   new groovyrootdocbuilder this  sourcepath  links
if  resourcemanager    null
templateengine   null
else
templateengine   new groovydoctemplateengine this  resourcemanager  doctemplates  packagetemplates  classtemplates
public void add string filename  throws recognitionexception  tokenstreamexception  ioexception
if  templateengine    null
// only print out if we are being used for template generation
system out println     filename
rootdocbuilder buildtree filename
public groovyrootdoc getrootdoc
return rootdocbuilder getrootdoc
public void rendertooutput outputtool output  string destdir  throws exception
if  templateengine    null
groovydocwriter writer   new groovydocwriter this  output  templateengine
groovyrootdoc rootdoc   rootdocbuilder getrootdoc
writer writeroot rootdoc  destdir
writer writepackages rootdoc  destdir
writer writeclasses rootdoc  destdir
else
throw new unsupportedoperationexception
private final groovyrootdocbuilder rootdocbuilder
private final groovydoctemplateengine templateengine
string getpath string filename
string path   new file filename  getparent
// path length of 1 indicates that probably is 'default package' i.e. "/"
if  path    null    path length      1
path           for   path  rather than null
return path
string getfile string filename
return new file filename  getname