/*
* copyright 2003-2007 the original author or authors.
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package groovy util
import groovy lang groovyclassloader
import groovy lang script
import junit framework test
import junit framework testsuite
import junit textui testrunner
import org codehaus groovy runtime scripttestadapter
import java io file
/**
* a testsuite which will run a groovy unit test case inside any java ide
* either as a unit test case or as an application.
* <p/>
* you can specify the groovyunittest to run by running this class as an appplication
* and specifying the script to run on the command line.
* <p/>
* <code>
* java groovy.util.groovytestsuite src/test/foo.groovy
* </code>
* <p/>
* or to run the test suite as a unit test suite in an ide you can use
* the 'test' system property to define the test script to run.
* e.g. pass this into the jvm when the unit test plugin runs...
* <p/>
* <code>
* -dtest=src/test/foo.groovy
* </code>
*
* @author <a href="mailto:james@coredevelopers.net">james strachan</a>
* @version $revision$
*/
public class groovytestsuite extends testsuite
protected static string file   null
protected final groovyclassloader loader   new groovyclassloader groovytestsuite class getclassloader
public static void main string args
if  args length > 0
file   args
testrunner run suite
public static test suite
groovytestsuite suite   new groovytestsuite
try
suite loadtestsuite
catch  exception e
throw new runtimeexception     e  e
return suite
public void loadtestsuite   throws exception
string filename   system getproperty    file
if  filename    null
throw new runtimeexception
system out println     filename
class type   compile filename
string args
if   test class isassignablefrom type     script class isassignablefrom type
// lets treat the script as a test
addtest new scripttestadapter type  args
else
addtestsuite type
public class compile string filename  throws exception
return loader parseclass new file filename