/*
* copyright 2003-2007 the original author or authors.
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package groovy time
import java util calendar
import java util date
import org codehaus groovy runtime timecategory
/**
* @author john wilson tug@wilson.co.uk
*         <p/>
*         datumdependentduration represents durations whose length in milliseconds cannot be determined withou knowing the datum point.
*         <p/>
*         i don't know how many days in a year unless i know if it's a leap year or not.
*         <p/>
*         i don't know how many days in a month unless i know the name of the month (and if it's a leap yaer if the month is february)
*/
public class datumdependentduration extends baseduration
public datumdependentduration final int years  final int months  final int days  final int hours  final int minutes  final int seconds  final int millis
super years  months  days  hours  minutes  seconds  millis
public int getmonths
return this months
public int getyears
return this years
public datumdependentduration plus final datumdependentduration rhs
return new datumdependentduration this getyears     rhs getyears    this getmonths     rhs getmonths
this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public datumdependentduration plus final timedatumdependentduration rhs
return rhs plus this
public datumdependentduration plus final duration rhs
return new datumdependentduration this getyears    this getmonths
this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public datumdependentduration plus final timeduration rhs
return rhs plus this
public datumdependentduration minus final datumdependentduration rhs
return new datumdependentduration this getyears     rhs getyears    this getmonths     rhs getmonths
this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public datumdependentduration minus final duration rhs
return new datumdependentduration this getyears    this getmonths
this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
/* (non-javadoc)
* @see groovy.time.baseduration#tomilliseconds()
*
* do our best to change the duration into milliseconds
* we calculate the duration relative to now
*/
public long tomilliseconds
final date now   new date
return timecategory minus plus now   now  tomilliseconds
public date getago
final calendar cal   calendar getinstance
cal add calendar year   this getyears
cal add calendar month   this getmonths
cal add calendar day_of_year   this getdays
cal add calendar hour_of_day   this gethours
cal add calendar minute   this getminutes
cal add calendar second   this getseconds
cal add calendar millisecond   this getmillis
//
// sqldate should not really care about these values but it seems to "remember" them
// so we clear them. we do the adds first in case we get carry into the day field.
//
cal set calendar hour_of_day  0
cal set calendar minute  0
cal set calendar second  0
cal set calendar millisecond  0
return new java sql date cal gettimeinmillis
public from getfrom
return new from
public date getnow
final calendar cal   calendar getinstance
cal add calendar year  datumdependentduration this getyears
cal add calendar month  datumdependentduration this getmonths
cal add calendar day_of_year  datumdependentduration this getdays
cal add calendar hour_of_day  datumdependentduration this gethours
cal add calendar minute  datumdependentduration this getminutes
cal add calendar second  datumdependentduration this getseconds
cal add calendar millisecond  datumdependentduration this getmillis
//
// sqldate should not really care about these values but it seems to "remember" them
// so we clear them. we do the adds first in case we get carry into the day field.
//
cal set calendar hour_of_day  0
cal set calendar minute  0
cal set calendar second  0
cal set calendar millisecond  0
return new java sql date cal gettimeinmillis