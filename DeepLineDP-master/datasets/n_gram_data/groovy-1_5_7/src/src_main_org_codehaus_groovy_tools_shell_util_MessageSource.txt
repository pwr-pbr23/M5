/*
* licensed to the apache software foundation (asf) under one
* or more contributor license agreements.  see the notice file
* distributed with this work for additional information
* regarding copyright ownership.  the asf licenses this file
* to you under the apache license, version 2.0 (the
* "license"); you may not use this file except in compliance
* with the license.  you may obtain a copy of the license at
*
*  http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing,
* software distributed under the license is distributed on an
* "as is" basis, without warranties or conditions of any
* kind, either express or implied.  see the license for the
* specific language governing permissions and limitations
* under the license.
*/
package org codehaus groovy tools shell util
import java util resourcebundle
import java util missingresourceexception
import java text messageformat
import groovy lang groovyobjectsupport
/**
* message source backed up by one or more {@link java.util.resourcebundle}
* instances for simple i18n support.
*
* @version $id$
* @author <a href="mailto:jason@planet57.com">jason dillon</a>
*/
public class messagesource
extends groovyobjectsupport
private final string bundlenames
private resourcebundle cachedbundles
public messagesource final string names
assert names    null
assert names length    0
this bundlenames   names
public messagesource final string name
this new string   name
private static string classnames final class types
assert types    null
assert types length    0
string names   new string
for  int i 0  i<types length  i
assert types    null
names   types getname
return names
public messagesource final class types
this classnames types
public messagesource final class type
this new string   type getname
private resourcebundle createbundles
resourcebundle bundles   new resourcebundle
for  int i 0  i<bundlenames length  i
assert bundlenames    null
bundles   resourcebundle getbundle bundlenames
return bundles
private resourcebundle getbundles
if  cachedbundles    null
cachedbundles   createbundles
return cachedbundles
/**
* get a raw message from the resource bundles using the given code.
*/
public string getmessage final string code
assert code    null
missingresourceexception error   null
resourcebundle bundles   getbundles
for  int i 0  i<bundles length  i
try
return bundles getstring code
catch  missingresourceexception e
//
// fixme: for now just save the first error, should really roll a new message with all of the details
//
if  error    null
error   e
assert error    null
throw error
/**
* format a message (based on {@link messageformat} using the message
* from the resource bundles using the given code as a pattern and the
* given objects as arguments.
*/
public string format final string code  final object args
assert args    null
string pattern   getmessage code
return messageformat format pattern  args
/**
* @see #getmessage(string)
*/
public object getproperty final string name
return getmessage name