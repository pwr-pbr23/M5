/*
* copyright 2003-2007 the original author or authors.
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package groovy ui
import groovy lang closure
import java io filteroutputstream
import java io ioexception
import java io printstream
/**
* intercepts system.out. implementation helper for console.groovy.
*
* @version $id$
*/
public class systemoutputinterceptor extends filteroutputstream
private closure callback
/**
* constructor
*
* @param callback
*            accepts a string to be sent to std out and returns a boolean.
*            if the return value is true, output will be sent to
*            system.out, otherwise it will not.
*/
public systemoutputinterceptor final closure callback
super system out
assert callback    null
this callback   callback
/**
* starts intercepting system.out
*/
public void start
system setout new printstream this
/**
* stops intercepting system.out, sending output to whereever it was
* going when this interceptor was created.
*/
public void stop
system setout  printstream  out
/**
* intercepts output - moret common case of byte[]
*/
public void write byte b  int off  int len  throws ioexception
boolean result    boolean  callback call new string b  off  len
if  result booleanvalue
out write b  off  len
/**
* intercepts output - single characters
*/
public void write int b  throws ioexception
boolean result    boolean  callback call string valueof  char  b
if  result booleanvalue
out write b