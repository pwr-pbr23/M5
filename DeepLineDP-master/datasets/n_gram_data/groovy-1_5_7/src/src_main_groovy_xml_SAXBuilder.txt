/*
* copyright 2003-2007 the original author or authors.
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package groovy xml
import groovy util buildersupport
import java util iterator
import java util map
import org xml sax attributes
import org xml sax contenthandler
import org xml sax saxexception
import org xml sax helpers attributesimpl
/**
* a helper class for creating a w3c d
*
* @author <a href="mailto:james@coredevelopers.net">james strachan</a>
* @version $revision$
*/
public class saxbuilder extends buildersupport
private contenthandler handler
private attributes emptyattributes   new attributesimpl
public saxbuilder contenthandler handler
this handler   handler
protected void setparent object parent  object child
protected object createnode object name
dostartelement name  emptyattributes
return name
protected object createnode object name  object value
dostartelement name  emptyattributes
dotext value
return name
/**
* @param value
*/
private void dotext object value
try
char text   value tostring   tochararray
handler characters text  0  text length
catch  saxexception e
handleexception e
protected object createnode object name  map attributemap  object text
attributesimpl attributes   new attributesimpl
for  iterator iter   attributemap entryset   iterator    iter hasnext
map entry entry    map entry  iter next
object key   entry getkey
object value   entry getvalue
string uri
string localname   null
string qualifiedname
string valuetext    value    null  ? value tostring
if  key instanceof qname
qname qname    qname  key
uri   qname getnamespaceuri
localname   qname getlocalpart
qualifiedname   qname getqualifiedname
else
localname   key tostring
qualifiedname   localname
attributes addattribute uri  localname  qualifiedname     valuetext
dostartelement name  attributes
if  text    null
dotext text
return name
protected void dostartelement object name  attributes attributes
string uri
string localname   null
string qualifiedname
if  name instanceof qname
qname qname    qname  name
uri   qname getnamespaceuri
localname   qname getlocalpart
qualifiedname   qname getqualifiedname
else
localname   name tostring
qualifiedname   localname
try
handler startelement uri  localname  qualifiedname  attributes
catch  saxexception e
handleexception e
protected void nodecompleted object parent  object name
string uri
string localname   null
string qualifiedname
if  name instanceof qname
qname qname    qname  name
uri   qname getnamespaceuri
localname   qname getlocalpart
qualifiedname   qname getqualifiedname
else
localname   name tostring
qualifiedname   localname
try
handler endelement uri  localname  qualifiedname
catch  saxexception e
handleexception e
protected void handleexception saxexception e
throw new runtimeexception e
/* (non-javadoc)
* @see groovy.util.buildersupport#createnode(java.lang.object, java.util.map, java.lang.object)
*/
protected object createnode object name  map attributes
return createnode name  attributes  null