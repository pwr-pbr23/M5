/*
* copyright 2003-2007 the original author or authors.
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package groovy time
import java util calendar
import java util date
/**
* @author john wilson tug@wilson.co.uk
*
* duration represents time periods which have values independant of the context.
* so, whilst we can't say how long a month is without knowing the year and the name of the month,
* we know how long a day is independant of the date.
*
* this is not 100% true for days.
* days can actually be 23, 24 or 25 hours long (due to daylight saving adjustments)
*
* if you ask duration to convert itself to milliseconds then it will work on the basis of 24 hours
* in a day. if you add or subtract it from a date it will take daylight saving into account.
*
*/
public class duration extends baseduration
public duration final int days  final int hours  final int minutes  final int seconds  final int millis
super days  hours  minutes  seconds  millis
public duration plus final duration rhs
return new duration this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public duration plus final timeduration rhs
return rhs plus this
public datumdependentduration plus final datumdependentduration rhs
return rhs plus this
public duration minus final duration rhs
return new duration this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public timeduration minus final timeduration rhs
return new timeduration this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public datumdependentduration minus final datumdependentduration rhs
return new datumdependentduration  rhs getyears     rhs getmonths
this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public timedatumdependentduration minus final timedatumdependentduration rhs
return new timedatumdependentduration  rhs getyears     rhs getmonths
this getdays     rhs getdays    this gethours     rhs gethours
this getminutes     rhs getminutes    this getseconds     rhs getseconds
this getmillis     rhs getmillis
public long tomilliseconds
return       long  this getdays     24     this gethours      60   this getminutes      60    this getseconds      1000    this getmillis
public date getago
final calendar cal   calendar getinstance
cal add calendar day_of_year   this getdays
cal add calendar hour_of_day   this gethours
cal add calendar minute   this getminutes
cal add calendar second   this getseconds
cal add calendar millisecond   this getmillis
//
// sqldate should not really care about these values but it seems to "remember" them
// so we clear them.
// we do the adds first incase we get carry into the day field
//
cal set calendar hour_of_day  0
cal set calendar minute  0
cal set calendar second  0
cal set calendar millisecond  0
return new java sql date cal gettimeinmillis
public from getfrom
return new from
public date getnow
final calendar cal   calendar getinstance
cal add calendar day_of_year  duration this getdays
//
// sqldate should not really care about these values but it seems to "remember" them
// so we clear them.
// we do the adds first incase we get carry into the day field
//
cal set calendar hour_of_day  0
cal set calendar minute  0
cal set calendar second  0
cal set calendar millisecond  0
return new java sql date cal gettimeinmillis