/*
* copyright 2003-2007 the original author or authors.
*
* licensed under the apache license, version 2.0 (the "license");
* you may not use this file except in compliance with the license.
* you may obtain a copy of the license at
*
*     http://www.apache.org/licenses/license-2.0
*
* unless required by applicable law or agreed to in writing, software
* distributed under the license is distributed on an "as is" basis,
* without warranties or conditions of any kind, either express or implied.
* see the license for the specific language governing permissions and
* limitations under the license.
*/
package groovy util slurpersupport
import groovy lang buildable
import groovy lang closure
import groovy lang groovyobject
import groovy lang groovyruntimeexception
import java io ioexception
import java io writer
import java util iterator
import java util map
import org codehaus groovy runtime typehandling defaulttypetransformation
/**
* @author john wilson
*/
class nodechildren extends gpathresult
private int size    1
/**
* @param parent
* @param name
* @param namespaceprefix
* @param namespacetaghints
*/
public nodechildren final gpathresult parent  final string name  final string namespaceprefix  final map namespacetaghints
super parent  name  namespaceprefix  namespacetaghints
/**
* @param parent
* @param name
* @param namespacetaghints
*/
public nodechildren final gpathresult parent  final string name  final map namespacetaghints
this parent  name     namespacetaghints
/**
* @param parent
* @param namespacetaghints
*/
public nodechildren final gpathresult parent  final map namespacetaghints
this parent     namespacetaghints
public iterator childnodes
return new iterator
private final iterator iter   parent childnodes
private iterator childiter   nextchilditer
/* (non-javadoc)
* @see java.util.iterator#hasnext()
*/
public boolean hasnext
return childiter    null
/* (non-javadoc)
* @see java.util.iterator#next()
*/
public object next
while  childiter    null
try
if  childiter hasnext
return childiter next
finally
if   childiter hasnext
childiter   nextchilditer
return null
/* (non-javadoc)
* @see java.util.iterator#remove()
*/
public void remove
throw new unsupportedoperationexception
private iterator nextchilditer
while  iter hasnext
final node node    node  iter next
if  name equals node name       name equals
final iterator result   node childnodes
if  result hasnext
if    equals namespaceprefix
equals namespaceprefix       equals node namespaceuri
node namespaceuri   equals namespacemap get namespaceprefix
return result
return null
public iterator iterator
return new iterator
final iterator iter   nodeiterator
public boolean hasnext
return iter hasnext
public object next
return new nodechild  node  iter next    parent  namespacetaghints
public void remove
throw new unsupportedoperationexception
public iterator nodeiterator
if    equals name
return parent childnodes
else
return new nodeiterator parent childnodes
/* (non-javadoc)
* @see org.codehaus.groovy.sandbox.util.slurpersupport.nodeiterator#getnextnode(java.util.iterator)
*/
protected object getnextnode iterator iter
while  iter hasnext
final node node    node  iter next
if  name equals node name
if    equals namespaceprefix
equals namespaceprefix       equals node namespaceuri
node namespaceuri   equals namespacemap get namespaceprefix
return node
return null
public gpathresult parents
// todo auto-generated method stub
throw new groovyruntimeexception
public synchronized int size
if  this size     1
final iterator iter   iterator
this size   0
while  iter hasnext
iter next
this size
return this size
public string text
final stringbuffer buf   new stringbuffer
final iterator iter   nodeiterator
while  iter hasnext
buf append   node  iter next    text
return buf tostring
public gpathresult find final closure closure
final iterator iter   iterator
while  iter hasnext
final object node   iter next
if  defaulttypetransformation casttoboolean closure call new object node
return  gpathresult  node
return new nochildren this  this name  namespacetaghints
public gpathresult findall final closure closure
return new filterednodechildren this  closure  namespacetaghints
public void build final groovyobject builder
final iterator iter   nodeiterator
while  iter hasnext
final object next   iter next
if  next instanceof buildable
buildable  next  build builder
else
node  next  build builder  namespacemap  namespacetaghints
/* (non-javadoc)
* @see groovy.lang.writable#writeto(java.io.writer)
*/
public writer writeto final writer out  throws ioexception
final iterator iter   nodeiterator
while  iter hasnext
node  iter next    writeto out
return out
protected void replacenode final closure newvalue
final iterator iter   iterator
while  iter hasnext
final nodechild result    nodechild  iter next
result replacenode newvalue
protected void replacebody final object newvalue
final iterator iter   iterator
while  iter hasnext
final nodechild result    nodechild  iter next
result replacebody newvalue
protected void appendnode final object newvalue
final iterator iter   iterator
while  iter hasnext
final nodechild result    nodechild  iter next
result appendnode newvalue